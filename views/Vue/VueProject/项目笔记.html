<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>电商项目 | ZB-Notes</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/logo.png">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.5e6abf62.css" as="style"><link rel="preload" href="/assets/js/app.9183dc48.js" as="script"><link rel="preload" href="/assets/js/127.b6e7f39a.js" as="script"><link rel="preload" href="/assets/js/3.e72fa89a.js" as="script"><link rel="preload" href="/assets/js/2.a1801f46.js" as="script"><link rel="prefetch" href="/assets/js/10.f535fde6.js"><link rel="prefetch" href="/assets/js/100.e585abcd.js"><link rel="prefetch" href="/assets/js/101.6d6cd206.js"><link rel="prefetch" href="/assets/js/102.0f68514e.js"><link rel="prefetch" href="/assets/js/103.73bf1d07.js"><link rel="prefetch" href="/assets/js/104.1213fe0e.js"><link rel="prefetch" href="/assets/js/105.9ab30de4.js"><link rel="prefetch" href="/assets/js/106.1cbe6d63.js"><link rel="prefetch" href="/assets/js/107.2483e919.js"><link rel="prefetch" href="/assets/js/108.2766d961.js"><link rel="prefetch" href="/assets/js/109.1f3955c2.js"><link rel="prefetch" href="/assets/js/11.83d0f9f6.js"><link rel="prefetch" href="/assets/js/110.65a66cdd.js"><link rel="prefetch" href="/assets/js/111.3a238953.js"><link rel="prefetch" href="/assets/js/112.878d17ae.js"><link rel="prefetch" href="/assets/js/113.191fbad8.js"><link rel="prefetch" href="/assets/js/114.fe1ac853.js"><link rel="prefetch" href="/assets/js/115.04dea7fa.js"><link rel="prefetch" href="/assets/js/116.c71ae24e.js"><link rel="prefetch" href="/assets/js/117.5272491f.js"><link rel="prefetch" href="/assets/js/118.e9c0c460.js"><link rel="prefetch" href="/assets/js/119.f13a2931.js"><link rel="prefetch" href="/assets/js/12.b1804325.js"><link rel="prefetch" href="/assets/js/120.75161273.js"><link rel="prefetch" href="/assets/js/121.bfa4e3fa.js"><link rel="prefetch" href="/assets/js/122.c9818133.js"><link rel="prefetch" href="/assets/js/123.e6ae57c8.js"><link rel="prefetch" href="/assets/js/124.c6018a46.js"><link rel="prefetch" href="/assets/js/125.94c7e660.js"><link rel="prefetch" href="/assets/js/126.e366f522.js"><link rel="prefetch" href="/assets/js/128.1904509d.js"><link rel="prefetch" href="/assets/js/129.13ee7539.js"><link rel="prefetch" href="/assets/js/13.4bad6da3.js"><link rel="prefetch" href="/assets/js/130.93d5face.js"><link rel="prefetch" href="/assets/js/131.0b84a187.js"><link rel="prefetch" href="/assets/js/132.72ddaf00.js"><link rel="prefetch" href="/assets/js/133.25bbd8dd.js"><link rel="prefetch" href="/assets/js/134.620c7d90.js"><link rel="prefetch" href="/assets/js/135.43d15dff.js"><link rel="prefetch" href="/assets/js/136.e4d04b15.js"><link rel="prefetch" href="/assets/js/137.be580e6e.js"><link rel="prefetch" href="/assets/js/138.1d78c10f.js"><link rel="prefetch" href="/assets/js/139.f4a39cf9.js"><link rel="prefetch" href="/assets/js/14.be8db819.js"><link rel="prefetch" href="/assets/js/140.566d1afc.js"><link rel="prefetch" href="/assets/js/141.07f40500.js"><link rel="prefetch" href="/assets/js/142.3dde80c6.js"><link rel="prefetch" href="/assets/js/143.118e79a3.js"><link rel="prefetch" href="/assets/js/144.795265a0.js"><link rel="prefetch" href="/assets/js/145.32b11f27.js"><link rel="prefetch" href="/assets/js/146.5ce35f0e.js"><link rel="prefetch" href="/assets/js/147.abbead64.js"><link rel="prefetch" href="/assets/js/148.b0e65634.js"><link rel="prefetch" href="/assets/js/149.167aefc5.js"><link rel="prefetch" href="/assets/js/15.3f0a639b.js"><link rel="prefetch" href="/assets/js/150.1a9f807a.js"><link rel="prefetch" href="/assets/js/151.c352c805.js"><link rel="prefetch" href="/assets/js/152.b1460d3d.js"><link rel="prefetch" href="/assets/js/153.4cfc2dd9.js"><link rel="prefetch" href="/assets/js/154.fa4dfd51.js"><link rel="prefetch" href="/assets/js/155.1c5defc6.js"><link rel="prefetch" href="/assets/js/156.b612970e.js"><link rel="prefetch" href="/assets/js/157.4e9a7d54.js"><link rel="prefetch" href="/assets/js/158.5d70bcc9.js"><link rel="prefetch" href="/assets/js/159.c7aa3a8b.js"><link rel="prefetch" href="/assets/js/16.430cd672.js"><link rel="prefetch" href="/assets/js/160.1a603b72.js"><link rel="prefetch" href="/assets/js/161.47beeba8.js"><link rel="prefetch" href="/assets/js/162.2f8a82b4.js"><link rel="prefetch" href="/assets/js/163.50ea2122.js"><link rel="prefetch" href="/assets/js/164.318f0648.js"><link rel="prefetch" href="/assets/js/165.5285f26c.js"><link rel="prefetch" href="/assets/js/166.83f5037d.js"><link rel="prefetch" href="/assets/js/167.855c525e.js"><link rel="prefetch" href="/assets/js/168.77e0f1d6.js"><link rel="prefetch" href="/assets/js/169.90de0f79.js"><link rel="prefetch" href="/assets/js/17.743c2cbb.js"><link rel="prefetch" href="/assets/js/170.955ad965.js"><link rel="prefetch" href="/assets/js/171.fbef02a5.js"><link rel="prefetch" href="/assets/js/172.27ecc0c2.js"><link rel="prefetch" href="/assets/js/173.85f0edad.js"><link rel="prefetch" href="/assets/js/174.2c3c0b30.js"><link rel="prefetch" href="/assets/js/175.4ba8cf06.js"><link rel="prefetch" href="/assets/js/176.8a7531f1.js"><link rel="prefetch" href="/assets/js/177.acf2ad52.js"><link rel="prefetch" href="/assets/js/178.81cdfa8d.js"><link rel="prefetch" href="/assets/js/179.bf472f77.js"><link rel="prefetch" href="/assets/js/18.95b2960e.js"><link rel="prefetch" href="/assets/js/180.fae6a0c8.js"><link rel="prefetch" href="/assets/js/181.f8e6ca70.js"><link rel="prefetch" href="/assets/js/182.7f9c3a9b.js"><link rel="prefetch" href="/assets/js/183.a8415dbe.js"><link rel="prefetch" href="/assets/js/184.233dbc14.js"><link rel="prefetch" href="/assets/js/185.4e879e98.js"><link rel="prefetch" href="/assets/js/186.e507c02f.js"><link rel="prefetch" href="/assets/js/187.6f0c4fa0.js"><link rel="prefetch" href="/assets/js/188.ca1a265c.js"><link rel="prefetch" href="/assets/js/189.6f8465e6.js"><link rel="prefetch" href="/assets/js/19.22ca969f.js"><link rel="prefetch" href="/assets/js/190.d0b57012.js"><link rel="prefetch" href="/assets/js/191.586fe3a2.js"><link rel="prefetch" href="/assets/js/192.2071d885.js"><link rel="prefetch" href="/assets/js/193.cfca6bdf.js"><link rel="prefetch" href="/assets/js/194.dd719e16.js"><link rel="prefetch" href="/assets/js/195.e8a42785.js"><link rel="prefetch" href="/assets/js/196.b7b21fd3.js"><link rel="prefetch" href="/assets/js/197.7c47d798.js"><link rel="prefetch" href="/assets/js/198.1de68f2f.js"><link rel="prefetch" href="/assets/js/199.7970a3cb.js"><link rel="prefetch" href="/assets/js/20.3a587807.js"><link rel="prefetch" href="/assets/js/200.b5388931.js"><link rel="prefetch" href="/assets/js/201.5fa67630.js"><link rel="prefetch" href="/assets/js/202.5c5efa95.js"><link rel="prefetch" href="/assets/js/203.29cdcf27.js"><link rel="prefetch" href="/assets/js/204.7d7de884.js"><link rel="prefetch" href="/assets/js/205.5ccd9f5f.js"><link rel="prefetch" href="/assets/js/206.7407d960.js"><link rel="prefetch" href="/assets/js/207.c0ae912e.js"><link rel="prefetch" href="/assets/js/208.689708f2.js"><link rel="prefetch" href="/assets/js/209.13cd9f38.js"><link rel="prefetch" href="/assets/js/21.88790cdd.js"><link rel="prefetch" href="/assets/js/210.0cc4ecd9.js"><link rel="prefetch" href="/assets/js/211.c9e2c59e.js"><link rel="prefetch" href="/assets/js/212.debf74f9.js"><link rel="prefetch" href="/assets/js/213.cc3953fc.js"><link rel="prefetch" href="/assets/js/214.43b2fe42.js"><link rel="prefetch" href="/assets/js/215.22f95420.js"><link rel="prefetch" href="/assets/js/216.2ced123c.js"><link rel="prefetch" href="/assets/js/217.82ad5303.js"><link rel="prefetch" href="/assets/js/218.ed9c052c.js"><link rel="prefetch" href="/assets/js/219.c957bee2.js"><link rel="prefetch" href="/assets/js/22.b9407d63.js"><link rel="prefetch" href="/assets/js/220.08e415f9.js"><link rel="prefetch" href="/assets/js/221.af35a579.js"><link rel="prefetch" href="/assets/js/222.76eef6f2.js"><link rel="prefetch" href="/assets/js/223.f6997158.js"><link rel="prefetch" href="/assets/js/224.0177e6bf.js"><link rel="prefetch" href="/assets/js/225.6c1809be.js"><link rel="prefetch" href="/assets/js/226.7f325c5e.js"><link rel="prefetch" href="/assets/js/227.3934aeaa.js"><link rel="prefetch" href="/assets/js/228.14147f23.js"><link rel="prefetch" href="/assets/js/229.949e1c15.js"><link rel="prefetch" href="/assets/js/23.1d784e73.js"><link rel="prefetch" href="/assets/js/230.3eaa7849.js"><link rel="prefetch" href="/assets/js/231.71a12a2b.js"><link rel="prefetch" href="/assets/js/232.04245fd7.js"><link rel="prefetch" href="/assets/js/233.cb93897a.js"><link rel="prefetch" href="/assets/js/234.0e51f40d.js"><link rel="prefetch" href="/assets/js/235.3cdf817c.js"><link rel="prefetch" href="/assets/js/236.a05a80c2.js"><link rel="prefetch" href="/assets/js/237.6c626852.js"><link rel="prefetch" href="/assets/js/238.1fb1e7af.js"><link rel="prefetch" href="/assets/js/239.25580979.js"><link rel="prefetch" href="/assets/js/24.4d1bcce6.js"><link rel="prefetch" href="/assets/js/240.ffccca7f.js"><link rel="prefetch" href="/assets/js/241.23ca8802.js"><link rel="prefetch" href="/assets/js/242.71fadb4d.js"><link rel="prefetch" href="/assets/js/243.ff1e3883.js"><link rel="prefetch" href="/assets/js/244.ded9c1e0.js"><link rel="prefetch" href="/assets/js/245.747075b9.js"><link rel="prefetch" href="/assets/js/246.68ec5c76.js"><link rel="prefetch" href="/assets/js/247.1e29c1ca.js"><link rel="prefetch" href="/assets/js/248.9eb4b80c.js"><link rel="prefetch" href="/assets/js/249.2edc7b76.js"><link rel="prefetch" href="/assets/js/25.890f46ae.js"><link rel="prefetch" href="/assets/js/250.af69f0bc.js"><link rel="prefetch" href="/assets/js/251.0d1e8c08.js"><link rel="prefetch" href="/assets/js/252.e15d765f.js"><link rel="prefetch" href="/assets/js/253.bab38f4c.js"><link rel="prefetch" href="/assets/js/254.b177cab1.js"><link rel="prefetch" href="/assets/js/255.e634566d.js"><link rel="prefetch" href="/assets/js/256.5e102d9a.js"><link rel="prefetch" href="/assets/js/257.0563503d.js"><link rel="prefetch" href="/assets/js/258.3904d8b4.js"><link rel="prefetch" href="/assets/js/259.cfa2fd70.js"><link rel="prefetch" href="/assets/js/26.d90819c7.js"><link rel="prefetch" href="/assets/js/260.ba21761f.js"><link rel="prefetch" href="/assets/js/261.54cdb61b.js"><link rel="prefetch" href="/assets/js/262.92f444b6.js"><link rel="prefetch" href="/assets/js/263.573d714e.js"><link rel="prefetch" href="/assets/js/264.3f022b6f.js"><link rel="prefetch" href="/assets/js/265.77f16fb3.js"><link rel="prefetch" href="/assets/js/266.3831dc5c.js"><link rel="prefetch" href="/assets/js/267.0725e50d.js"><link rel="prefetch" href="/assets/js/268.838f91ac.js"><link rel="prefetch" href="/assets/js/269.b4abdb5b.js"><link rel="prefetch" href="/assets/js/27.ea129088.js"><link rel="prefetch" href="/assets/js/270.9c3fabe7.js"><link rel="prefetch" href="/assets/js/271.fed379bf.js"><link rel="prefetch" href="/assets/js/272.72f8b02f.js"><link rel="prefetch" href="/assets/js/273.39cfb9c8.js"><link rel="prefetch" href="/assets/js/274.1590ebff.js"><link rel="prefetch" href="/assets/js/275.f9d8055f.js"><link rel="prefetch" href="/assets/js/276.f07513c5.js"><link rel="prefetch" href="/assets/js/277.c62e2eea.js"><link rel="prefetch" href="/assets/js/278.64fca9d3.js"><link rel="prefetch" href="/assets/js/279.172b18bc.js"><link rel="prefetch" href="/assets/js/28.cbeb58aa.js"><link rel="prefetch" href="/assets/js/280.ac4a96fc.js"><link rel="prefetch" href="/assets/js/281.c31ad5da.js"><link rel="prefetch" href="/assets/js/282.8fa7ef0b.js"><link rel="prefetch" href="/assets/js/283.81f8c403.js"><link rel="prefetch" href="/assets/js/284.edf45079.js"><link rel="prefetch" href="/assets/js/285.75c3bc82.js"><link rel="prefetch" href="/assets/js/286.c17b0350.js"><link rel="prefetch" href="/assets/js/287.447122aa.js"><link rel="prefetch" href="/assets/js/288.ed6f0804.js"><link rel="prefetch" href="/assets/js/289.e614c4c2.js"><link rel="prefetch" href="/assets/js/29.e3f5a936.js"><link rel="prefetch" href="/assets/js/290.94677db6.js"><link rel="prefetch" href="/assets/js/291.aa295671.js"><link rel="prefetch" href="/assets/js/292.ff765b29.js"><link rel="prefetch" href="/assets/js/293.70c698af.js"><link rel="prefetch" href="/assets/js/294.065a8d5f.js"><link rel="prefetch" href="/assets/js/295.b2ba8b22.js"><link rel="prefetch" href="/assets/js/296.98e9da73.js"><link rel="prefetch" href="/assets/js/297.d40414ae.js"><link rel="prefetch" href="/assets/js/298.f10fcd53.js"><link rel="prefetch" href="/assets/js/299.2099838a.js"><link rel="prefetch" href="/assets/js/30.6d703dcc.js"><link rel="prefetch" href="/assets/js/300.0cfc5419.js"><link rel="prefetch" href="/assets/js/301.509df13a.js"><link rel="prefetch" href="/assets/js/302.8be07830.js"><link rel="prefetch" href="/assets/js/303.a7726893.js"><link rel="prefetch" href="/assets/js/304.2e65243e.js"><link rel="prefetch" href="/assets/js/305.d0fd2016.js"><link rel="prefetch" href="/assets/js/306.9358c58b.js"><link rel="prefetch" href="/assets/js/307.00a40dbc.js"><link rel="prefetch" href="/assets/js/308.0438a7f0.js"><link rel="prefetch" href="/assets/js/309.6b3c1328.js"><link rel="prefetch" href="/assets/js/31.5211ec4a.js"><link rel="prefetch" href="/assets/js/310.41250083.js"><link rel="prefetch" href="/assets/js/311.0b0e824f.js"><link rel="prefetch" href="/assets/js/312.e8b819be.js"><link rel="prefetch" href="/assets/js/313.7c0fed90.js"><link rel="prefetch" href="/assets/js/314.37c71cbe.js"><link rel="prefetch" href="/assets/js/315.3a90afe5.js"><link rel="prefetch" href="/assets/js/316.07befc59.js"><link rel="prefetch" href="/assets/js/317.0f1b0e41.js"><link rel="prefetch" href="/assets/js/318.6162c92c.js"><link rel="prefetch" href="/assets/js/319.53ba4545.js"><link rel="prefetch" href="/assets/js/32.79740f13.js"><link rel="prefetch" href="/assets/js/320.d5d02efc.js"><link rel="prefetch" href="/assets/js/321.90202c35.js"><link rel="prefetch" href="/assets/js/322.d5c1127c.js"><link rel="prefetch" href="/assets/js/323.2fb0d163.js"><link rel="prefetch" href="/assets/js/324.594f9a05.js"><link rel="prefetch" href="/assets/js/325.64f88b7d.js"><link rel="prefetch" href="/assets/js/326.34d03ceb.js"><link rel="prefetch" href="/assets/js/327.b5409c78.js"><link rel="prefetch" href="/assets/js/328.4ee96a7c.js"><link rel="prefetch" href="/assets/js/329.00543f24.js"><link rel="prefetch" href="/assets/js/33.3213dc4d.js"><link rel="prefetch" href="/assets/js/330.91ba9a82.js"><link rel="prefetch" href="/assets/js/331.e534dcdd.js"><link rel="prefetch" href="/assets/js/332.528190d6.js"><link rel="prefetch" href="/assets/js/34.0479cfea.js"><link rel="prefetch" href="/assets/js/35.62844ca7.js"><link rel="prefetch" href="/assets/js/36.797dbe09.js"><link rel="prefetch" href="/assets/js/37.639f1289.js"><link rel="prefetch" href="/assets/js/38.0d4198c2.js"><link rel="prefetch" href="/assets/js/39.c511da8b.js"><link rel="prefetch" href="/assets/js/4.a2b19b6e.js"><link rel="prefetch" href="/assets/js/40.91d2bca7.js"><link rel="prefetch" href="/assets/js/41.acf4a677.js"><link rel="prefetch" href="/assets/js/42.8f5d5bc1.js"><link rel="prefetch" href="/assets/js/43.29b762dc.js"><link rel="prefetch" href="/assets/js/44.cd266de3.js"><link rel="prefetch" href="/assets/js/45.450c93e8.js"><link rel="prefetch" href="/assets/js/46.1d691666.js"><link rel="prefetch" href="/assets/js/47.f7d0003c.js"><link rel="prefetch" href="/assets/js/48.a2231eff.js"><link rel="prefetch" href="/assets/js/49.874f53aa.js"><link rel="prefetch" href="/assets/js/5.e15a2319.js"><link rel="prefetch" href="/assets/js/50.e57c1303.js"><link rel="prefetch" href="/assets/js/51.0fa4b883.js"><link rel="prefetch" href="/assets/js/52.ea768dd9.js"><link rel="prefetch" href="/assets/js/53.beb2c29a.js"><link rel="prefetch" href="/assets/js/54.95c3d237.js"><link rel="prefetch" href="/assets/js/55.00fd38bb.js"><link rel="prefetch" href="/assets/js/56.0650ec4c.js"><link rel="prefetch" href="/assets/js/57.cd6a07b0.js"><link rel="prefetch" href="/assets/js/58.385f2dd8.js"><link rel="prefetch" href="/assets/js/59.83522701.js"><link rel="prefetch" href="/assets/js/6.10cb9ffe.js"><link rel="prefetch" href="/assets/js/60.982f805f.js"><link rel="prefetch" href="/assets/js/61.d439affb.js"><link rel="prefetch" href="/assets/js/62.ceb8712f.js"><link rel="prefetch" href="/assets/js/63.736dbe70.js"><link rel="prefetch" href="/assets/js/64.bd7d2c0f.js"><link rel="prefetch" href="/assets/js/65.3202694b.js"><link rel="prefetch" href="/assets/js/66.ed7ca341.js"><link rel="prefetch" href="/assets/js/67.45c8b959.js"><link rel="prefetch" href="/assets/js/68.4de44aad.js"><link rel="prefetch" href="/assets/js/69.0df14048.js"><link rel="prefetch" href="/assets/js/7.538173c9.js"><link rel="prefetch" href="/assets/js/70.d178ec66.js"><link rel="prefetch" href="/assets/js/71.5f2b73dd.js"><link rel="prefetch" href="/assets/js/72.1499eade.js"><link rel="prefetch" href="/assets/js/73.39378169.js"><link rel="prefetch" href="/assets/js/74.aab9f4cd.js"><link rel="prefetch" href="/assets/js/75.58af5dcb.js"><link rel="prefetch" href="/assets/js/76.ddebe4de.js"><link rel="prefetch" href="/assets/js/77.795376b5.js"><link rel="prefetch" href="/assets/js/78.9d59b408.js"><link rel="prefetch" href="/assets/js/79.a48d3c50.js"><link rel="prefetch" href="/assets/js/8.5f0cbc1e.js"><link rel="prefetch" href="/assets/js/80.56981d9a.js"><link rel="prefetch" href="/assets/js/81.a177e7bb.js"><link rel="prefetch" href="/assets/js/82.13486971.js"><link rel="prefetch" href="/assets/js/83.89195269.js"><link rel="prefetch" href="/assets/js/84.3ef3070c.js"><link rel="prefetch" href="/assets/js/85.a0af9b6c.js"><link rel="prefetch" href="/assets/js/86.ec91bf6b.js"><link rel="prefetch" href="/assets/js/87.5d4eb344.js"><link rel="prefetch" href="/assets/js/88.e6f8ec26.js"><link rel="prefetch" href="/assets/js/89.24c96fbd.js"><link rel="prefetch" href="/assets/js/9.b8c9c0ed.js"><link rel="prefetch" href="/assets/js/90.a6a15ea3.js"><link rel="prefetch" href="/assets/js/91.3386a314.js"><link rel="prefetch" href="/assets/js/92.b2be18b1.js"><link rel="prefetch" href="/assets/js/93.9afe721c.js"><link rel="prefetch" href="/assets/js/94.6cb996fc.js"><link rel="prefetch" href="/assets/js/95.e28a0e9b.js"><link rel="prefetch" href="/assets/js/96.187bf387.js"><link rel="prefetch" href="/assets/js/97.bc059528.js"><link rel="prefetch" href="/assets/js/98.bad8f1e3.js"><link rel="prefetch" href="/assets/js/99.8812ae44.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5e6abf62.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/homepic.gif" alt="ZB-Notes" class="logo"> <span class="site-name can-hide">ZB-Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/Algorithm/LeetCode/" class="nav-link">
  Leetcode 题解
</a></li><li class="dropdown-item"><!----> <a href="/views/Algorithm/JZOffer/" class="nav-link">
  剑指 Offer 题解
</a></li><li class="dropdown-item"><!----> <a href="/views/Algorithm/PTA/PATBasicLevelPractice/" class="nav-link">
  PAT Basic Level Practice
</a></li><li class="dropdown-item"><!----> <a href="/views/Algorithm/PTA/PythonPractice/" class="nav-link">
  浙大版Python程序设计题目集
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端八股文" class="dropdown-title"><span class="title">前端八股文</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端八股文" class="mobile-dropdown-title"><span class="title">前端八股文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/JsGuide/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/views/JsGuide/Interview/" class="nav-link">
  高频面经
</a></li><li class="dropdown-item"><!----> <a href="/views/JsGuide/InterviewGuide/" class="nav-link">
  其他面经
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="WebPack" class="dropdown-title"><span class="title">WebPack</span> <span class="arrow down"></span></button> <button type="button" aria-label="WebPack" class="mobile-dropdown-title"><span class="title">WebPack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/intro/" class="nav-link">
  介绍
</a></li><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/base/" class="nav-link">
  基础配置
</a></li><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/senior/" class="nav-link">
  高级优化
</a></li><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/project/" class="nav-link">
  项目配置
</a></li><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/origin/" class="nav-link">
  原理分析
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/Vue/VueNotes/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/views/Vue/VueProject/" class="nav-link router-link-active">
  项目
</a></li></ul></div></div><div class="nav-item"><a href="/views/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/views/DesignPattern/" class="nav-link">
  设计模式
</a></div><div class="nav-item"><a href="https://github.com/Axehco" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/Algorithm/LeetCode/" class="nav-link">
  Leetcode 题解
</a></li><li class="dropdown-item"><!----> <a href="/views/Algorithm/JZOffer/" class="nav-link">
  剑指 Offer 题解
</a></li><li class="dropdown-item"><!----> <a href="/views/Algorithm/PTA/PATBasicLevelPractice/" class="nav-link">
  PAT Basic Level Practice
</a></li><li class="dropdown-item"><!----> <a href="/views/Algorithm/PTA/PythonPractice/" class="nav-link">
  浙大版Python程序设计题目集
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端八股文" class="dropdown-title"><span class="title">前端八股文</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端八股文" class="mobile-dropdown-title"><span class="title">前端八股文</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/JsGuide/JavaScript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/views/JsGuide/Interview/" class="nav-link">
  高频面经
</a></li><li class="dropdown-item"><!----> <a href="/views/JsGuide/InterviewGuide/" class="nav-link">
  其他面经
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="WebPack" class="dropdown-title"><span class="title">WebPack</span> <span class="arrow down"></span></button> <button type="button" aria-label="WebPack" class="mobile-dropdown-title"><span class="title">WebPack</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/intro/" class="nav-link">
  介绍
</a></li><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/base/" class="nav-link">
  基础配置
</a></li><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/senior/" class="nav-link">
  高级优化
</a></li><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/project/" class="nav-link">
  项目配置
</a></li><li class="dropdown-item"><!----> <a href="/views/WebPackNotes/origin/" class="nav-link">
  原理分析
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/views/Vue/VueNotes/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/views/Vue/VueProject/" class="nav-link router-link-active">
  项目
</a></li></ul></div></div><div class="nav-item"><a href="/views/Java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/views/DesignPattern/" class="nav-link">
  设计模式
</a></div><div class="nav-item"><a href="https://github.com/Axehco" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/views/Vue/VueProject/项目笔记.html" class="active sidebar-link">电商项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#项目问题" class="sidebar-link">项目问题</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_0-核心技术" class="sidebar-link">0 核心技术</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_1-node环境安装" class="sidebar-link">1 Node环境安装</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_2-git安装和配置" class="sidebar-link">2 Git安装和配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_2-1-git使用" class="sidebar-link">2.1 Git使用</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_2-2-补充-git-从远程分支下载到本地分支" class="sidebar-link">2.2 补充：git 从远程分支下载到本地分支</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_3-vue-cli4-0安装和使用" class="sidebar-link">3 Vue Cli4.0安装和使用</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-项目基础架构" class="sidebar-link">4 项目基础架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-1-跨域-cors" class="sidebar-link">4.1 跨域-CORS</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-2-跨域-jsonp" class="sidebar-link">4.2 跨域-JSONP</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-3-跨域-接口代理" class="sidebar-link">4.3 跨域-接口代理</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-4-需求分析" class="sidebar-link">4.4 需求分析</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-5-目录结构设置" class="sidebar-link">4.5 目录结构设置</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-6-安装插件" class="sidebar-link">4.6 安装插件</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-7-路由封装" class="sidebar-link">4.7 路由封装</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-8-storage封装" class="sidebar-link">4.8 Storage封装</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-9-接口错误拦截" class="sidebar-link">4.9 接口错误拦截</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-10-接口环境设置" class="sidebar-link">4.10 接口环境设置</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_4-11-mock设置" class="sidebar-link">4.11 Mock设置</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-商城首页" class="sidebar-link">5 商城首页</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-1-重置样式和样式规范" class="sidebar-link">5.1 重置样式和样式规范</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-2-navheader组件" class="sidebar-link">5.2 NavHeader组件</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-3-nav-footer组件" class="sidebar-link">5.3 Nav-Footer组件</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-4-service-bar组件" class="sidebar-link">5.4 Service-Bar组件</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-5-首页轮播功能实现" class="sidebar-link">5.5 首页轮播功能实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-6-首页广告位实现" class="sidebar-link">5.6 首页广告位实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-7-手机商品实现" class="sidebar-link">5.7 手机商品实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-8-modal-模态框-弹框-组件" class="sidebar-link">5.8 Modal(模态框,弹框)组件</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_5-9-图片懒加载" class="sidebar-link">5.9 图片懒加载</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_6-登录页面" class="sidebar-link">6 登录页面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_6-1-登录交互实现" class="sidebar-link">6.1 登录交互实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_6-2-拉取用户信息" class="sidebar-link">6.2 拉取用户信息</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_7-vuex集成" class="sidebar-link">7 Vuex集成</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_7-1-初步了解vuex" class="sidebar-link">7.1 初步了解Vuex</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_7-2-vuex框架搭建" class="sidebar-link">7.2 Vuex框架搭建</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_7-3-vuex实战应用" class="sidebar-link">7.3 Vuex实战应用</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_8-产品站页面" class="sidebar-link">8 产品站页面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_8-1-参数组件的实现" class="sidebar-link">8.1 参数组件的实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_8-2-参数组件的吸顶实现" class="sidebar-link">8.2 参数组件的吸顶实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_8-3-视频模块实现" class="sidebar-link">8.3 视频模块实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_8-4-slide动画实现" class="sidebar-link">8.4 Slide动画实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_8-5-产品站交互实现" class="sidebar-link">8.5 产品站交互实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_8-6-存在的问题" class="sidebar-link">8.6 存在的问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_9-商品详情交互实现" class="sidebar-link">9 商品详情交互实现</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_10-购物车页面" class="sidebar-link">10 购物车页面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_10-1-order-header组件" class="sidebar-link">10.1 Order-Header组件</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_10-2-购物车列表渲染" class="sidebar-link">10.2 购物车列表渲染</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_10-3-购物车全选和非全选" class="sidebar-link">10.3 购物车全选和非全选</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_10-4-购物车商品更新和删除" class="sidebar-link">10.4 购物车商品更新和删除</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_10-5-购物车结算" class="sidebar-link">10.5 购物车结算</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_11-elementui" class="sidebar-link">11 ElementUI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_11-1-elementui入门梳理" class="sidebar-link">11.1 ElementUI入门梳理</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_11-2-elementui运用" class="sidebar-link">11.2 ElementUI运用</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_11-3-bable介绍" class="sidebar-link">11.3 Bable介绍</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_11-4-退出功能实现" class="sidebar-link">11.4 退出功能实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_12-订单确认页面-订单结算" class="sidebar-link">12 订单确认页面 订单结算</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_12-1-订单父组件结构封装" class="sidebar-link">12.1 订单父组件结构封装</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_12-2-地址和商品数据加载" class="sidebar-link">12.2 地址和商品数据加载</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_12-3-地址增删改" class="sidebar-link">12.3 地址增删改</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_12-4-给选中的地址添加主题色的边框" class="sidebar-link">12.4 给选中的地址添加主题色的边框</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_12-5-订单结算" class="sidebar-link">12.5 订单结算</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_13-支付功能" class="sidebar-link">13 支付功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_13-1-订单详情数据加载" class="sidebar-link">13.1 订单详情数据加载</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_13-2-支付宝支付对接" class="sidebar-link">13.2 支付宝支付对接</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_13-3-微信支付对接" class="sidebar-link">13.3 微信支付对接</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_13-4-微信支付状态轮询" class="sidebar-link">13.4 微信支付状态轮询</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_14-订单列表" class="sidebar-link">14 订单列表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_14-1-调整order父组件结构" class="sidebar-link">14.1 调整Order父组件结构</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_14-2-订单列表数据渲染" class="sidebar-link">14.2 订单列表数据渲染</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_14-3-loading和nodata优化" class="sidebar-link">14.3 Loading和NoData优化</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_14-4-订单列表分页-分页器" class="sidebar-link">14.4 订单列表分页-分页器</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_14-5-订单列表分页-加载更多" class="sidebar-link">14.5 订单列表分页-加载更多</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_14-6-订单列表分页-滚动加载" class="sidebar-link">14.6 订单列表分页-滚动加载</a></li></ul></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_15-补充" class="sidebar-link">15 补充</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_15-1-保留分页器" class="sidebar-link">15.1 保留分页器</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_15-2-vue-config-js配置介绍" class="sidebar-link">15.2 vue.config.js配置介绍</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_15-3-路由按需加载方案" class="sidebar-link">15.3 路由按需加载方案</a></li><li class="sidebar-sub-header"><a href="/views/Vue/VueProject/项目笔记.html#_15-4-服务器部署准备工作" class="sidebar-link">15.4 服务器部署准备工作</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="电商项目"><a href="#电商项目" class="header-anchor">#</a> 电商项目</h1> <h2 id="项目问题"><a href="#项目问题" class="header-anchor">#</a> 项目问题</h2> <ol><li><p>直接在某个组件中用<code>background: url($img);</code> ，不会直接自动从public文件夹下开始读取内容？如在第5章中的NavHeader组件中直接使用<code>background: url('/imgs/mi-logo.png')</code>读取文件可能会发生错误。</p> <blockquote><p>当第5章中的<code>background: url('/imgs/mi-logo.png')</code>出现问题时，改为<code>background: url('../../public/imgs/mi-logo.png')</code>即可解决问题。即将绝对路径改为了相对路径。</p> <p>而该解决方法并不好。我们还是希望直接使用相对路径，并且项目会直接从public文件夹中找到对应的文件。通过与该项目的原文件进行对比，我们该问题是与node-sass和sass-loader的版本相关的，而它们的版本与node的版本也是有关系的。在将node的版本降级为14.19.0并重新安装node-sass(4.13.0)和sass-loader(8.0.0)后，就能得到我们想要的结果。注意：此时webpack的版本为4.41.2。</p></blockquote></li> <li><p>node node-sass sass-loader版本对应问题</p> <blockquote><p>前端开发中经常用到webpack常用的sass-loader、style-loader。之所以用到node-sass、是因为sass-loader的缘故。sass-loader 是将sass文件编译成css，而sass-loader又依赖于node-sass，所以需要安装node-sass。而node-sass依赖于node，所以要注意<strong>node-sass和node之间的版本支持</strong>。</p> <ul><li><p>可以使用nvm对node的版本进行管理和切换</p></li> <li><p>sass-loader与node-sass部分版本号对应</p> <p>sass-loader 4.1.1，node-sass 4.3.0</p> <p>sass-loader 7.0.3，node-sass 4.7.2</p> <p>sass-loader 7.3.1，node-sass 4.7.2</p> <p>sass-loader 7.3.1，node-sass 4.14.1</p> <p>sass-loader 10.0.1，node-sass 6.0.1</p></li></ul></blockquote> <blockquote><p>（小知识：style-loader的作用是将 JS 字符串生成为 style 节点、将样式插入到style标签。css-loader的作用是将 CSS 转化成 CommonJS 模块，例如url转为require等）</p></blockquote></li> <li><p>在将以上的版本改变后，可能会出现一个错误：就是 vue.config.js 中的 <code>defineConfig</code>不适用，调整一下就好了。</p></li> <li><p>第5章的logo中关于伪类元素:before的代码问题，当content中有内容时，背景图片就显示不出来，为什么？</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         a{
</span><span class="token prefix unchanged"> </span><span class="token line">               display:inline-block;	// 将a标签定义为行内块
</span><span class="token prefix unchanged"> </span><span class="token line">           	width:110px;	// 55*2，因为要把完整的图片放进去，因为存放的是两张图片
</span><span class="token prefix unchanged"> </span><span class="token line">               height:55px;
</span><span class="token prefix unchanged"> </span><span class="token line">           	&amp;:before{		// a:before伪类
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">             	  content: '';	// 因为图片没有内容，所以需要占位
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">                 display: inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">                 width:55px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 height:55px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                  background: url('/imgs/mi-logo.png') no-repeat center;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">                 background-size: 55px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 ......
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               ......
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span></span></code></pre></div></li> <li><p>为什么在ServiceBar组件中单独加入scoped不起作用了？</p> <blockquote><p>......</p></blockquote></li> <li><p>如图所示，NavHeader组件的logo图标显示有问题，即第二张图片被挤下去了</p></li></ol> <p><img src="data:image/png;base64,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" alt="image-20220710093903747"></p> <p>通过以下排查发现是因为before和after有一个margin-right=4px，这导致第二张图片被挤下去。
<img src="/assets/img/image-20220710094213613.ca1b060a.png" alt="image-20220710094213613"></p> <p><img src="/assets/img/image-20220710094301463.c45d15e1.png" alt="image-20220710094301463"></p> <p><img src="/assets/img/image-20220710094641415.62c964a0.png" alt="image-20220710094641415"></p> <ol start="7"><li><p>有关项目scss的引入问题</p> <p>为什么 在header组件中引入了base.scss中定义的container, 在index.vue中可以直接class=container使用，不需要引入？但是config.scss和mixin.scss却必须在每一个组件里面单独引入才可以使用，否则就会报错？</p> <p>答：引入的样式文件是全局的，除非加了scoped，否则其它文件能公用这个样式。而config和mixin他们本身不是页面样式，他们是定义的变量，用来做扩展的，为了能够提供一些高效的工具和方法，如果要用到里面的全局函数或者变量，就必须引入。他们跟页面里面定义的样式本质是不同的。</p></li></ol> <h2 id="_0-核心技术"><a href="#_0-核心技术" class="header-anchor">#</a> 0 核心技术</h2> <p><img src="/assets/img/image-20220614202723152.f98e145e.png" alt="image-20220614202723152"></p> <p><img src="/assets/img/hexinjishu.0cc2e5d0.png" alt="img"></p> <h2 id="_1-node环境安装"><a href="#_1-node环境安装" class="header-anchor">#</a> 1 Node环境安装</h2> <blockquote><p>讲解Node环境安装和配置，以及Node版本如何做卸载和升级</p></blockquote> <ol><li><strong>Node环境安装</strong></li> <li><strong>Node升降级</strong></li></ol> <h2 id="_2-git安装和配置"><a href="#_2-git安装和配置" class="header-anchor">#</a> 2 Git安装和配置</h2> <blockquote><p>介绍Git软件的安装和配置，其次对Git命令做详细的操作演示。</p></blockquote> <ol><li><strong>Git的安装</strong></li> <li><strong>Git配置</strong></li> <li><strong>Git配置SSH公钥</strong></li> <li><strong>VSCode操作Git</strong></li> <li><strong>Git常用命令</strong></li></ol> <blockquote><p>记住账号和密码（有两种方式：1. HTTPS—配置credential.helper；2.SSH—通过公钥）</p> <p>通过加密的方式生成RSA的公钥和私钥，同时把公钥部署到服务器上去</p> <p>VScode插件：Git History Diff</p></blockquote> <h3 id="_2-1-git使用"><a href="#_2-1-git使用" class="header-anchor">#</a> 2.1 Git使用</h3> <p><img src="/assets/img/image-20220614205132101.ef0d1897.png" alt="image-20220614205132101"></p> <p>配置git</p> <p><img src="/assets/img/image-20220614205157047.c76cd3d2.png" alt="image-20220614205157047"></p> <p>配置ssh添加公钥</p> <p><img src="/assets/img/image-20220614205331322.6c8483e2.png" alt="image-20220614205331322"></p> <p><code>git config —global credential.helper store</code></p> <p>设置为空  上面的方式不适合ssh</p> <p><code>git config —global credential.helper &quot;&quot;</code></p> <p><img src="/assets/img/image-20220614213418851.8d31aa66.png" alt="image-20220614213418851"></p> <p>tag</p> <p><img src="/assets/img/image-20220614220550220.9dab4b30.png" alt="image-20220614220550220"></p> <p>得到结果：</p> <p><img src="/assets/img/image-20220614220620232.82f04a26.png" alt="image-20220614220620232"></p> <p><img src="/assets/img/image-20220614220718892.23782e55.png" alt="image-20220614220718892"></p> <p>git revert 回退到XXX版本</p> <p>打开：</p> <p><img src="/assets/img/image-20220614221624324.436b47f2.png" alt="image-20220614221624324"></p> <p>复制这个即可</p> <p><img src="/assets/img/image-20220614221638851.f88b7da2.png" alt="image-20220614221638851"></p> <p>强制回退，没有历史记录：</p> <p><img src="/assets/img/image-20220614221939316.4abbd530.png" alt="image-20220614221939316"></p> <div class="language-bash extra-class"><pre class="language-bash"><code> <span class="token function">git</span> reset --hard f6871182ef018c28c51705692b96692cf1ea8dad
 
 <span class="token function">git</span> push origin master --force
</code></pre></div><p><img src="/assets/img/image-20220614222024036.9ec3c92f.png" alt="image-20220614222024036"></p> <p>可以看到，通通被清空了</p> <p><strong>删除分支的时候要注意：</strong></p> <ol><li><code>git branch</code> 查看本地分支，比如： testone testtwo 两个分支；</li> <li><code>git checkout testtwo</code> 切换到<strong>非删除分支</strong>，因为你想删除 testone，这里切到 testtwo 分支；</li> <li>执行 <code>git branch -d testone</code> 即可；</li></ol> <p><strong>上面的步骤3只是删除了本地的分支，并没有删除远程的分支，这点需要注意。</strong></p> <p>另外：你想用命令<strong>删除远程分支</strong>：<code>git push origin -d testone</code>；</p> <p>其他：<strong>git默认不区分文件大小写</strong>，可配置区分：<code>git config core.ignorecase false</code>；</p> <h3 id="_2-2-补充-git-从远程分支下载到本地分支"><a href="#_2-2-补充-git-从远程分支下载到本地分支" class="header-anchor">#</a> 2.2 补充：git 从远程分支下载到本地分支</h3> <p>以从http://git.xxx.com/test.git上拉去fast分支为例：</p> <p>1、新建空文件夹
2、初始化git
<code>git init</code></p> <p>3、与远程仓库建立连接
命令：<code>git remote add origin &lt;远程git地址&gt;</code>
例如：<code>git remote add origin http://git.xxx.com/test.git</code></p> <p>4、把远程分支拉去到本地
命令：<code>git fetch origin &lt;远程分支名称&gt;</code>
例如：<code>git fetch origin fast</code></p> <p>5、在本地建立分支localfast并切换到该分支，与远程分支建立连接
命令：<code>git checkout -b &lt;本地分支名称&gt; origin/&lt;远程分支&gt;</code>
例如：<code>git checkout -b localfast origin/fast</code></p> <p>6、拉取分支内容到本地分支
命令：<code>git pull origin &lt;远程分支名称&gt;</code>
例如：<code>git pull origin fast</code></p> <h2 id="_3-vue-cli4-0安装和使用"><a href="#_3-vue-cli4-0安装和使用" class="header-anchor">#</a> 3 Vue Cli4.0安装和使用</h2> <blockquote><p>首次对Vue脚手架4.0版本做安装和演示，并对可视化功能做详细介绍</p></blockquote> <ol><li><strong>VueCli4.0安装/使用</strong></li> <li><strong>Vue-DevTools安装使用</strong></li></ol> <div class="language- extra-class"><pre class="language-text"><code>vue ui
</code></pre></div><h2 id="_4-项目基础架构"><a href="#_4-项目基础架构" class="header-anchor">#</a> 4 项目基础架构</h2> <blockquote><p>前端基本项目架构，通过此章节可搭建一个通用性的前端架构，内容涵盖跨域方案、路由封装、错误拦截等</p></blockquote> <h3 id="_4-1-跨域-cors"><a href="#_4-1-跨域-cors" class="header-anchor">#</a> 4.1 跨域-CORS</h3> <blockquote><ul><li>跨域是浏览器为了安全而做出的限制策略(跨域问题只有前端存在，因为是浏览器设置的安全策略)</li> <li>浏览器请求必须遵循同源策略：同域名，同端口，同协议</li></ul></blockquote> <p>CORS跨域，服务端设置，前端直接调用。</p> <p>说明：后台允许前端某个站点进行访问。</p> <p><strong>安装axios</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i axios --save-dev
</code></pre></div><p><img src="/assets/img/image-20220615103850664.736d3787.png" alt="image-20220615103850664"></p> <h3 id="_4-2-跨域-jsonp"><a href="#_4-2-跨域-jsonp" class="header-anchor">#</a> 4.2 跨域-JSONP</h3> <p>JSONP跨域，前端适配，后台配合。</p> <p>说明：前后端同时改造。</p> <p><strong>安装jsonp</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> i jsonp --save-dev
</code></pre></div><p>Jsonp请求不是一个真正的请求，在XHR里面没有，可以看作是一段JS脚本</p> <p><img src="/assets/img/image-20220615104912608.8a86bfc3.png" alt="image-20220615104912608"></p> <p><img src="/assets/img/image-20220615104927657.09cc047c.png" alt="image-20220615104927657"></p> <p><strong>注意：</strong></p> <ul><li><p>cors请求，默认是任何人都可以请求，如果后端做了设置就可以做到只允许一些站点可以访问</p></li> <li><p>jsonp，是没有任何限制的请求接口的一段js代码，通过script标签本身就可以跨域请求的特性的一种方式。jsonp严格来说不是发送xmlhttpRequest请求，而是加载一个js脚本，服务器会响应，把信息返回给callback参数（res），来实现回调。</p></li> <li><p>所以说cors调用的接口在控制台 —network —XHR 可以找到</p></li> <li><p>而jsonp调用的接口在 控制台 —network —JS中可以找到</p></li></ul> <h3 id="_4-3-跨域-接口代理"><a href="#_4-3-跨域-接口代理" class="header-anchor">#</a> 4.3 跨域-接口代理</h3> <p>接口代理，通过修改nginx(或者node)服务器配置来实现。</p> <p>说明：前端修改，后台不动。</p> <p><strong>下图是实现接口代理跨域的原理：</strong></p> <p><img src="/assets/img/401.f0ab6bb3.f0ab6bb3.jpg" alt="401"></p> <p>在<code>vue.config.js</code>文件中配置，<code>vue.config.js</code>就是整个<code>webpack</code>的配置表，该配置表最终会传给node.js服务器来实现整个服务的设置。</p> <ul><li><code>vue.config.js</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span> <span class="token comment">//主机名</span>
        <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">8080</span><span class="token punctuation">,</span> <span class="token comment">//用于修改端口</span>
        <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">'/search'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'https://www.imooc.com'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//主机头</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>src/App.vue</code></li></ul> <div class="language-vue extra-class"><pre class="language-vue"><code>...
mounted(){
    let url = '/search/hotwords'
    jsonp(url,(err,res)=&gt;{
        let result = res
        this.data = result
    })
}
...
</code></pre></div><p>原接口地址：<code>https://www.imooc.com//search/hotwords</code>
进行上面代码进行代理之后，发现接口地址变为：</p> <p><img src="data:image/png;base64,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" alt="在这里插入图片描述"></p> <p>表面访问的是自己域名下的/search/xxx接口，实际是访问mooc网的/search/xxx接口，这样实现了跨域。</p> <blockquote><p><strong>具体怎么实现的呢？</strong></p></blockquote> <p>1 这段代码，当访问到的接口地址找到了/search，然后进行拦截，就会执行target，内部就会访问慕课网的接口（转发到慕课网上去）</p> <div class="language- extra-class"><pre class="language-text"><code>proxy: {
            '/search': {
                target: 'https://www.imooc.com',
                changeOrigin: true, //主机头
            }
        }
</code></pre></div><p>2 由于访问到了慕课网的接口，所以url地址直接写<code>'/search/hotwords'</code>即可，不用前面加慕课网的地址</p> <div class="language- extra-class"><pre class="language-text"><code>mounted(){
    let url = '/search/hotwords'
    jsonp(url,(err,res)=&gt;{
        let result = res
        this.data = result
    })
}
</code></pre></div><p>3 这是代理者，主机名和端口名。</p> <div class="language- extra-class"><pre class="language-text"><code>devServer: {
        host: 'localhost', //主机名
        port: 8080, //用于修改端口
</code></pre></div><blockquote><p>扩展：假设慕课网有很多个接口 <code>/a</code>,<code>/b</code>... 如果每个接口都进行代理拦截，很麻烦，我们可以建一个虚拟地址/api 来进行接口统一，由于虚拟的，实际上不访问/api 。要想实现虚拟，必须利用proxy中的pathRewrite，将其设置为空</p></blockquote> <p><img src="/assets/img/image-20220615121512962.967d07ee.png" alt="image-20220615121512962"></p> <p>可以看到就向是本地的服务一样。</p> <h3 id="_4-4-需求分析"><a href="#_4-4-需求分析" class="header-anchor">#</a> 4.4 需求分析</h3> <ol><li>熟悉文档、查看原型、读懂需求</li> <li>了解前端设计稿-设计前端业务架构</li> <li>了解后台接口文档-制定相关对接规范</li> <li>协调资源</li> <li>搭建前端架构</li></ol> <h3 id="_4-5-目录结构设置"><a href="#_4-5-目录结构设置" class="header-anchor">#</a> 4.5 目录结构设置</h3> <p><strong>1. 文件夹和文件</strong></p> <ul><li><p><code>resource</code>文件夹：静态资源文件夹</p></li> <li><p><code>public</code>文件夹：存放大图片和mock数据</p></li> <li><p><code>src\assets</code>文件夹：存放小图片，如icon图片，css图片等</p></li> <li><p><code>src\App.vue</code>为根组件，不动，放一个<code>&lt;router-view&gt;&lt;/router-view&gt;</code>，嵌套其他组件</p></li> <li><p><code>src\api\index.js</code>： api 是接口文件夹，承载整个项目api请求，把地址统一管理</p></li> <li><p><code>src\util\index.js</code> util一般放工具处理函数，就是一些公共的方法（比如：金额格式化，文字转换）</p></li> <li><p><code>src\storage\index.js</code> 数据存储的工具箱</p></li> <li><p><code>src\store</code>文件夹：存储关于vuex的相关配置</p></li> <li><p><code>src\router.js</code> ：承载路由</p></li> <li><p><code>src\pages</code>文件夹：通常存放路由组件</p></li> <li><p><code>src\components</code>文件夹：通常存放一般的组件</p></li></ul> <blockquote><p>建议将大图片放在public中，小图片放在assets。因为一般webpack会去抽取图片资源，小的图片如icon会打包成base64。将图片压缩成base64后会少一个请求，节约性能。</p></blockquote> <p><strong>.eslintrc.js 文件</strong> 在哪儿？https://blog.csdn.net/qq_57587705/article/details/124674660</p> <p><strong>2. 该项目的基本的目录结构</strong></p> <p><img src="/assets/img/20201212235413261.5567af91.png" alt="在这里插入图片描述"></p> <p><img src="/assets/img/20201212235439919.88f2e37c.png" alt="在这里插入图片描述"></p> <h3 id="_4-6-安装插件"><a href="#_4-6-安装插件" class="header-anchor">#</a> 4.6 安装插件</h3> <div class="language- extra-class"><pre class="language-text"><code>// 这里一定要注意 如果是vue2的项目，一定不能用4以上的vue-router，否则不兼容，会报错！！！
npm i vue-router@3.1.3
// vue2 对应的vuex 3版本
npm i vuex@3.4.0

// 懒加载插件
npm i vue-lazyload --save-dev

// 要按需加载
npm i element-ui --save-dev

// 解析sass （注意node-sass和sass-loader的版本）
npm i node-sass --save-dev
npm i sass-loader --save-dev
// npm i style-loader --save-dev

// 轮播
npm i vue-awesome-swiper --save-dev

// 方便把axios挂载在vue实例里面去，之前是this.$get去发请求，而axios需要在每个组件里面去通过axios.get发请求，同时需要引入import axios，引入了vue-axios后，只需要this.axios.get简化了导入的步骤
npm i vue-axios --save-dev

// 前后端交互，必须要能识别到，要用cookie的方式去传递，告诉后台我是谁
npm i vue-cookie --save-dev
</code></pre></div><h3 id="_4-7-路由封装"><a href="#_4-7-路由封装" class="header-anchor">#</a> 4.7 路由封装</h3> <ul><li>路由配置</li></ul> <p><code>src/router.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>import Vue from 'vue'
import Router from 'vue-router'
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// 导入路由组件
</span></span>import Home from '@/pages/home.vue'
import Index from '@/pages/index.vue'
import Product from '@/pages/product.vue'
import Detail from '@/pages/detail.vue'
import Cart from '@/pages/cart.vue'
import Order from '@/pages/order.vue'
import OrderList from '@/pages/orderList.vue'
import OrderConfirm from '@/pages/orderConfirm.vue'
import OrderPay from '@/pages/orderPay.vue'
import AliPay from '@/pages/alipay.vue'

<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> Vue.use(Router)
</span></span>
export default new Router({
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> // 路由配置
</span><span class="token prefix unchanged"> </span><span class="token line"> routes: [
</span><span class="token prefix unchanged"> </span><span class="token line"> // 一级路由1
</span><span class="token prefix unchanged"> </span><span class="token line">   {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      path: '/',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     name: 'home',
</span><span class="token prefix unchanged"> </span><span class="token line">     component: Home,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      redirect: '/index',		//重定向：首页'/'会自动跳转到'/index'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     children: [
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          path: '/index',		// 前面加了“/”
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         name: 'index',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: Index
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          path: '/product/:id', // params传参
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         name: 'index',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: Product
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          path: '/detail/:id', // params传参
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         name: 'detail',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: Detail
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     ]
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> // 一级路由2
</span><span class="token prefix unchanged"> </span><span class="token line">   {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      path: '/cart',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     name: 'cart',
</span><span class="token prefix unchanged"> </span><span class="token line">     component: Cart
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> // 一级路由3
</span><span class="token prefix unchanged"> </span><span class="token line">   {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      path: '/order',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     name: 'order',
</span><span class="token prefix unchanged"> </span><span class="token line">     component: Order,
</span><span class="token prefix unchanged"> </span><span class="token line">     children: [
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          path: 'list',   		// 前面不用再加“/”
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         name: 'order-list',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: OrderList
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          path: 'confirm',		// 前面不用再加“/”
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         name: 'order-confirm',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: OrderConfirm
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          path: 'pay',			// 前面不用再加“/”
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         name: 'order-pay',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: OrderPay
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          path: 'alipay',		// 前面不用再加“/”
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         name: 'alipay',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: AliPay
</span><span class="token prefix unchanged"> </span><span class="token line">       }  
</span><span class="token prefix unchanged"> </span><span class="token line">     ]
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> ]
</span></span>})
</code></pre></div><ul><li>使用路由</li></ul> <p><code>src/main.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>import Vue from 'vue'
import App from './App.vue'
// 导入路由
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import router from '@/router.js'
</span></span>
Vue.config.productionTip = false

new Vue({
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  router,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> render: h =&gt; h(App),
</span></span>}).$mount('#app')

</code></pre></div><p><strong>根据上面的路由分级，该项目整体架构：</strong></p> <ol><li>app为总体的根组件</li> <li>home 为index ，product ，detail的根组件，即index ，product ，detail为home的子路由。所以home的router-view相当于这三个组件的占位符(当然，这三个组件不会同时占用一个位置)。其中，index为首页，需要路由定向到/index 。由于index ，product ，detail三个组件的样式相同，头部和底部可以复用，所以home引用了NavHeader和NavFooter 组件。</li> <li>order为orderList， orderConfirm， orderPay， alipay的根组件，所以order的router-view相当于这四个组件的占位符(当然，这四个组件不会同时占用一个位置) 。这四个组件的样式也相同，头部底部可以复用，头部用一个OrderHeader，尾部用NavFooter。</li> <li>购物车（cart.vue）虽然样式与上着相同，但是要单独写，所以单独设为一个</li> <li>登录页面（login.vue）的样式也不同，所以分别单独设为一个架构</li></ol> <ul><li>初始化页面</li></ul> <p><code>src/Components/NavHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;nav-header组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'nav-header'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/Components/NavFooter.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;nav-footer组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'nav-footer'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/home.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;Home组件&lt;/h1&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;nav-header&gt;&lt;/nav-header&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;router-view&gt;&lt;/router-view&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;nav-footer&gt;&lt;/nav-footer&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import NavHeader from '@/components/NavHeader.vue'
</span><span class="token prefix inserted">+</span><span class="token line">import NavFooter from '@/components/NavFooter.vue'
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-home',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  components: { NavHeader, NavFooter }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/index.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;index组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-index'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/product.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> 	 &lt;h1&gt;product组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-product'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/detail.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;detail组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-detail'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/components/OrderHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;order-header组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'order-header',
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/cart.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;order-header&gt;&lt;/order-header&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;h1&gt;cart组件&lt;/h1&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;nav-footer&gt;&lt;/nav-footer&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>import OrderHeader from '@/components/OrderHeader.vue'
import NavFooter from '@/components/NavFooter.vue'
export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-cart',
</span><span class="token prefix unchanged"> </span><span class="token line"> components: { OrderHeader, NavFooter },
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/order.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;order-header&gt;&lt;/order-header&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;router-view&gt;&lt;/router-view&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;nav-footer&gt;&lt;/nav-footer&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>import OrderHeader from '@/components/OrderHeader.vue'
import NavFooter from '@/components/NavFooter.vue'
export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> components: { OrderHeader, NavFooter },
</span><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-order'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/orderList.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;order-list组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'order-list'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/orderComfirm.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;order-confirm组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'order-confirm'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/orderPay.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;order-pay组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'order-pay'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/alipay.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;h1&gt;alipay组件&lt;/h1&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-alipay'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style&gt;&lt;/style&gt;
</span></span></code></pre></div><h3 id="_4-8-storage封装"><a href="#_4-8-storage封装" class="header-anchor">#</a> 4.8 Storage封装</h3> <p><strong>1. Cookie，localStorage，sessionStorage三者区别？</strong></p> <ul><li><p>localStorage，sessionStorage都是一种缓存技术，一个是在本地永远存储，一个是在内存中存储</p></li> <li><p>存储大小：Cookie(4K)、Storage(5M)</p></li> <li><p>有效期：Cookie拥有有效期，Storage永久存储 (localStorage是本地永远储存，sessionStorage是存在内存中的会话存储，浏览器关闭后，sessionStorage存储的东西就没了)</p></li> <li><p>Cookie会发送到服务器端，Cookie存储在内存中，Storage只存储在浏览器端 (localStorage是存储在浏览器端，sessionStorage是存在内存中)</p></li> <li><p>路径：Cookie有路径限制，Storage只存储在域名下</p></li> <li><p>API：Cookie没有特定的API，Storage有对应的API (准确地说，Cookie和Storage都有API，只是Cookie的API稍微模糊一些)。</p></li></ul> <p><strong>2. 为什么要封装Storage，本身不是已经有API？</strong></p> <ul><li>Storage本身有APl，但是只是简单的key/value形式</li> <li>Storage只存储字符串，需要手工转换成json对象</li> <li>Storage只能一次性清空，不能单个清空</li></ul> <p><strong>3. Storage封装代码</strong></p> <p><code>src/storage/index.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * Storage封装
 */</span>
<span class="token keyword">const</span>  <span class="token constant">STORAGE_KEY</span> <span class="token operator">=</span> <span class="token string">'mall'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
  <span class="token comment">// 3. 存储值（这个值可以是简单的，可以是复杂的）</span>
  <span class="token function">setItem</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span>value<span class="token punctuation">,</span>module_name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>module_name<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>module_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      val<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>module_name<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 递归</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取整个Storage的信息</span>
      val<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>   <span class="token comment">// 存储值</span>
      <span class="token comment">// 每次插入数据之后，把值重新写入到Storage中</span>
      <span class="token comment">// 由于setItem的参数必须是字符串的格式，要进行转换</span>
      window<span class="token punctuation">.</span>sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token constant">STORAGE_KEY</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 2. 获取值</span>
  <span class="token function">getItem</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span>module_name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 如果传入了module_name，就是 获取某一个模块(module_name)下面的属性(key)</span>
    <span class="token comment">// 如获取user模块下面的userName属性</span>
    <span class="token comment">// 不传入module_name的情况下只获取key</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>module_name<span class="token punctuation">)</span><span class="token punctuation">{</span> 
      <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>module_name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 递归获取</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token keyword">return</span> val<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// val是一个对象</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 首先通过this.getStorage()获取整个Storage的信息，拿到以后再通过 [key] 得到具体的值</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 1. 获取整个数据</span>
  <span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 数据统一放在STORAGE_KEY = mall当中的</span>
    <span class="token comment">// 利用window.sessionstorage自带的api，getItem为自动转换成字符串格式，</span>
    <span class="token comment">// 并且需要再转换成json格式，方便以后封装和使用</span>
    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token constant">STORAGE_KEY</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">'{}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 4. 清空某一个模块下面的某个属性值</span>
  <span class="token comment">// 如清空user模块下面的userName属性</span>
  <span class="token function">clear</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> module_name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 获取整个Storage的信息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>module_name<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>val<span class="token punctuation">[</span>module_name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token keyword">delete</span> val<span class="token punctuation">[</span>module_name<span class="token punctuation">]</span><span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token comment">// 没有模块</span>
      <span class="token keyword">delete</span> val<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> 
    <span class="token comment">// 每次删除数据后，都要把值重新写入到Storage中</span>
    <span class="token comment">// 由于setItem的参数必须是字符串的格式，我们要进行转换</span>
    window<span class="token punctuation">.</span>sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token constant">STORAGE_KEY</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>测试：<code>src/App.vue</code></p> <p>疑点：必须先有模块，才能继续向里面设置值，不能添加模块并设置值</p> <p>比如：如果想实现 <code>user {name: 'zs'}</code>，不能直接<code>setItem('name', 'zs', 'user')</code>，必须先<code>setItem('user', {})</code>，再<code>setItem('name', 'zs')</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>...
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import storage from '@/storage/index.js'
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'App',
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted() {
</span><span class="token prefix unchanged"> </span><span class="token line"> 	// 添加信息
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // storage.setItem('name', 'zs', 'user')   // 报错
</span><span class="token prefix inserted">+</span><span class="token line">    storage.setItem('user', {})
</span><span class="token prefix inserted">+</span><span class="token line">    storage.setItem('name', 'zs', 'user')
</span></span>	// 删除信息
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">	storage.clear('name', 'user')
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>...
</code></pre></div><h3 id="_4-9-接口错误拦截"><a href="#_4-9-接口错误拦截" class="header-anchor">#</a> 4.9 接口错误拦截</h3> <p>错误怎么提示，取决于后台的<a href="https://so.csdn.net/so/search?q=%E6%9E%B6%E6%9E%84&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">架构<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，后台分底层和业务层，后台把底层的错误抛出来，给业务层，业务层把开发者编写的错误，封装成用户能看懂得错误。前端负责把错误展示给用户。</p> <p><strong>接口错误拦截得种类</strong></p> <ul><li>统一报错（不管是C端产品，还是后台管理系统，只要接口报错了，都能把错误提示给用户，该用户可能是C端的用户，可能是开发人员，也有可能是BOSS）</li> <li>未登录统一拦截 （权限设置）</li> <li>请求值，返回值统一处理</li></ul> <blockquote><p>同时发多个请求：Promise.all()，axios.all()</p></blockquote> <p><code>src/main.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>import Vue from 'vue'
// 导入路由
import router from '@/router.js'
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// 导入axios 和vue-axios
</span><span class="token prefix inserted">+</span><span class="token line">import axios from 'axios'
</span><span class="token prefix inserted">+</span><span class="token line">import VueAxios from 'vue-axios'
</span></span>// 导入组件
import App from './App.vue'

<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// 根据前端的跨域方式做调整 
</span><span class="token prefix inserted">+</span><span class="token line">// 1. 当跨域方式是JSONP或者CORS时，baseURL写成以下形式
</span><span class="token prefix inserted">+</span><span class="token line">// axios.defaults.baseURL = 'https://www.easy-mock.com/mock/5dc7afee2b69d9223b633cbb/mimall'; 
</span><span class="token prefix inserted">+</span><span class="token line">// 2. 当跨域方式为接口代理时，baseURL写成以下形式
</span><span class="token prefix inserted">+</span><span class="token line">// 比如访问的地址是/a/b，访问的时候变成/api/a/b，但是在转发的时候会去掉“/api”，从而得到/a/b
</span><span class="token prefix inserted">+</span><span class="token line">axios.defaults.baseURL = '/api'
</span><span class="token prefix inserted">+</span><span class="token line">axios.defaults.timeout = 8000   // 设置超时时间，提示用户体验感
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// 接口错误拦截
</span><span class="token prefix inserted">+</span><span class="token line">axios.interceptors.response.use(function(response) {
</span><span class="token prefix inserted">+</span><span class="token line">  let res = response.data
</span><span class="token prefix inserted">+</span><span class="token line">  //res中的status 是与后台协商的字段，这是定义的
</span><span class="token prefix inserted">+</span><span class="token line">  if(res.status == 0) {     // status为0表示成功
</span><span class="token prefix inserted">+</span><span class="token line">    return res.data
</span><span class="token prefix inserted">+</span><span class="token line">  } else if (res.status == 10) {    // status为10表示未登录的报错
</span><span class="token prefix inserted">+</span><span class="token line">    window.location.href = '/#/login'   // 跳转到登录页面，不能用$router.push()这些路由API，因为这是挂载在Vue实例上的，而此时并没有Vue实例
</span><span class="token prefix inserted">+</span><span class="token line">  } else {
</span><span class="token prefix inserted">+</span><span class="token line">    alert(res.msg)
</span><span class="token prefix inserted">+</span><span class="token line">  }
</span><span class="token prefix inserted">+</span><span class="token line">})
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// 使用vue-axios插件的原因是：方便把axios挂载在vue实例里面去，之前是this.$get去发请求，而axios需要在每个组件里面去通过axios.get发请求，同时需要引入import axios，引入了vue-axios后，只需要this.axios.get简化了导入的步骤
</span><span class="token prefix inserted">+</span><span class="token line">Vue.use(VueAxios, axios)
</span></span>
Vue.config.productionTip = false

new Vue({
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> router,
</span><span class="token prefix unchanged"> </span><span class="token line"> render: h =&gt; h(App),
</span></span>}).$mount('#app')
</code></pre></div><h3 id="_4-10-接口环境设置"><a href="#_4-10-接口环境设置" class="header-anchor">#</a> 4.10 接口环境设置</h3> <ul><li>开发上线的不同阶段，需要不同的配置（做一个项目，需要经历很多阶段，比如开发，测试，预发布，线上等等，不同阶段，调用的后台接口不同，需要不同的配置）</li> <li>不同的跨域方式，配置不同</li> <li>打包的时候统一注入环境参数，统一管理环境，输出不同的版本包</li></ul> <p><strong>1. 对于JONSP和CORS跨域方式，针对开发上线的不同阶段，设置的环境变量</strong></p> <p>遵循ES6模块化思想，将环境变量抽取到一个模块中，统一集中管理，建文件：<code>src/env.js</code></p> <ul><li><code>package.json</code></li></ul> <p>webpack的 <code>--mode</code>参数，被vue-cli集成。</p> <p><code>--mode</code>是我们注入一个参数，就是把环境变量传给我们的项目，这样项目才知道当前位于哪个参数。</p> <p><code>--mode</code>传参：--mode=开发环境，比如<code>--mode=development</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line"> &quot;scripts&quot;: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &quot;serve&quot;: &quot;vue-cli-service serve --mode=development&quot;,		// 开发环境只能叫development，不能改
</span><span class="token prefix inserted">+</span><span class="token line">    &quot;test&quot;: &quot;vue-cli-service serve --mode=test&quot;,				// 测试环境只能叫test，不能改
</span><span class="token prefix inserted">+</span><span class="token line">    &quot;build&quot;: &quot;vue-cli-service build --mode=production&quot;,		// 生产环境只能叫production，不能改
</span><span class="token prefix inserted">+</span><span class="token line">    &quot;prev&quot;: &quot;vue-cli-service serve --mode=prev&quot;, 				// 新增的环境，自定义的
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &quot;lint&quot;: &quot;vue-cli-service lint&quot;
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> ...
</span></span>}
</code></pre></div><p>**注意：**对于自定义的环境变量（如<code>--mode=prev</code>），需要建一个<code>.env.prev</code>文件(<code>.env.prev</code>中的<code>.prev</code>是与环境变量一致的)。</p> <p><code>.env.prev</code></p> <div class="language- extra-class"><pre class="language-text"><code>NODE_ENV='prev'
</code></pre></div><ul><li><code>src/env.js</code>：分环境设置不同的baseURL</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> baseURL<span class="token punctuation">;</span>
<span class="token comment">// 通过process.env.NODE_ENV获取当前传过来的参数（nodejs的知识点）</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token string">'development'</span><span class="token operator">:</span>
    baseURL <span class="token operator">=</span> <span class="token string">'http://dev-mall-pre.springboot.cn/api'</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token keyword">case</span> <span class="token string">'test'</span><span class="token operator">:</span>
    baseURL <span class="token operator">=</span> <span class="token string">'http://test-mall-pre.springboot.cn/api'</span><span class="token punctuation">;</span>		<span class="token comment">// 测试环境地址</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token keyword">case</span> <span class="token string">'prev'</span><span class="token operator">:</span>
    baseURL <span class="token operator">=</span> <span class="token string">'http://prev-mall-pre.springboot.cn/api'</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token keyword">case</span> <span class="token string">'prod'</span><span class="token operator">:</span>
    baseURL <span class="token operator">=</span> <span class="token string">'http://mall-pre.springboot.cn/api'</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token keyword">default</span><span class="token operator">:</span>
    baseURL <span class="token operator">=</span> <span class="token string">'http://mall-pre.springboot.cn/api'</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  baseURL
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>src/main.js</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code>...
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import env from './env'
</span></span>
// 根据前端的跨域方式做调整 
...
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// 当跨域方式是JSONP或者CORS时，根据环境变量获取不同的请求地址
</span><span class="token prefix inserted">+</span><span class="token line">axios.defaults.baseURL = env.baseURL;
</span></span>// 接口错误拦截
axios.interceptors.response.use(...);
...
</code></pre></div><blockquote><p>原理：首先npm run serve（test/prev），通过<code>--mode</code>的参数，把环境变量传给项目，这样项目才知道位于什么环境，env.js通过process.env.NODE_ENV收到环境变量，设置baseURL</p></blockquote> <p><strong>2. 对于代理的跨域方式，如果环境不同，修改的是vue.config.js文件</strong></p> <p>比如：</p> <ul><li><code>vue.config.js</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code>module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> devServer:{
</span><span class="token prefix unchanged"> </span><span class="token line">   host:'localhost',
</span><span class="token prefix unchanged"> </span><span class="token line">   port:8080,
</span><span class="token prefix unchanged"> </span><span class="token line">   proxy:{
</span><span class="token prefix unchanged"> </span><span class="token line">     '/api':{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        // target:'http://dev-mall-pre.springboot.cn',   // 注意dev是添加的环境变量参数
</span><span class="token prefix inserted">+</span><span class="token line">        target:'http://test-mall-pre.springboot.cn',   // 注意test是添加的环境变量参数
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       changeOrigin:true,
</span><span class="token prefix unchanged"> </span><span class="token line">       pathRewrite:{
</span><span class="token prefix unchanged"> </span><span class="token line">         '/api':''
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
</code></pre></div><ul><li><code>src/main.js</code></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> <span class="token string">'/api'</span><span class="token punctuation">;</span>	<span class="token comment">// 使用代理</span>
axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">8000</span><span class="token punctuation">;</span>  <span class="token comment">// 设置超时时间，提示用户体验感</span>
<span class="token operator">...</span>
</code></pre></div><h3 id="_4-11-mock设置"><a href="#_4-11-mock设置" class="header-anchor">#</a> 4.11 Mock设置</h3> <p>什么是Mock呢？ 就是模拟数据</p> <p>​		开发时，后端还没完成数据输出，前端只好写静态模拟数据。将数据写在js文件里，通过mock.js的一些语法 动态生成我们想要的数据 只需要和后台沟通一下 数据结构 以及key值之类的。</p> <p>​		前端的页面编写速度要快于后台的接口编写速率，为了减小联调时间，把重要的流程走完，之后之间换一个接口，进行小范围的修改即可，之前的时候，我们也是用假的数据，json文件的形式，这种数据假的不能再假，太不灵活了，而且还需要切换url。后来，前端工程师终于受不了，自己编写了mock，拦截客户端的ajax请求，直接给自己传数据。</p> <ul><li>开发阶段，为了提高效率，需要提前Mock</li> <li>减少代码冗余，灵活插拔</li> <li>减少沟通，减少接口联调时间</li></ul> <h4 id="方案1-本地创建json"><a href="#方案1-本地创建json" class="header-anchor">#</a> <strong>方案1：本地创建json</strong></h4> <p>前提是，后端和前端已经把接口先定义好了。</p> <ul><li><code>public/mock/user/login.json</code></li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin@51purse.com&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;phone&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;createTime&quot;</span><span class="token operator">:</span> <span class="token number">1479048325000</span><span class="token punctuation">,</span>
    <span class="token property">&quot;updateTime&quot;</span><span class="token operator">:</span> <span class="token number">1479048325000</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>src/App.vue</code>：删除之前与Storage相关的代码，添加以下代码</li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code>...
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'App',
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  	 // 1. 本地加载请求json文件的形式
</span><span class="token prefix inserted">+</span><span class="token line">    // 参数中不用带 public ,因为 public是根目录
</span><span class="token prefix inserted">+</span><span class="token line">    this.axios.get('/mock/user/login.json').then((res) =&gt; this.res = res) 
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>...
</code></pre></div><ul><li><code>src/main.js</code>：注释以下代码。有关<code>axios.defaults.baseURL</code> baseURL的语句都要注释掉，否则影响接口的引用，因为我们引用的是静态的文件。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>// axios.defaults.baseURL = '/api'
// axios.defaults.baseURL = env.baseURL;
</code></pre></div><blockquote><p>这种方式简单，但是1. 需要将<code>axios.defaults.baseURL = '/api'</code>代码干掉，因为请求的是一个静态文件。2. 同时 '/mock/user/login.json' 请求地址并不是真实的接口地址，所以需要在联调时把接口地址改一下。</p> <p>总之，这种方案的缺陷：
与后端对接时，需要更改代码：
①.重新设置<code>axios.defaults.baseURL</code>
②.正常实际的接口形式应该为<code>this.axios.get('/user/login')</code>没有/mock和json</p></blockquote> <h4 id="方案2-easy-mock平台"><a href="#方案2-easy-mock平台" class="header-anchor">#</a> <strong>方案2：easy-mock平台</strong></h4> <p>由于是免费的，所以用的人比较多，平台容易垮掉。</p> <ul><li>进入easy-mock官网</li></ul> <p><img src="/assets/img/2020052611503747.8d1422d2.png" alt="在这里插入图片描述"></p> <ul><li>点击右下角加号</li></ul> <p><img src="/assets/img/20200526115122625.20222010.png" alt="在这里插入图片描述"></p> <ul><li>项目名，和url随便填，然后点创建，首页生成一个</li></ul> <p><img src="data:image/png;base64,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" alt="在这里插入图片描述"></p> <ul><li>把链接粘贴到<code>main.js</code>的<code>axios.defaults.baseURL</code>中</li></ul> <div class="language- extra-class"><pre class="language-text"><code>axios.defaults.baseURL = ' https://www.easy-mock.com/mock/5ecc7f6172d5a41c9b506c49/boyu';
</code></pre></div><ul><li>创建接口：</li></ul> <p><img src="/assets/img/20200526115612961.f52aa06a.png" alt="在这里插入图片描述"></p> <ul><li><code>src/App.vue</code>中调用接口</li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code>...
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'App',
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  	 // 2. 通过easy-mock平台实现数据mock
</span><span class="token prefix inserted">+</span><span class="token line"> 	 // 与正常实际的接口格式相同，后期对接不需要更改
</span><span class="token prefix inserted">+</span><span class="token line">    this.axios.get('/user/login').then((res) =&gt; this.res = res) 
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>...
</code></pre></div><p><img src="/assets/img/20200526115855883.9b14db44.png" alt="在这里插入图片描述"></p> <blockquote><p>这种方式减少了代码污染，方便联调，这种方式是会发请求的。</p></blockquote> <blockquote><p><strong>注意：如果是cors或者jsonp跨域，我们需要更改env.js中的baseurl地址，换成mock地址</strong></p></blockquote> <h4 id="方案3-集成mock-api"><a href="#方案3-集成mock-api" class="header-anchor">#</a> <strong>方案3：集成Mock API</strong></h4> <p>首先加载mock.js</p> <p>github地址：https://github.com/easy-mock/easy-mock</p> <p>特点：mockjs()真的是用js来实现的一套插件库，它可以拦截数据，拦截请求，最后返回数据，但是它实际上并没有发生真实的请求，就等于是我们在发生请求的时候，它在代码层面就已经把它拦截到了，最后直接返回，而没有发生真正的请求。</p> <p>npm地址：https://www.npmjs.com/package/mockjs</p> <p>mockjs官网：http://mockjs.com/ （学习mockjs语法）</p> <ul><li>安装mockjs</li></ul> <div class="language- extra-class"><pre class="language-text"><code>cnpm i mockjs --save-dev
</code></pre></div><ul><li><code>src/main.js</code>：设置mock开关</li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code>...
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// mock开关
</span><span class="token prefix inserted">+</span><span class="token line">// 定义一个开关，用于控制是否使用mock（本地集成mockjs方式）
</span><span class="token prefix inserted">+</span><span class="token line">// 比如接口开发完成，联调时就不需要mock了
</span><span class="token prefix inserted">+</span><span class="token line">const mock = true
</span><span class="token prefix inserted">+</span><span class="token line">if(mock) {
</span><span class="token prefix inserted">+</span><span class="token line">  require('./mock/api')
</span><span class="token prefix inserted">+</span><span class="token line">}
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> axios.defaults.baseURL = '/api'
</span></span>...
</code></pre></div><blockquote><p>import 和 require 的区别</p> <ol><li><p>import 是预编译加载，也就是说在编译阶段时，import 引入的文件就会被加载进来，就被写入内存中。而 require 不会。</p></li> <li><p>require 引入的文件是在代码在从上到下执行过程中才会被加载，如上面代码中，当mock=false，文件就不会被加载。</p></li> <li><p>import语法是不能写在代码快中跟if else结合使用的，只能在文件顶部用来导入模块。</p></li></ol></blockquote> <ul><li>创建文件<code>src/mock/api.js</code>，用来专门定义mock文件，当<code>main.js</code>中的mock开关打开时，调用api.js</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Mock <span class="token keyword">from</span> <span class="token string">'mockjs'</span>
<span class="token comment">// 第一个参数是请求地址</span>
<span class="token comment">// 第二个参数是返回值</span>
Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span><span class="token string">'/api/user/login'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;id|10001-11000&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>	<span class="token comment">// 产生10001-11000之间的随机数</span>
    <span class="token string-property property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@cname&quot;</span><span class="token punctuation">,</span>	<span class="token comment">// @cname 产生一个随机的中文名字；@name 产生一个随机的英文名字；</span>
    <span class="token string-property property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;admin@51purse.com&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;phone&quot;</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;role&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;createTime&quot;</span><span class="token operator">:</span> <span class="token number">1479048325000</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;updateTime&quot;</span><span class="token operator">:</span> <span class="token number">1479048325000</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>src/App.vue</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'App',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  data () {
</span><span class="token prefix inserted">+</span><span class="token line">  	return {
</span><span class="token prefix inserted">+</span><span class="token line">  		res: {}
</span><span class="token prefix inserted">+</span><span class="token line">  	}
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mounted() {
</span><span class="token prefix unchanged"> </span><span class="token line">   // 1. 本地加载请求json文件的形式
</span><span class="token prefix unchanged"> </span><span class="token line">   // 参数中不用带 public ,因为 public是根目录
</span><span class="token prefix unchanged"> </span><span class="token line">   // this.axios.get('/mock/user/login.json').then((res) =&gt; this.res = res) 
</span><span class="token prefix unchanged"> </span><span class="token line">   // 2. 通过easy-mock平台实现数据mock
</span><span class="token prefix unchanged"> </span><span class="token line">   // 与正常实际的接口格式相同，后期对接不需要更改
</span><span class="token prefix unchanged"> </span><span class="token line">   // this.axios.get('/user/login').then((res) =&gt; this.res = res)
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 3. 本地集成mockjs(等于是一个mockAPI，实际上是一个插件，一个npm版本库)实现数据mock
</span><span class="token prefix inserted">+</span><span class="token line">	// 与正常实际的接口格式相同，后期对接不需要更改
</span><span class="token prefix inserted">+</span><span class="token line">    this.axios.get('/user/login').then((res) =&gt; this.res = res)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><blockquote><p><strong>不会发请求</strong>，但是可以看到数据。</p></blockquote> <p>返回的数据如下图：</p> <p><img src="/assets/img/image-20220616220134841.e9c28a97.png" alt="image-20220616220134841"></p> <h2 id="_5-商城首页"><a href="#_5-商城首页" class="header-anchor">#</a> 5 商城首页</h2> <blockquote><p>首页各个组件的静态代码实现，并实现了图片懒加载插件集成和Modal动画实现。</p></blockquote> <h3 id="_5-1-重置样式和样式规范"><a href="#_5-1-重置样式和样式规范" class="header-anchor">#</a> 5.1 重置样式和样式规范</h3> <ul><li><code>src/assets/scss/reset.scss</code>：将浏览器给网页内置的样式覆盖掉</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">body,div,p,h1,h2,h3,h4,h5,h6,ul,li,dl,dt,a,input,button,textarea,select</span><span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">html,body</span><span class="token punctuation">{</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span>Helvetica Neue<span class="token punctuation">,</span>Helvetica<span class="token punctuation">,</span>Arial<span class="token punctuation">,</span>Microsoft Yahei<span class="token punctuation">,</span>Hiragino Sans GB<span class="token punctuation">,</span>Heiti SC<span class="token punctuation">,</span>WenQuanYi Micro Hei<span class="token punctuation">,</span>sans-serif<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #333333<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #ffffff<span class="token punctuation">;</span>
  // 最小安全距离：在做网页开发时一定要有安全距离，也就是说不管电脑屏幕的分辨率是多大，需要保证搭建的网站有关安全距离。此处的最小安全距离设置为1226px，如果电脑屏幕的分辨率是900的或800的，那么也会按照1226去展示，那么会撑开。
  <span class="token property">min-width</span><span class="token punctuation">:</span> 1226px<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">a</span><span class="token punctuation">{</span>
  <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">ul,li</span><span class="token punctuation">{</span>
  <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">input</span><span class="token punctuation">{</span>
  <span class="token property">font</span><span class="token punctuation">:</span> normal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">input:focus,a:focus</span><span class="token punctuation">{</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><code>src/assets/scss/config.scss</code>：配置信息。将常规的字体大小和颜色提取出来。通过scss预处理器可以实现预编译，可以提前定义变量，通过加载变量来动态实现一个样式的功能。</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/*
  样式规范表
*/</span>
$<span class="token property">min-width</span><span class="token punctuation">:</span>1226px<span class="token punctuation">;</span>  //容器安全区域宽度

// 常规字体大小设置
$<span class="token property">fontA</span><span class="token punctuation">:</span>       80px<span class="token punctuation">;</span> //产品站大标题
$<span class="token property">fontB</span><span class="token punctuation">:</span>       38px<span class="token punctuation">;</span> //产品站标题
$<span class="token property">fontC</span><span class="token punctuation">:</span>       28px<span class="token punctuation">;</span> //导航标题
$<span class="token property">fontD</span><span class="token punctuation">:</span>       26px<span class="token punctuation">;</span> //产品站副标题
$<span class="token property">fontE</span><span class="token punctuation">:</span>       24px<span class="token punctuation">;</span> 
$<span class="token property">fontF</span><span class="token punctuation">:</span>       22px<span class="token punctuation">;</span>
$<span class="token property">fontG</span><span class="token punctuation">:</span>       20px<span class="token punctuation">;</span> //用在较为重要的文字、操作按钮
$<span class="token property">fontH</span><span class="token punctuation">:</span>       18px<span class="token punctuation">;</span> //用于大多数文字
$<span class="token property">fontI</span><span class="token punctuation">:</span>       16px<span class="token punctuation">;</span> //用于辅助性文字
$<span class="token property">fontJ</span><span class="token punctuation">:</span>       14px<span class="token punctuation">;</span> //用于一般文字
$<span class="token property">fontK</span><span class="token punctuation">:</span>       12px<span class="token punctuation">;</span> //系统默认大小

// 常规配色设置
$<span class="token property">colorA</span><span class="token punctuation">:</span>      #FF6600 !default<span class="token punctuation">;</span> //用于需要突出和强调的文字、按钮和icon
$<span class="token property">colorB</span><span class="token punctuation">:</span>      #333333 !default<span class="token punctuation">;</span> //用于较为重要的文字信息、内页标题等
$<span class="token property">colorC</span><span class="token punctuation">:</span>      #666666 !default<span class="token punctuation">;</span> //用于普通段落信息 引导词
$<span class="token property">colorD</span><span class="token punctuation">:</span>      #999999 !default<span class="token punctuation">;</span> //用于辅助、次要的文字信息、普通按钮的描边
$<span class="token property">colorE</span><span class="token punctuation">:</span>      #cccccc !default<span class="token punctuation">;</span> //用于特别弱的文字
$<span class="token property">colorF</span><span class="token punctuation">:</span>      #d7d7d7 !default<span class="token punctuation">;</span> //用于列表分割线、标签秒变
$<span class="token property">colorG</span><span class="token punctuation">:</span>      #ffffff !default<span class="token punctuation">;</span> //用于导航栏文字、按钮文字、白色背景
$<span class="token property">colorH</span><span class="token punctuation">:</span>      #e5e5e5 !default<span class="token punctuation">;</span> //用于上下模块分割线
$<span class="token property">colorI</span><span class="token punctuation">:</span>      #000000 !default<span class="token punctuation">;</span> //纯黑色背景，用于遮罩层
$<span class="token property">colorJ</span><span class="token punctuation">:</span>      #F5F5F5 !default<span class="token punctuation">;</span> //弹框标题背景色
$<span class="token property">colorK</span><span class="token punctuation">:</span>      #FFFAF7 !default<span class="token punctuation">;</span> //订单标题背景色
</code></pre></div><p><code>src/App.vue</code>：引用以上样式</p> <div class="language-diff extra-class"><pre class="language-diff"><code>...
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span>@import './assets/scss/reset.scss';
@import './assets/scss/config.scss';
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span>...
</code></pre></div><h3 id="_5-2-navheader组件"><a href="#_5-2-navheader组件" class="header-anchor">#</a> 5.2 NavHeader组件</h3> <h4 id="_5-2-1-基本样式-不做提取公共样式-变量等处理"><a href="#_5-2-1-基本样式-不做提取公共样式-变量等处理" class="header-anchor">#</a> 5.2.1 基本样式—不做提取公共样式，变量等处理</h4> <ul><li><code>src/components/NavHeader.vue</code>：<strong>NavHeader头部组件</strong>有<strong>nav-topbar顶部条</strong>和<strong>nav-header导航菜单</strong>两部分组成，此处首先实现<strong>nav-topbar顶部条</strong>的基本结构和样式（其中有一些样式是公共的，以后会提取出来）</li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;nav-topbar&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;!--创建顶部菜单栏上面的小菜单栏--&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;!--创建容器--&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!--创建菜单--&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;topbar-menu&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;!-- 通过在a标签中设置 href=&quot;javascript:;&quot; 可以防止页面刷新 --&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;小米商城&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;MUI&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;云服务&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;协议规则&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;topbar-user&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;登录&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;注册&lt;/a&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          &lt;a href=&quot;javascript:;&quot; class=&quot;my-cart&quot;&gt;&lt;span class=&quot;icon-cart&quot;&gt;&lt;/span&gt;购物车&lt;/a&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;nav-header&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'nav-header'
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .header {
</span><span class="token prefix unchanged"> </span><span class="token line">   .nav-topbar {
</span><span class="token prefix unchanged"> </span><span class="token line">     height:39px;
</span><span class="token prefix unchanged"> </span><span class="token line">     line-height:39px;
</span><span class="token prefix unchanged"> </span><span class="token line">     background-color:#333333;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     color:#B0B0B0;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     .container {
</span><span class="token prefix unchanged"> </span><span class="token line">       width:1226px;
</span><span class="token prefix unchanged"> </span><span class="token line">       margin-right:auto;
</span><span class="token prefix unchanged"> </span><span class="token line">       margin-left:auto;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     	// flex布局实现两边对齐  class=&quot;topbar-menu&quot; 和 class=&quot;nav-header&quot;左边一块右边一块
</span><span class="token prefix inserted">+</span><span class="token line">      	display:flex;		
</span><span class="token prefix inserted">+</span><span class="token line">      	justify-content:space-between;	// 两边对齐
</span><span class="token prefix inserted">+</span><span class="token line">      	align-items: center;		// 垂直方向居中
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      	a {	// 上面设置的字体颜色没有生效，因为a标签也有自己内置的样式的，所以需要将a标签的样式填充掉
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         display: inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">         color:#B0B0B0;	
</span><span class="token prefix unchanged"> </span><span class="token line">         margin-right: 17px;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .my-cart {
</span><span class="token prefix unchanged"> </span><span class="token line">         width:110px;
</span><span class="token prefix unchanged"> </span><span class="token line">         background-color:#FF6600;
</span><span class="token prefix unchanged"> </span><span class="token line">         text-align: center;
</span><span class="token prefix unchanged"> </span><span class="token line">         color:#ffffff;
</span><span class="token prefix unchanged"> </span><span class="token line">         .icon-cart {
</span><span class="token prefix unchanged"> </span><span class="token line">           display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">           width:16px;
</span><span class="token prefix unchanged"> </span><span class="token line">           height:12px;
</span><span class="token prefix unchanged"> </span><span class="token line">           background:url('/imgs/icon-cart-checked.png') no-repeat center;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">           background-size: contain;	// 填充填满
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           margin-right:4px ;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   } 
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p>效果展示：</p> <p><img src="/assets/img/20201213194122566.43888f7b.png" alt="在这里插入图片描述"></p> <ul><li><code>src/components/NavHeader.vue</code>：此处实现<strong>nav-header导航菜单</strong>的基本结构和样式（其中有一些样式是公共的，以后会提取出来）</li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;nav-topbar&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;nav-header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     	&lt;!-- 1.logo --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;header-logo&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;/#/index&quot;&gt;&lt;/a&gt;				  &lt;!-- 点击logo，跳转到首页 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 2.菜单 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;header-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;!-- 有下拉区域，所以用div, div下面再放子元素 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span&gt;小米手机&lt;/span&gt;					&lt;!-- 标题 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;		   &lt;!-- 放子元素，其中应该是有列表元素li --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span&gt;ReadMi红米&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span&gt;电视&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 3.搜索 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;header-search&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;wrapper&quot;&gt;						&lt;!-- wrapper也是一个内置的样式，辅助我们做一些定位 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;input type=&quot;text&quot; name=&quot;keyword&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;javascript:;&quot;&gt;&lt;/a&gt;				&lt;!-- 会用占位会给它设置一个背景图片 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'nav-header'
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .header{
</span><span class="token prefix unchanged"> </span><span class="token line">   .nav-topbar{.............}
</span><span class="token prefix unchanged"> </span><span class="token line">   .nav-header{
</span><span class="token prefix unchanged"> </span><span class="token line">     .container{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">         height:112px;
</span></span>		 width:1226px;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">        margin-right:auto;
</span><span class="token prefix unchanged"> </span><span class="token line">        margin-left:auto;
</span></span>	     display:flex;		
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     	 justify-content:space-between;	// 两边对齐
</span><span class="token prefix unchanged"> </span><span class="token line">     	 align-items: center;		// 垂直方向居中
</span><span class="token prefix unchanged"> </span><span class="token line">       .header-logo{
</span><span class="token prefix unchanged"> </span><span class="token line">         display:inline-block;		
</span><span class="token prefix unchanged"> </span><span class="token line">         width:55px;
</span><span class="token prefix unchanged"> </span><span class="token line">         height:55px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          background-color:#FF6600;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         a{
</span><span class="token prefix unchanged"> </span><span class="token line">           display:inline-block;	// 将a标签定义为行内块
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            width:110px;	// 55*2，因为要把完整的图片放进去，因为存放的是两张图片
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           height:55px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            &amp;:before{		// a:before伪类
</span><span class="token prefix inserted">+</span><span class="token line">              content: '';	// 因为图片没有内容，所以需要占位
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">             display: inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">             width:55px;
</span><span class="token prefix unchanged"> </span><span class="token line">             height:55px;
</span><span class="token prefix unchanged"> </span><span class="token line">             background: url('/imgs/mi-logo.png') no-repeat center;
</span><span class="token prefix unchanged"> </span><span class="token line">             background-size: 55px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              transition:margin .2s;	// 指定需要过渡的元素为margin，时间为0.2s
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            &amp;:after{	// a:after伪类
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">             content: '';
</span><span class="token prefix unchanged"> </span><span class="token line">             display: inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">             width:55px;
</span><span class="token prefix unchanged"> </span><span class="token line">             height:55px;
</span><span class="token prefix unchanged"> </span><span class="token line">             background: url('/imgs/mi-home.png') no-repeat center;
</span><span class="token prefix unchanged"> </span><span class="token line">             background-size: 55px;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            /* 当鼠标经过了a链接时，就让里面before的margin-left 设置为 -55px */
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &amp;:hover:before{		// 鼠标经过，
</span><span class="token prefix unchanged"> </span><span class="token line">             margin-left: -55px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              transition: margin .2s;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .header-menu{
</span><span class="token prefix unchanged"> </span><span class="token line">       display:inline-block; 
</span><span class="token prefix unchanged"> </span><span class="token line">       width:643px;
</span><span class="token prefix unchanged"> </span><span class="token line">       padding-left:209px;
</span><span class="token prefix unchanged"> </span><span class="token line">       .item-menu {
</span><span class="token prefix unchanged"> </span><span class="token line">         display: inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">         color: #333333;
</span><span class="token prefix unchanged"> </span><span class="token line">         font-weight: bold;
</span><span class="token prefix unchanged"> </span><span class="token line">         font-size: 16px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          line-height: 112px;		// 高度和行高都是112px，实现垂直居中
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         margin-right: 20px;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         span {
</span><span class="token prefix unchanged"> </span><span class="token line">           cursor: pointer;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         &amp;:hover {
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .header-search {
</span><span class="token prefix unchanged"> </span><span class="token line">         width:319px;
</span><span class="token prefix unchanged"> </span><span class="token line">         .wrapper{
</span><span class="token prefix unchanged"> </span><span class="token line">           height:50px;
</span><span class="token prefix unchanged"> </span><span class="token line">           border:1px solid #E0E0E0;
</span><span class="token prefix unchanged"> </span><span class="token line">           // 用flex布局设置垂直居中，这样图标也会垂直居中
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            display:flex;	
</span><span class="token prefix inserted">+</span><span class="token line">            align-items:center;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           input{
</span><span class="token prefix unchanged"> </span><span class="token line">             border: none;
</span><span class="token prefix unchanged"> </span><span class="token line">             box-sizing:border-box;
</span><span class="token prefix unchanged"> </span><span class="token line">             border-right:1px solid #E0E0E0;
</span><span class="token prefix unchanged"> </span><span class="token line">             width:264px;
</span><span class="token prefix unchanged"> </span><span class="token line">             height:50px;
</span><span class="token prefix unchanged"> </span><span class="token line">             padding-left: 14px;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           a{
</span><span class="token prefix unchanged"> </span><span class="token line">             display: inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">             width:18px;
</span><span class="token prefix unchanged"> </span><span class="token line">             height:18px;
</span><span class="token prefix unchanged"> </span><span class="token line">             background: url('/imgs/icon-search.png') no-repeat center;
</span><span class="token prefix unchanged"> </span><span class="token line">             background-size: contain;
</span><span class="token prefix unchanged"> </span><span class="token line">             margin-left: 17px;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><blockquote><p>logo部分原理：可视化区域（相框）固定大小（高宽55px），图片素材，里面有两张平铺开的，左边右边各一张，当鼠标移动的时候，控制<code>：before</code>的margin值为-55px。</p></blockquote> <h4 id="_5-2-2-提取公共样式-变量等"><a href="#_5-2-2-提取公共样式-变量等" class="header-anchor">#</a> 5.2.2 提取公共样式，变量等</h4> <ul><li><code>src/assets/scss/base.scss</code>：提取出一些公共样式。提取以上代码的公共样式：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>.container{	
  width:1226px;
  margin-right:auto;
  margin-left:auto;
}
</code></pre></div><ul><li><code>src/assets/scss/mixin.scss</code>：可以把变量抽取出来，甚至把一些样式定义成方法。提取以上代码的变量等</li></ul> <div class="language- extra-class"><pre class="language-text"><code>//flex布局复用
@mixin flex($hov:space-between,$col:center){
  display:flex;
  justify-content:$hov;
  align-items:$col;
}
//背景图片复用
@mixin bgImg($w:0,$h:0,$img:'',$size:contain){
  display:inline-block;
  width:$w;
  height:$h;
  background:url($img) no-repeat center;
  background-size:$size;
  margin-right: 4px;
}
</code></pre></div><ul><li><code>src/components/NavHeader.vue</code>：修改的样式</li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code>...
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  @import './../assets/scss/base.scss';
</span><span class="token prefix inserted">+</span><span class="token line">  @import './../assets/scss/mixin.scss';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .header{
</span><span class="token prefix unchanged"> </span><span class="token line">   .nav-topbar{
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">     .container{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">         @include flex();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       a{...}
</span><span class="token prefix unchanged"> </span><span class="token line">       .my-cart{
</span><span class="token prefix unchanged"> </span><span class="token line">         ...
</span><span class="token prefix unchanged"> </span><span class="token line">         .icon-cart{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">           @include bgImg(16px,12px,'/imgs/icon-cart-checked.png');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           margin-right:4px ;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .nav-header{
</span><span class="token prefix unchanged"> </span><span class="token line">     .container{
</span><span class="token prefix unchanged"> </span><span class="token line">       height:112px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">         @include flex();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       .header-logo{
</span><span class="token prefix unchanged"> </span><span class="token line">         ...
</span><span class="token prefix unchanged"> </span><span class="token line">         a{
</span><span class="token prefix unchanged"> </span><span class="token line">           ...
</span><span class="token prefix unchanged"> </span><span class="token line">           &amp;:before{
</span><span class="token prefix unchanged"> </span><span class="token line">             content: '';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              @include  bgImg(55px,55px,'/imgs/mi-logo.png',55px);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">             transition:margin .2s;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           &amp;:after{
</span><span class="token prefix unchanged"> </span><span class="token line">             content: '';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              @include bgImg(55px,55px,'/imgs/mi-home.png',55px);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           &amp;:hover:before{
</span><span class="token prefix unchanged"> </span><span class="token line">             ...
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .header-menu{
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">       .item-menu {
</span><span class="token prefix unchanged"> </span><span class="token line">        ...
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .header-search{
</span><span class="token prefix unchanged"> </span><span class="token line">         width:319px;
</span><span class="token prefix unchanged"> </span><span class="token line">         .wrapper{
</span><span class="token prefix unchanged"> </span><span class="token line">           ...
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           a{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              @include bgImg(18px,18px,'/imgs/icon-search.png');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">             margin-left: 17px;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h4 id="_5-2-3-nav-header的下拉菜单-交互功能"><a href="#_5-2-3-nav-header的下拉菜单-交互功能" class="header-anchor">#</a> 5.2.3 nav-header的下拉菜单 &amp; 交互功能</h4> <ul><li><code>src/components/NavHeader.vue</code></li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> 
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;nav-topbar&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;topbar-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;!-- 通过在a标签中设置 href=&quot;javascript:;&quot; 可以防止页面刷新 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;小米商城&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;MUI&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;云服务&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot;&gt;协议规则&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;topbar-user&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot; v-if=&quot;username&quot;&gt;{{username}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot; v-if=&quot;!username&quot; @click=&quot;login&quot;&gt;登录&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot; v-if=&quot;username&quot; @click=&quot;logout&quot;&gt;退出&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;/#/order/list&quot; v-if=&quot;username&quot;&gt;我的订单&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;javascript:;&quot; class=&quot;my-cart&quot; @click=&quot;goToCart&quot;&gt;&lt;span class=&quot;icon-cart&quot;&gt;&lt;/span&gt;购物车({{cartCount}})&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">      
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;nav-header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;header-logo&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;/#/index&quot;&gt;&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;header-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span&gt;小米手机&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;children&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;li class=&quot;product&quot; v-for=&quot;(item,index) in phoneList&quot; :key=&quot;index&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">               &lt;!--特殊情况链接&lt;a&gt;里面可以放块级元素，但是给&lt;a&gt;转换一下块级模式最安全--&gt;
</span></span>				 &lt;a v-bind:href=&quot;'/#/product/'+item.id&quot; target=&quot;_blank&quot;&gt;
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;img v-lazy=&quot;item.mainImage&quot; :alt=&quot;item.subtitle&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-name&quot;&gt;{{item.name}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-price&quot;&gt;{{item.price | currency}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span&gt;RedMi红米&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span&gt;电视&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;children&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;li class=&quot;product&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;img v-lazy=&quot;'/imgs/nav-img/nav-3-1.jpg'&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-name&quot;&gt;小米壁画电视 65英寸&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-price&quot;&gt;6999元&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;li class=&quot;product&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;img v-lazy=&quot;'/imgs/nav-img/nav-3-2.jpg'&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-name&quot;&gt;小米全面屏电视E55A&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-price&quot;&gt;1999元&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;li class=&quot;product&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;img v-lazy=&quot;'/imgs/nav-img/nav-3-3.png'&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-name&quot;&gt;小米电视4A 32英寸&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-price&quot;&gt;699元&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;li class=&quot;product&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;img v-lazy=&quot;'/imgs/nav-img/nav-3-4.jpg'&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-name&quot;&gt;小米电视4A 55英寸&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-price&quot;&gt;1799元&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;li class=&quot;product&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;img v-lazy=&quot;'/imgs/nav-img/nav-3-5.jpg'&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-name&quot;&gt;小米电视4A 65英寸&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-price&quot;&gt;2699元&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;li class=&quot;product&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;&quot; target=&quot;_blank&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;img v-lazy=&quot;'/imgs/nav-img/nav-3-6.png'&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-name&quot;&gt;查看全部&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;pro-price&quot;&gt;查看全部&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;header-search&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;wrapper&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;input type=&quot;text&quot; name=&quot;keyword&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;javascript:;&quot;&gt;&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import {mapState} from 'vuex'
</span><span class="token prefix unchanged"> </span><span class="token line"> export default{
</span><span class="token prefix unchanged"> </span><span class="token line">   name:'nav-header',
</span><span class="token prefix unchanged"> </span><span class="token line">   data(){
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       phoneList:[]
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   computed:{
</span><span class="token prefix unchanged"> </span><span class="token line">     /*username(){
</span><span class="token prefix unchanged"> </span><span class="token line">       return this.$store.state.username;
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     cartCount(){
</span><span class="token prefix unchanged"> </span><span class="token line">       return this.$store.state.cartCount;
</span><span class="token prefix unchanged"> </span><span class="token line">     }*/
</span><span class="token prefix unchanged"> </span><span class="token line">     ...mapState(['username','cartCount'])
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   filters:{
</span><span class="token prefix unchanged"> </span><span class="token line">     currency(val){
</span><span class="token prefix unchanged"> </span><span class="token line">       if(!val)return '0.00';
</span><span class="token prefix unchanged"> </span><span class="token line">       return '￥' + val.toFixed(2) + '元';
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.getProductList();
</span><span class="token prefix unchanged"> </span><span class="token line">     let params = this.$route.params;
</span><span class="token prefix unchanged"> </span><span class="token line">     if(params &amp;&amp; params.from == 'login'){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.getCartCount();
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">     login(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push('/login');
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     getProductList(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/products',{
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span><span class="token prefix unchanged"> </span><span class="token line">           categoryId:'100012',
</span><span class="token prefix unchanged"> </span><span class="token line">           pageSize:6
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.phoneList = res.list;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     getCartCount(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/carts/products/sum').then((res=0)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.$store.dispatch('saveCartCount',res);
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     logout(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.post('/user/logout').then(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.$message.success('退出成功');
</span><span class="token prefix unchanged"> </span><span class="token line">         this.$cookie.set('userId','',{expires:'-1'});
</span><span class="token prefix unchanged"> </span><span class="token line">         this.$store.dispatch('saveUserName','');
</span><span class="token prefix unchanged"> </span><span class="token line">         this.$store.dispatch('saveCartCount','0');
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     goToCart(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push('/cart');
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> @import './../assets/scss/base.scss';
</span><span class="token prefix unchanged"> </span><span class="token line"> @import './../assets/scss/mixin.scss';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  @import './../assets/scss/config.scss';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .header{
</span><span class="token prefix unchanged"> </span><span class="token line">   .nav-topbar{
</span><span class="token prefix unchanged"> </span><span class="token line">     height:39px;
</span><span class="token prefix unchanged"> </span><span class="token line">     line-height:39px;
</span><span class="token prefix unchanged"> </span><span class="token line">     background-color:#333333;
</span><span class="token prefix unchanged"> </span><span class="token line">     color:#B0B0B0;
</span><span class="token prefix unchanged"> </span><span class="token line">     .container{
</span><span class="token prefix unchanged"> </span><span class="token line">       @include flex();
</span><span class="token prefix unchanged"> </span><span class="token line">       a{
</span><span class="token prefix unchanged"> </span><span class="token line">         display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">         color:#B0B0B0;
</span><span class="token prefix unchanged"> </span><span class="token line">         margin-right:17px;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .my-cart{
</span><span class="token prefix unchanged"> </span><span class="token line">         width:110px;
</span><span class="token prefix unchanged"> </span><span class="token line">         background-color:#FF6600;
</span><span class="token prefix unchanged"> </span><span class="token line">         text-align:center;
</span><span class="token prefix unchanged"> </span><span class="token line">         color:#ffffff;
</span><span class="token prefix unchanged"> </span><span class="token line">         margin-right:0;
</span><span class="token prefix unchanged"> </span><span class="token line">         .icon-cart{
</span><span class="token prefix unchanged"> </span><span class="token line">           @include bgImg(16px,12px,'/imgs/icon-cart-checked.png');
</span><span class="token prefix unchanged"> </span><span class="token line">           margin-right:4px;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .nav-header{
</span><span class="token prefix unchanged"> </span><span class="token line">     .container{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        position:relative;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       height:112px;
</span><span class="token prefix unchanged"> </span><span class="token line">       @include flex();
</span><span class="token prefix unchanged"> </span><span class="token line">       .header-menu{
</span><span class="token prefix unchanged"> </span><span class="token line">         display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">         width:643px;
</span><span class="token prefix unchanged"> </span><span class="token line">         padding-left:209px;
</span><span class="token prefix unchanged"> </span><span class="token line">         .item-menu{
</span><span class="token prefix unchanged"> </span><span class="token line">           display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">           color:#333333;
</span><span class="token prefix unchanged"> </span><span class="token line">           font-weight:bold;
</span><span class="token prefix unchanged"> </span><span class="token line">           font-size:16px;
</span><span class="token prefix unchanged"> </span><span class="token line">           line-height:112px;
</span><span class="token prefix unchanged"> </span><span class="token line">           margin-right:20px;
</span><span class="token prefix unchanged"> </span><span class="token line">           span{
</span><span class="token prefix unchanged"> </span><span class="token line">             cursor:pointer;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           &amp;:hover{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              color:$colorA;
</span><span class="token prefix inserted">+</span><span class="token line">              .children{
</span><span class="token prefix inserted">+</span><span class="token line">                height:220px;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">               opacity:1;
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            .children{
</span><span class="token prefix inserted">+</span><span class="token line">              position:absolute;
</span><span class="token prefix inserted">+</span><span class="token line">              top:112px;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">             left:0;
</span><span class="token prefix unchanged"> </span><span class="token line">             width:1226px;
</span><span class="token prefix unchanged"> </span><span class="token line">             height:0;
</span><span class="token prefix unchanged"> </span><span class="token line">             opacity:0;
</span><span class="token prefix unchanged"> </span><span class="token line">             overflow:hidden;
</span><span class="token prefix unchanged"> </span><span class="token line">             border-top:1px solid #E5E5E5;
</span><span class="token prefix unchanged"> </span><span class="token line">             box-shadow:0px 7px 6px 0px rgba(0, 0, 0, 0.11);
</span><span class="token prefix unchanged"> </span><span class="token line">             z-index: 10;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              transition:all .5s;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">             background-color: #ffffff;
</span><span class="token prefix unchanged"> </span><span class="token line">             .product{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                position:relative;
</span><span class="token prefix inserted">+</span><span class="token line">                float:left;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">               width:16.6%;
</span><span class="token prefix unchanged"> </span><span class="token line">               height:220px;
</span><span class="token prefix unchanged"> </span><span class="token line">               font-size:12px;
</span><span class="token prefix unchanged"> </span><span class="token line">               line-height:12px;
</span><span class="token prefix unchanged"> </span><span class="token line">               text-align: center;
</span><span class="token prefix unchanged"> </span><span class="token line">               a{
</span><span class="token prefix unchanged"> </span><span class="token line">                 display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               img{
</span><span class="token prefix unchanged"> </span><span class="token line">                 width:auto;
</span><span class="token prefix unchanged"> </span><span class="token line">                 height:111px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 margin-top:26px;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               .pro-img{
</span><span class="token prefix unchanged"> </span><span class="token line">                 height:137px;	// 111+26=137
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               .pro-name{
</span><span class="token prefix unchanged"> </span><span class="token line">                 font-weight:bold;
</span><span class="token prefix unchanged"> </span><span class="token line">                 margin-top:19px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 margin-bottom:8px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 color:$colorB;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               .pro-price{
</span><span class="token prefix unchanged"> </span><span class="token line">                 color:$colorA;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                &amp;:before{	// .product::before
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">                 content:' ';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                  position:absolute;
</span><span class="token prefix inserted">+</span><span class="token line">                  top:28px;
</span><span class="token prefix inserted">+</span><span class="token line">                  right:0;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">                 border-left:1px solid $colorF;
</span><span class="token prefix unchanged"> </span><span class="token line">                 height:100px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 width:1px;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                &amp;:last-child:before{
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">                 display:none;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .header-search{
</span><span class="token prefix unchanged"> </span><span class="token line">         width:319px;
</span><span class="token prefix unchanged"> </span><span class="token line">         .wrapper{
</span><span class="token prefix unchanged"> </span><span class="token line">           height:50px;
</span><span class="token prefix unchanged"> </span><span class="token line">           border:1px solid #E0E0E0;
</span><span class="token prefix unchanged"> </span><span class="token line">           display:flex;
</span><span class="token prefix unchanged"> </span><span class="token line">           align-items:center;
</span><span class="token prefix unchanged"> </span><span class="token line">           input{
</span><span class="token prefix unchanged"> </span><span class="token line">             border:none;
</span><span class="token prefix unchanged"> </span><span class="token line">             box-sizing: border-box;
</span><span class="token prefix unchanged"> </span><span class="token line">             border-right:1px solid #E0E0E0;
</span><span class="token prefix unchanged"> </span><span class="token line">             width:264px;
</span><span class="token prefix unchanged"> </span><span class="token line">             height:50px;
</span><span class="token prefix unchanged"> </span><span class="token line">             padding-left:14px;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           a{
</span><span class="token prefix unchanged"> </span><span class="token line">             @include bgImg(18px,18px,'/imgs/icon-search.png');
</span><span class="token prefix unchanged"> </span><span class="token line">             margin-left:17px;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h3 id="_5-3-nav-footer组件"><a href="#_5-3-nav-footer组件" class="header-anchor">#</a> 5.3 Nav-Footer组件</h3> <p><code>src/components/NavFooter.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;footer&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;footer-logo&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;img src=&quot;/imgs/logo-footer.png&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;p&gt;小米商城&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;             
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;footer-link&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;a href=&quot;https://www.imooc.com/u/1343480&quot; target=&quot;_blank&quot;&gt;河畔一角主页&lt;/a&gt;&lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;a href=&quot;https://coding.imooc.com/class/113.html&quot; target=&quot;_blank&quot;&gt;Vue全栈课程&lt;/a&gt;&lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;a href=&quot;https://coding.imooc.com/class/236.html&quot; target=&quot;_blank&quot;&gt;React全家桶课程&lt;/a&gt;&lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;a href=&quot;https://coding.imooc.com/class/343.html&quot; target=&quot;_blank&quot;&gt;微信支付专项课程（H5+小程序+Node+Mongo）&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;copyright&quot;&gt;Copyright ©2019 &lt;span class=&quot;domain&quot;&gt;mi.futurefe.com&lt;/span&gt; All Rights Reserved.&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default{
</span><span class="token prefix unchanged"> </span><span class="token line">   name:'nav-footer'
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot; scoped&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .footer{
</span><span class="token prefix unchanged"> </span><span class="token line">   height:234px;
</span><span class="token prefix unchanged"> </span><span class="token line">   border-top:4px solid #FF6600;
</span><span class="token prefix unchanged"> </span><span class="token line">   background-color:#333333;
</span><span class="token prefix unchanged"> </span><span class="token line">   color:#999999;
</span><span class="token prefix unchanged"> </span><span class="token line">   font-size:16px;
</span><span class="token prefix unchanged"> </span><span class="token line">   text-align:center;
</span><span class="token prefix unchanged"> </span><span class="token line">   .footer-logo{
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-top:46px;
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-bottom:31px;
</span><span class="token prefix unchanged"> </span><span class="token line">     img{
</span><span class="token prefix unchanged"> </span><span class="token line">       width:53px;
</span><span class="token prefix unchanged"> </span><span class="token line">       height:36px;
</span><span class="token prefix unchanged"> </span><span class="token line">       margin-bottom:13px;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .footer-link{
</span><span class="token prefix unchanged"> </span><span class="token line">     a{
</span><span class="token prefix unchanged"> </span><span class="token line">       color:#999999;
</span><span class="token prefix unchanged"> </span><span class="token line">       display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     span{
</span><span class="token prefix unchanged"> </span><span class="token line">       margin:0 10px;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-bottom:13px;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .copyright{
</span><span class="token prefix unchanged"> </span><span class="token line">     .domain{
</span><span class="token prefix unchanged"> </span><span class="token line">       color:#FF6600;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h3 id="_5-4-service-bar组件"><a href="#_5-4-service-bar组件" class="header-anchor">#</a> 5.4 Service-Bar组件</h3> <p><img src="/assets/img/image-20220710151250583.2f153978.png" alt="image-20220710151250583"></p> <p><code>src/components/ServiceBar.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;service&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;li&gt;&lt;span class=&quot;icon-setting&quot;&gt;&lt;/span&gt;预约维修服务&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;li&gt;&lt;span class=&quot;icon-7day&quot;&gt;&lt;/span&gt;7天无理由退货&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;li&gt;&lt;span class=&quot;icon-15day&quot;&gt;&lt;/span&gt;15天免费换货&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;li&gt;&lt;span class=&quot;icon-post&quot;&gt;&lt;/span&gt;满150元包邮&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default{
</span><span class="token prefix unchanged"> </span><span class="token line">   name:'service-bar'
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> @import './../assets/scss/mixin.scss';
</span><span class="token prefix unchanged"> </span><span class="token line"> .service{
</span><span class="token prefix unchanged"> </span><span class="token line">   padding:33px 0;
</span><span class="token prefix unchanged"> </span><span class="token line">   color:#666666;
</span><span class="token prefix unchanged"> </span><span class="token line">   font-size:16px;
</span><span class="token prefix unchanged"> </span><span class="token line">   li{
</span><span class="token prefix unchanged"> </span><span class="token line">     display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">     width:24.9%;
</span><span class="token prefix unchanged"> </span><span class="token line">     text-align:center;
</span><span class="token prefix unchanged"> </span><span class="token line">     border-right:1px solid #E5E5E5;
</span><span class="token prefix unchanged"> </span><span class="token line">     span{
</span><span class="token prefix unchanged"> </span><span class="token line">       display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">       width:20px;
</span><span class="token prefix unchanged"> </span><span class="token line">       height:20px;
</span><span class="token prefix unchanged"> </span><span class="token line">       vertical-align: middle;		// 图片文字居中
</span><span class="token prefix unchanged"> </span><span class="token line">       margin-right:8px;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .icon-setting{
</span><span class="token prefix unchanged"> </span><span class="token line">       @include bgImg(20px,20px,'/imgs/icon-setting.png');
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .icon-7day{
</span><span class="token prefix unchanged"> </span><span class="token line">       @include bgImg(20px,20px,'/imgs/icon-7day.png');
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .icon-15day{
</span><span class="token prefix unchanged"> </span><span class="token line">       @include bgImg(20px,20px,'/imgs/icon-15day.png');
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .icon-post{
</span><span class="token prefix unchanged"> </span><span class="token line">       @include bgImg(20px,20px,'/imgs/icon-post.png');
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p><code>src/pages/index.vue</code>：引入ServiceBar组件。不在home组件中引入，而是在index组件中引入，因为product组件不需要用到ServiceBar组件。</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;template&gt;
  &lt;div&gt;
    &lt;service-bar&gt;&lt;/service-bar&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import ServiceBar from './../components/ServiceBar'
export default {
  name: 'mi-index',
  components: {
    ServiceBar,
  }
}
&lt;/script&gt;

&lt;style&gt;&lt;/style&gt;
</code></pre></div><h3 id="_5-5-首页轮播功能实现"><a href="#_5-5-首页轮播功能实现" class="header-anchor">#</a> 5.5 首页轮播功能实现</h3> <h4 id="_5-5-1-首页轮播功能实现"><a href="#_5-5-1-首页轮播功能实现" class="header-anchor">#</a> 5.5.1 首页轮播功能实现</h4> <blockquote><p>使用swiper组件</p> <p>安装组件：npm install vue-awesome-swiper --save</p> <p>引用组件：import { swiper, swiperSlide } from 'vue-awesome-swiper'</p> <div class="language- extra-class"><pre><code>  		  import 'swiper/dist/css/swiper.css'
</code></pre></div></blockquote> <p><code>src/pages/index.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;swiper-box&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      	&lt;!-- 轮播功能实现 --&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       &lt;swiper v-bind:options=&quot;swiperOption&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;swiper-slide v-for=&quot;item in slideList&quot; :key=&quot;item.id&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a :href=&quot;'/#/product/'+item.id&quot;&gt;&lt;img v-bind:src=&quot;item.img&quot;&gt;&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/swiper-slide&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;!-- Optional controls --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;swiper-pagination&quot;  slot=&quot;pagination&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;swiper-button-prev&quot; slot=&quot;button-prev&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;swiper-button-next&quot; slot=&quot;button-next&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/swiper&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;ads-box&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;banner&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;product-box&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;service-bar&gt;&lt;/service-bar&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import ServiceBar from './../components/ServiceBar'
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  import { swiper, swiperSlide } from 'vue-awesome-swiper'
</span><span class="token prefix inserted">+</span><span class="token line">  import 'swiper/dist/css/swiper.css'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'mi-index',
</span><span class="token prefix unchanged"> </span><span class="token line">   components: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      swiper, 
</span><span class="token prefix inserted">+</span><span class="token line">      swiperSlide,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     ServiceBar,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   data() {
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       swiperOption: {
</span><span class="token prefix unchanged"> </span><span class="token line">         autoplay: true, // 轮播图自动播放
</span><span class="token prefix unchanged"> </span><span class="token line">         loop: true, //循环播放
</span><span class="token prefix unchanged"> </span><span class="token line">         effect: 'cube',  // 切换效果
</span><span class="token prefix unchanged"> </span><span class="token line">         cubeEffect: {
</span><span class="token prefix unchanged"> </span><span class="token line">           shadowOffset: 100,
</span><span class="token prefix unchanged"> </span><span class="token line">           shadowScale: 0.6
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         pagination: { // 分页器
</span><span class="token prefix unchanged"> </span><span class="token line">           el: '.swiper-pagination',
</span><span class="token prefix unchanged"> </span><span class="token line">           clickable: true
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         navigation: { // 箭头按钮生效
</span><span class="token prefix unchanged"> </span><span class="token line">           nextEl: '.swiper-button-next',
</span><span class="token prefix unchanged"> </span><span class="token line">           prevEl: '.swiper-button-prev',
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       slideList: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           id:'42',
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/slider/slide-1.jpg'
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           id:'45',
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/slider/slide-2.jpg'
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           id:'46',
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/slider/slide-3.jpg'
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           id:'',
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/slider/slide-4.jpg'
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           id:'',
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/slider/slide-1.jpg'
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .index {
</span><span class="token prefix unchanged"> </span><span class="token line">   .swiper-box {
</span><span class="token prefix unchanged"> </span><span class="token line">     .swiper-container {
</span><span class="token prefix unchanged"> </span><span class="token line">       height: 451px;
</span><span class="token prefix unchanged"> </span><span class="token line">       img {
</span><span class="token prefix unchanged"> </span><span class="token line">         width: 100%;
</span><span class="token prefix unchanged"> </span><span class="token line">         height: 100%;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h4 id="_5-5-2-首页轮播菜单实现-1"><a href="#_5-5-2-首页轮播菜单实现-1" class="header-anchor">#</a> 5.5.2 首页轮播菜单实现(1)</h4> <p><code>src/pages/index.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;swiper-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 轮播菜单实现 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;nav-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;ul class=&quot;menu-wrap&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;!-- 此处点击链接不需要跳转，可以使用 href=&quot;javascript:;&quot; 防止页面刷新 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;手机 电话卡&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;电视 盒子&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;笔记本 平板&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;家电 插线板&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;出行 穿戴&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;智能 路由器&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;电源 配件&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;生活 箱包&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 轮播功能实现 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;swiper v-bind:options=&quot;swiperOption&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         ...
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/swiper&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;ads-box&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;banner&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;product-box&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;service-bar&gt;&lt;/service-bar&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;...&lt;/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span>@import './../assets/scss/mixin.scss';
@import './../assets/scss/config.scss';
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .index {
</span><span class="token prefix unchanged"> </span><span class="token line">   .swiper-box {
</span><span class="token prefix unchanged"> </span><span class="token line">     .nav-menu {
</span><span class="token prefix unchanged"> </span><span class="token line">       position: absolute;
</span><span class="token prefix unchanged"> </span><span class="token line">       width: 264px;
</span><span class="token prefix unchanged"> </span><span class="token line">       height: 451px;
</span><span class="token prefix unchanged"> </span><span class="token line">       z-index: 9;
</span><span class="token prefix unchanged"> </span><span class="token line">       padding: 26px 0;
</span><span class="token prefix unchanged"> </span><span class="token line">       // 此处通过调整背景颜色来达到透明的效果
</span><span class="token prefix unchanged"> </span><span class="token line">       // 而不是直接使用opacity来设置
</span><span class="token prefix unchanged"> </span><span class="token line">       // 如果使用opacity，那么里面的字体也会变透明
</span><span class="token prefix unchanged"> </span><span class="token line">       background-color: #55585a7a;
</span><span class="token prefix unchanged"> </span><span class="token line">       box-sizing: border-box;
</span><span class="token prefix unchanged"> </span><span class="token line">       .menu-wrap {
</span><span class="token prefix unchanged"> </span><span class="token line">         .menu-item {
</span><span class="token prefix unchanged"> </span><span class="token line">           height: 50px;
</span><span class="token prefix unchanged"> </span><span class="token line">           line-height: 50px;
</span><span class="token prefix unchanged"> </span><span class="token line">           a {
</span><span class="token prefix unchanged"> </span><span class="token line">             position: relative;
</span><span class="token prefix unchanged"> </span><span class="token line">             display: block;
</span><span class="token prefix unchanged"> </span><span class="token line">             font-size: 16px;
</span><span class="token prefix unchanged"> </span><span class="token line">             color: #ffffff;
</span><span class="token prefix unchanged"> </span><span class="token line">             padding-left: 30px;
</span><span class="token prefix unchanged"> </span><span class="token line">             &amp;::after {
</span><span class="token prefix unchanged"> </span><span class="token line">               position: absolute;
</span><span class="token prefix unchanged"> </span><span class="token line">               right: 30px;
</span><span class="token prefix unchanged"> </span><span class="token line">               top: 17.5px;
</span><span class="token prefix unchanged"> </span><span class="token line">               content: ' ';
</span><span class="token prefix unchanged"> </span><span class="token line">               @include bgImg(10px, 15px, '/imgs/icon-arrow.png');
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           &amp;:hover {
</span><span class="token prefix unchanged"> </span><span class="token line">             background-color: $colorA;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .swiper-container {
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">       .swiper-button-prev{
</span><span class="token prefix unchanged"> </span><span class="token line">         left:274px;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h4 id="_5-5-3-首页轮播菜单实现-2"><a href="#_5-5-3-首页轮播菜单实现-2" class="header-anchor">#</a> 5.5.3 首页轮播菜单实现(2)</h4> <p><code>src/pages/index.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;swiper-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 轮播菜单实现 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;nav-menu&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;ul class=&quot;menu-wrap&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;!-- 此处点击链接不需要跳转，可以使用 href=&quot;javascript:;&quot; 防止页面刷新 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;手机 电话卡&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;ul v-for=&quot;(item, index) in menuList&quot; :key=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;li v-for=&quot;sub in item&quot; :key=&quot;sub.id&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;a :href=&quot;sub ? '/#/product/' + sub.id : ''&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;img :src=&quot;sub ? sub.img : '/imgs/item-box-1.png'&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     {{sub ? sub.name : '小米9'}}
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;menu-item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;a href=&quot;javascript:;&quot;&gt;电视 盒子&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;children&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           ...
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 轮播功能实现 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;swiper v-bind:options=&quot;swiperOption&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         ...
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/swiper&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;ads-box&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;banner&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;product-box&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;service-bar&gt;&lt;/service-bar&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import ServiceBar from './../components/ServiceBar'
</span><span class="token prefix unchanged"> </span><span class="token line"> import { swiper, swiperSlide } from 'vue-awesome-swiper'
</span><span class="token prefix unchanged"> </span><span class="token line"> import 'swiper/dist/css/swiper.css'
</span><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'mi-index',
</span><span class="token prefix unchanged"> </span><span class="token line">   components: {
</span><span class="token prefix unchanged"> </span><span class="token line">     swiper, 
</span><span class="token prefix unchanged"> </span><span class="token line">     swiperSlide,
</span><span class="token prefix unchanged"> </span><span class="token line">     ServiceBar,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   data() {
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       swiperOption: {...},
</span><span class="token prefix unchanged"> </span><span class="token line">       slideList: [...],
</span><span class="token prefix unchanged"> </span><span class="token line">       menuList:[
</span><span class="token prefix unchanged"> </span><span class="token line">         [
</span><span class="token prefix unchanged"> </span><span class="token line">           {
</span><span class="token prefix unchanged"> </span><span class="token line">             id:30,
</span><span class="token prefix unchanged"> </span><span class="token line">             img:'/imgs/item-box-1.png',
</span><span class="token prefix unchanged"> </span><span class="token line">             name:'小米CC9',
</span><span class="token prefix unchanged"> </span><span class="token line">           },{
</span><span class="token prefix unchanged"> </span><span class="token line">             id:31,
</span><span class="token prefix unchanged"> </span><span class="token line">             img:'/imgs/item-box-2.png',
</span><span class="token prefix unchanged"> </span><span class="token line">             name:'小米8青春版',
</span><span class="token prefix unchanged"> </span><span class="token line">           },{
</span><span class="token prefix unchanged"> </span><span class="token line">             id:32,
</span><span class="token prefix unchanged"> </span><span class="token line">             img:'/imgs/item-box-3.jpg',
</span><span class="token prefix unchanged"> </span><span class="token line">             name:'Redmi K20 Pro',
</span><span class="token prefix unchanged"> </span><span class="token line">           },{
</span><span class="token prefix unchanged"> </span><span class="token line">             id:33,
</span><span class="token prefix unchanged"> </span><span class="token line">             img:'/imgs/item-box-4.jpg',
</span><span class="token prefix unchanged"> </span><span class="token line">             name:'移动4G专区',
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         ],
</span><span class="token prefix unchanged"> </span><span class="token line">         [0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]
</span><span class="token prefix unchanged"> </span><span class="token line">       ],        
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span>@import './../assets/scss/mixin.scss';
@import './../assets/scss/config.scss';
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .index {
</span><span class="token prefix unchanged"> </span><span class="token line">   .swiper-box {
</span><span class="token prefix unchanged"> </span><span class="token line">     .nav-menu {
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">       .menu-wrap {
</span><span class="token prefix unchanged"> </span><span class="token line">         .menu-item {
</span><span class="token prefix unchanged"> </span><span class="token line">           ...
</span><span class="token prefix unchanged"> </span><span class="token line">           a {...}
</span><span class="token prefix unchanged"> </span><span class="token line">           &amp;:hover {
</span><span class="token prefix unchanged"> </span><span class="token line">             background-color: $colorA;
</span><span class="token prefix unchanged"> </span><span class="token line">             .children {
</span><span class="token prefix unchanged"> </span><span class="token line">               display: block;
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           .children {
</span><span class="token prefix unchanged"> </span><span class="token line">             display: none;
</span><span class="token prefix unchanged"> </span><span class="token line">             width: 962px;
</span><span class="token prefix unchanged"> </span><span class="token line">             height: 450px;
</span><span class="token prefix unchanged"> </span><span class="token line">             background-color: $colorG;
</span><span class="token prefix unchanged"> </span><span class="token line">             position: absolute;
</span><span class="token prefix unchanged"> </span><span class="token line">             top: 0;
</span><span class="token prefix unchanged"> </span><span class="token line">             left: 264px;
</span><span class="token prefix unchanged"> </span><span class="token line">             border: 1px solid $colorH;
</span><span class="token prefix unchanged"> </span><span class="token line">             ul {
</span><span class="token prefix unchanged"> </span><span class="token line">               // 以下两行代码实现两边对齐
</span><span class="token prefix unchanged"> </span><span class="token line">               display: flex;
</span><span class="token prefix unchanged"> </span><span class="token line">               justify-content: space-between;
</span><span class="token prefix unchanged"> </span><span class="token line">               height: 75px;  // 451/6
</span><span class="token prefix unchanged"> </span><span class="token line">               li {
</span><span class="token prefix unchanged"> </span><span class="token line">                 height: 75px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 line-height: 75px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 // width: 241px;   // 962/4
</span><span class="token prefix unchanged"> </span><span class="token line">                 flex: 1; // 相当于设置宽度,表示均分
</span><span class="token prefix unchanged"> </span><span class="token line">                 padding-left: 23px;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               a {
</span><span class="token prefix unchanged"> </span><span class="token line">                 color: $colorB;
</span><span class="token prefix unchanged"> </span><span class="token line">                 font-size: 14px;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               img {
</span><span class="token prefix unchanged"> </span><span class="token line">                 width: 42px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 height: 35px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 // 文字和图片居中
</span><span class="token prefix unchanged"> </span><span class="token line">                 vertical-align: middle;
</span><span class="token prefix unchanged"> </span><span class="token line">                 margin-right: 15px;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .swiper-container {...}
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h3 id="_5-6-首页广告位实现"><a href="#_5-6-首页广告位实现" class="header-anchor">#</a> 5.6 首页广告位实现</h3> <p><code>src/pages/index.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;swiper-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;ads-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a :href=&quot;'/#/product/' + item.id&quot; v-for=&quot;(item, index) in adsList&quot; :key=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;img :src=&quot;item.img&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;banner&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;/#/product/30&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;img src=&quot;/imgs/banner-1.png&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;product-box&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;service-bar&gt;&lt;/service-bar&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'mi-index',
</span><span class="token prefix unchanged"> </span><span class="token line">   components: {...},
</span><span class="token prefix unchanged"> </span><span class="token line">   data() {
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       swiperOption: {...},
</span><span class="token prefix unchanged"> </span><span class="token line">       slideList: [...],
</span><span class="token prefix unchanged"> </span><span class="token line">       menuList:[...],        
</span><span class="token prefix unchanged"> </span><span class="token line">       adsList:[
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           id:33,
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/ads/ads-1.png'
</span><span class="token prefix unchanged"> </span><span class="token line">         },{
</span><span class="token prefix unchanged"> </span><span class="token line">           id:48,
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/ads/ads-2.jpg'
</span><span class="token prefix unchanged"> </span><span class="token line">         },{
</span><span class="token prefix unchanged"> </span><span class="token line">           id:45,
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/ads/ads-3.png'
</span><span class="token prefix unchanged"> </span><span class="token line">         },{
</span><span class="token prefix unchanged"> </span><span class="token line">           id:47,
</span><span class="token prefix unchanged"> </span><span class="token line">           img:'/imgs/ads/ads-4.jpg'
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       ],        
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span>@import './../assets/scss/mixin.scss';
@import './../assets/scss/config.scss';
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .index {
</span><span class="token prefix unchanged"> </span><span class="token line">   .swiper-box {...}
</span><span class="token prefix unchanged"> </span><span class="token line">   .ads-box {
</span><span class="token prefix unchanged"> </span><span class="token line">     @include flex();
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-top:14px;
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-bottom:31px;
</span><span class="token prefix unchanged"> </span><span class="token line">     a{
</span><span class="token prefix unchanged"> </span><span class="token line">       width:296px;
</span><span class="token prefix unchanged"> </span><span class="token line">       height:167px;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .banner {
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-bottom: 50px;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h3 id="_5-7-手机商品实现"><a href="#_5-7-手机商品实现" class="header-anchor">#</a> 5.7 手机商品实现</h3> <p><code>src/pages/index.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;swiper-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;ads-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;banner&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;product-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;h2&gt;手机&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;wrapper&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;banner-left&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;/#/product/35&quot;&gt;&lt;img src=&quot;/imgs/mix-alpha.jpg&quot; alt=&quot;&quot;&gt;&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;list-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;list&quot; v-for=&quot;(arr, i) in phoneList&quot; :key=&quot;i&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item&quot; v-for=&quot;(item, j) in arr&quot; :key=&quot;j&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              	&lt;!-- 意思是j%2==0时，即：后面的语句为true时（偶数的时候）添加新品类 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">                &lt;span v-bind:class=&quot;{'new-pro':j%2==0}&quot;&gt;新品&lt;/span&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;item-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;img :src=&quot;item.mainImage&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;item-info&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;h3&gt;{{item.name}}&lt;/h3&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;p&gt;{{item.subtitle}}&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;p class=&quot;price&quot;&gt;{{item.price}}元&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;service-bar&gt;&lt;/service-bar&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   data() {
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       swiperOption: {...},
</span><span class="token prefix unchanged"> </span><span class="token line">       slideList: [...],
</span><span class="token prefix unchanged"> </span><span class="token line">       menuList:[...],        
</span><span class="token prefix unchanged"> </span><span class="token line">       adsList:[...],  
</span><span class="token prefix unchanged"> </span><span class="token line">       phoneList: []      
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   mounted() {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.init();
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">     init() {
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/products', {
</span><span class="token prefix unchanged"> </span><span class="token line">         params: {
</span><span class="token prefix unchanged"> </span><span class="token line">           categoryId: 100012,
</span><span class="token prefix unchanged"> </span><span class="token line">           pageSize: 8
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">         this.phoneList = [res.list.slice(0,4), res.list.slice(4,8)]
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span>	...
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .index {
</span><span class="token prefix unchanged"> </span><span class="token line">   .swiper-box {...}
</span><span class="token prefix unchanged"> </span><span class="token line">   .ads-box {...}
</span><span class="token prefix unchanged"> </span><span class="token line">   .banner {...}
</span><span class="token prefix unchanged"> </span><span class="token line">   .product-box {
</span><span class="token prefix unchanged"> </span><span class="token line">     background-color: $colorJ;
</span><span class="token prefix unchanged"> </span><span class="token line">     padding: 30px 0 50px;
</span><span class="token prefix unchanged"> </span><span class="token line">     h2 {
</span><span class="token prefix unchanged"> </span><span class="token line">       font-size:$fontF;
</span><span class="token prefix unchanged"> </span><span class="token line">       height:21px;
</span><span class="token prefix unchanged"> </span><span class="token line">       line-height:21px;
</span><span class="token prefix unchanged"> </span><span class="token line">       color:$colorB;
</span><span class="token prefix unchanged"> </span><span class="token line">       margin-bottom:20px;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .wrapper {
</span><span class="token prefix unchanged"> </span><span class="token line">       display:flex;
</span><span class="token prefix unchanged"> </span><span class="token line">       .banner-left {
</span><span class="token prefix unchanged"> </span><span class="token line">         margin-right:16px;
</span><span class="token prefix unchanged"> </span><span class="token line">         img {
</span><span class="token prefix unchanged"> </span><span class="token line">           width:224px;
</span><span class="token prefix unchanged"> </span><span class="token line">           height:619px;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .list-box {
</span><span class="token prefix unchanged"> </span><span class="token line">         .list {
</span><span class="token prefix unchanged"> </span><span class="token line">           @include flex();
</span><span class="token prefix unchanged"> </span><span class="token line">           width:986px;
</span><span class="token prefix unchanged"> </span><span class="token line">           margin-bottom:14px;
</span><span class="token prefix unchanged"> </span><span class="token line">           &amp;:last-child{
</span><span class="token prefix unchanged"> </span><span class="token line">             margin-bottom:0;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           .item {
</span><span class="token prefix unchanged"> </span><span class="token line">             width:236px;
</span><span class="token prefix unchanged"> </span><span class="token line">             height:302px;
</span><span class="token prefix unchanged"> </span><span class="token line">             background-color:$colorG;
</span><span class="token prefix unchanged"> </span><span class="token line">             text-align:center;
</span><span class="token prefix unchanged"> </span><span class="token line">             span {
</span><span class="token prefix unchanged"> </span><span class="token line">               display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">               width:67px;
</span><span class="token prefix unchanged"> </span><span class="token line">               height:24px;
</span><span class="token prefix unchanged"> </span><span class="token line">               font-size:14px;
</span><span class="token prefix unchanged"> </span><span class="token line">               line-height:24px;
</span><span class="token prefix unchanged"> </span><span class="token line">               color:$colorG;
</span><span class="token prefix unchanged"> </span><span class="token line">               // 新品
</span><span class="token prefix unchanged"> </span><span class="token line">               &amp;.new-pro {
</span><span class="token prefix unchanged"> </span><span class="token line">                 background-color: #7ECF68;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               // 秒杀
</span><span class="token prefix unchanged"> </span><span class="token line">               &amp;.kill-pro{
</span><span class="token prefix unchanged"> </span><span class="token line">                 background-color:#E82626;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">             .item-img {
</span><span class="token prefix unchanged"> </span><span class="token line">               img {
</span><span class="token prefix unchanged"> </span><span class="token line">                 width: 100%;
</span><span class="token prefix unchanged"> </span><span class="token line">                 height: 195px;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">             .item-info {
</span><span class="token prefix unchanged"> </span><span class="token line">               h3 {
</span><span class="token prefix unchanged"> </span><span class="token line">                 font-size:$fontJ;
</span><span class="token prefix unchanged"> </span><span class="token line">                 color:$colorB;
</span><span class="token prefix unchanged"> </span><span class="token line">                 line-height:$fontJ;
</span><span class="token prefix unchanged"> </span><span class="token line">                 font-weight:bold;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               p {
</span><span class="token prefix unchanged"> </span><span class="token line">                 color:$colorD;
</span><span class="token prefix unchanged"> </span><span class="token line">                 line-height:13px;
</span><span class="token prefix unchanged"> </span><span class="token line">                 margin:6px auto 13px;
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">               .price {
</span><span class="token prefix unchanged"> </span><span class="token line">                 color:#F20A0A;
</span><span class="token prefix unchanged"> </span><span class="token line">                 font-size:$fontJ;
</span><span class="token prefix unchanged"> </span><span class="token line">                 font-weight:bold;
</span><span class="token prefix unchanged"> </span><span class="token line">                 cursor:pointer;
</span><span class="token prefix unchanged"> </span><span class="token line">                 // 用伪类的方式添加购物车
</span><span class="token prefix unchanged"> </span><span class="token line">                 &amp;::after {
</span><span class="token prefix unchanged"> </span><span class="token line">                   @include bgImg(22px,22px,'/imgs/icon-cart-hover.png');
</span><span class="token prefix unchanged"> </span><span class="token line">                   content:' ';
</span><span class="token prefix unchanged"> </span><span class="token line">                   margin-left:5px;
</span><span class="token prefix unchanged"> </span><span class="token line">                   vertical-align: middle;
</span><span class="token prefix unchanged"> </span><span class="token line">                 }
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h3 id="_5-8-modal-模态框-弹框-组件"><a href="#_5-8-modal-模态框-弹框-组件" class="header-anchor">#</a> 5.8 Modal(模态框,弹框)组件</h3> <p>当点击购物车时，会提交数据。如果用户没有登录，那么会被接口拦截，拦截后自动跳转到登录页面；如果已经登录了，那么会弹框提示“加入购物车成功”。该模态框是通用的模态框，适用于各种场景。</p> <h4 id="_5-8-1-modal组件实现"><a href="#_5-8-1-modal组件实现" class="header-anchor">#</a> 5.8.1 Modal组件实现</h4> <p>新建<code>src/components/Modal.vue</code>及<code>src/assets/scss/modal.scss</code>（由于Modal是通用性的组件，所以样式也单独为一个文件，这样在各个页面都可以引入。）</p> <p><code>src/assets/scss/mixin.scss</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>//flex布局复用
@mixin flex($hov:space-between, $col:center) {...}

//背景图片复用
// contain表示填充填满
@mixin bgImg($w:0, $h:0, $img:'', $size:contain) {...}

// 定位
@mixin position($pos:absolute, $top:0, $left:0, $w:100%, $h:100%) {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   position: $pos;
</span><span class="token prefix unchanged"> </span><span class="token line">   top: $top;
</span><span class="token prefix unchanged"> </span><span class="token line">   left: $left;
</span><span class="token prefix unchanged"> </span><span class="token line">   width: $w;
</span><span class="token prefix unchanged"> </span><span class="token line">   height: $h;
</span></span>}

// 背景图片的定位
@mixin positionImg($pos:absolute, $top:0, $right:0, $w:0, $h:0, $img:'') {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   position: $pos;
</span><span class="token prefix unchanged"> </span><span class="token line">   top: $top;
</span><span class="token prefix unchanged"> </span><span class="token line">   right: $right;
</span><span class="token prefix unchanged"> </span><span class="token line">   width: $w;
</span><span class="token prefix unchanged"> </span><span class="token line">   height: $h;
</span><span class="token prefix unchanged"> </span><span class="token line">   background: url($img) no-repeat center;
</span><span class="token prefix unchanged"> </span><span class="token line">   background-size: contain;
</span></span>}
</code></pre></div><p><code>src/assets/scss/button.scss</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// 通用的按钮
.btn {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   display: inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">   width: 110px;
</span><span class="token prefix unchanged"> </span><span class="token line">   line-height: 30px;
</span><span class="token prefix unchanged"> </span><span class="token line">   text-align: center;
</span><span class="token prefix unchanged"> </span><span class="token line">   background-color: $colorA;
</span><span class="token prefix unchanged"> </span><span class="token line">   color: $colorG;
</span><span class="token prefix unchanged"> </span><span class="token line">   border: none;
</span><span class="token prefix unchanged"> </span><span class="token line">   cursor: pointer;
</span></span>}

.btn-default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   background-color: #b0b0b0;
</span><span class="token prefix unchanged"> </span><span class="token line">   color: $colorG;
</span></span>}

// 大号按钮
.btn-large {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   width: 202px;
</span><span class="token prefix unchanged"> </span><span class="token line">   height: 50px;
</span><span class="token prefix unchanged"> </span><span class="token line">   line-height: 50px;
</span><span class="token prefix unchanged"> </span><span class="token line">   font-size: 18px;
</span></span>}

// 巨大号按钮
.btn-huge {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   width: 300px;
</span><span class="token prefix unchanged"> </span><span class="token line">   height: 54px;
</span><span class="token prefix unchanged"> </span><span class="token line">   line-height: 54px;
</span><span class="token prefix unchanged"> </span><span class="token line">   font-size: 16px;
</span></span>}

.btn-group {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   .btn {
</span><span class="token prefix unchanged"> </span><span class="token line">       margin-right: 20px;
</span><span class="token prefix unchanged"> </span><span class="token line">       &amp;:last-child {
</span><span class="token prefix unchanged"> </span><span class="token line">           margin-right: 0;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><p><code>src/assets/scss/modal.scss</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>.modal {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // 固定定位 fixed 
</span><span class="token prefix unchanged"> </span><span class="token line">   @include position(fixed);
</span><span class="token prefix unchanged"> </span><span class="token line">   z-index: 10;
</span><span class="token prefix unchanged"> </span><span class="token line">   .mask {
</span><span class="token prefix unchanged"> </span><span class="token line">       @include position(fixed);
</span><span class="token prefix unchanged"> </span><span class="token line">       background-color: $colorI;
</span><span class="token prefix unchanged"> </span><span class="token line">       opacity: 0.5;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .modal-dialog {
</span><span class="token prefix unchanged"> </span><span class="token line">       @include position(absolute, 40%, 50%, 660px, auto);
</span><span class="token prefix unchanged"> </span><span class="token line">       background-color: $colorG;
</span><span class="token prefix unchanged"> </span><span class="token line">       // 位移,相对于元素自身来说的,
</span><span class="token prefix unchanged"> </span><span class="token line">       // 即向上移动元素高度的一半,向左移动元素宽度的一半
</span><span class="token prefix unchanged"> </span><span class="token line">       transform: translate(-50%, -50%);
</span><span class="token prefix unchanged"> </span><span class="token line">       .modal-header {
</span><span class="token prefix unchanged"> </span><span class="token line">           height: 60px;
</span><span class="token prefix unchanged"> </span><span class="token line">           background-color: $colorJ;
</span><span class="token prefix unchanged"> </span><span class="token line">           padding: 0 25px;
</span><span class="token prefix unchanged"> </span><span class="token line">           line-height: 60px;
</span><span class="token prefix unchanged"> </span><span class="token line">           font-size: $fontI;
</span><span class="token prefix unchanged"> </span><span class="token line">           .icon-close {
</span><span class="token prefix unchanged"> </span><span class="token line">               @include positionImg(absolute, 23px, 25px, 14px, 14px, '/imgs/icon-close.png');
</span><span class="token prefix unchanged"> </span><span class="token line">               // 给transform属性做一个过度
</span><span class="token prefix unchanged"> </span><span class="token line">               transition: transform .3s;
</span><span class="token prefix unchanged"> </span><span class="token line">               &amp;:hover {
</span><span class="token prefix unchanged"> </span><span class="token line">                   // 鼠标经过时,放大1.5倍
</span><span class="token prefix unchanged"> </span><span class="token line">                   transform: scale(1.5);
</span><span class="token prefix unchanged"> </span><span class="token line">               }
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .modal-body {
</span><span class="token prefix unchanged"> </span><span class="token line">           padding: 42px 40px 54px;
</span><span class="token prefix unchanged"> </span><span class="token line">           font-size: 14px;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .modal-footer {
</span><span class="token prefix unchanged"> </span><span class="token line">           height: 82px;
</span><span class="token prefix unchanged"> </span><span class="token line">           line-height: 82px;
</span><span class="token prefix unchanged"> </span><span class="token line">           text-align: center;
</span><span class="token prefix unchanged"> </span><span class="token line">           background-color: $colorJ;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><p><code>src/App.vue</code>：引入config.scss和button.scss（button.scss要用到config.scss，所以放在config.scss之后）</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;...&lt;/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;...&lt;/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span>@import './assets/scss/reset.scss';
@import './assets/scss/config.scss';
@import './assets/scss/button.scss';
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p><code>src/components/Modal.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- 为了做动画,需要在组件中控制,通过下一语句中的 v-show=&quot;showModal&quot; 来控制动画 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- v-show=&quot;showModal&quot;为什么不在 index.vue 中? --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- 因为在Modal.vue中要用transition,transition最好与控制动画放在一起,如果 v-show=&quot;showModal&quot; 放外面,动画可能会失效--&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;modal&quot; v-show=&quot;showModal&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;mask&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;modal-dialog&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;modal-header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span&gt;标题&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;a href=&quot;javascript:;&quot; class=&quot;icon-close&quot;&gt;&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;modal-body&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;!-- 用slot插槽的方式实现动态的，里面的东西不固定 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;slot name=&quot;body&quot;&gt;&lt;/slot&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;modal-footer&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;btn-group&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;a href=&quot;javascript:;&quot; class=&quot;btn&quot;&gt;确定&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-default&quot;&gt;取消&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   export default {
</span><span class="token prefix unchanged"> </span><span class="token line">       name: 'modal',
</span><span class="token prefix unchanged"> </span><span class="token line">       // props（变量），需要把能够抽取的参数的抽取出来
</span><span class="token prefix unchanged"> </span><span class="token line">       props: {
</span><span class="token prefix unchanged"> </span><span class="token line">           // 弹框类型：小small，中middle，大large，表单form
</span><span class="token prefix unchanged"> </span><span class="token line">           modalType: {
</span><span class="token prefix unchanged"> </span><span class="token line">               type: String,
</span><span class="token prefix unchanged"> </span><span class="token line">               default: 'form'
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">           // 弹框标题
</span><span class="token prefix unchanged"> </span><span class="token line">           title: String,
</span><span class="token prefix unchanged"> </span><span class="token line">           // 按钮类型: 1:确定按钮 2：取消按钮 3：确定取消
</span><span class="token prefix unchanged"> </span><span class="token line">           btnType:String,
</span><span class="token prefix unchanged"> </span><span class="token line">           // 需要动态设定按钮文本
</span><span class="token prefix unchanged"> </span><span class="token line">           sureText:{
</span><span class="token prefix unchanged"> </span><span class="token line">               type:String,
</span><span class="token prefix unchanged"> </span><span class="token line">               default:'确定'
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">           cancelText:{
</span><span class="token prefix unchanged"> </span><span class="token line">               type:String,
</span><span class="token prefix unchanged"> </span><span class="token line">               default:'取消'
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">           // showModal表示弹框是否展示出来（因为需要做动画）
</span><span class="token prefix unchanged"> </span><span class="token line">           showModal:Boolean
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span>@import './../assets/scss/config.scss';
// 注意引入mixin.scss和modal.scss的顺序不能颠倒
@import './../assets/scss/mixin.scss';
@import './../assets/scss/modal.scss';
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p><code>src/pages/index.vue</code>：引用Modal.vue</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;service-bar&gt;&lt;/service-bar&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;modal 
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     title=&quot;提示&quot; 
</span><span class="token prefix unchanged"> </span><span class="token line">     sureText=&quot;查看购物车&quot; 
</span><span class="token prefix unchanged"> </span><span class="token line">     btnType=&quot;1&quot; 
</span><span class="token prefix unchanged"> </span><span class="token line">     modalType=&quot;middle&quot; v-bind:showModal=&quot;true&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;template v-slot:body&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;p&gt;商品添加成功!&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/template&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;/modal&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  import Modal from './../components/Modal.vue'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'mi-index',
</span><span class="token prefix unchanged"> </span><span class="token line">   components: {
</span><span class="token prefix unchanged"> </span><span class="token line">     ...,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      Modal
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><h4 id="_5-8-2-modal动画实现与modal交互"><a href="#_5-8-2-modal动画实现与modal交互" class="header-anchor">#</a> 5.8.2 Modal动画实现与Modal交互</h4> <p>需要注意的是，使用动画的部分必须要用标签进行包裹，在定义动画的时候，在以下类名中定义：</p> <p><code>v-enter</code>：定义进入过渡的开始状态。在元素被插入之前生效，在元素被插入之后的下一帧移除。</p> <p><code>v-enter-active</code>：定义进入过渡生效时的状态。在整个进入过渡的阶段中应用，在元素被插入之前生效，在过渡/动画完成之后移除。这个类可以被用来定义进入过渡的过程时间，延迟和曲线函数。</p> <p><code>v-enter-to</code>：2.1.8 版及以上定义进入过渡的结束状态。在元素被插入之后下一帧生效 (与此同时 v-enter 被移除)，在过渡/动画完成之后移除。</p> <p><code>v-leave</code>：定义离开过渡的开始状态。在离开过渡被触发时立刻生效，下一帧被移除。</p> <p><code>v-leave-active</code>：定义离开过渡生效时的状态。在整个离开过渡的阶段中应用，在离开过渡被触发时立刻生效，在过渡/动画完成之后移除。这个类可以被用来定义离开过渡的过程时间，延迟和曲线函数。</p> <p><code>v-leave-to</code>：2.1.8 版及以上定义离开过渡的结束状态。在离开过渡被触发之后下一帧生效 (与此同时 v-leave 被删除)，在过渡/动画完成之后移除。</p> <blockquote><p>对于这些在过渡中切换的类名来说，如果使用一个没有名字的 ，则 v- 是这些类名的默认前缀。因为这里定义name为slide，所以以slide-开头。</p></blockquote> <p><code>src/asset/scss/Modal.scss</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>.modal {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   // 为了给 top 做过渡,可将all换成top
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    transition: all .5s;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   .mask {...}
</span><span class="token prefix unchanged"> </span><span class="token line">   
</span><span class="token prefix unchanged"> </span><span class="token line">   // 要注意这三个过渡的顺序，要不然功能效果实现不全。
</span><span class="token prefix unchanged"> </span><span class="token line">   &amp;.slide-enter-active {
</span><span class="token prefix unchanged"> </span><span class="token line">       top: 0;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   // 刚离开的时候是 top:-100%,slide-leave-to就是恢复到原样,原样的top值就是0,所以不用设置
</span><span class="token prefix unchanged"> </span><span class="token line">   &amp;.slide-leave-active {
</span><span class="token prefix unchanged"> </span><span class="token line">       top: -100%;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   // slide-enter需要放在slide-enter-active的后面
</span><span class="token prefix unchanged"> </span><span class="token line">   &amp;.slide-enter {
</span><span class="token prefix unchanged"> </span><span class="token line">       top: -100%;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   
</span><span class="token prefix unchanged"> </span><span class="token line">   .modal-dialog {...}
</span></span>}
</code></pre></div><blockquote><p>Modal为子组件,index为父组件. 以下需要注意两者之间相互传参数.</p></blockquote> <p><code>src/components/Modal.vue</code>：使用动画的部分必须要用标签进行包裹；子组件</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;transition name=&quot;slide&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 为了做动画,需要在组件中控制,通过下一语句中的 v-show=&quot;showModal&quot; 来控制动画 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- v-show=&quot;showModal&quot;为什么不在 index.vue 中? --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- 因为在Modal.vue中要用transition,transition最好与控制动画放在一起,如果 v-show=&quot;showModal&quot; 放外面,动画可能会失效--&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;modal&quot; v-show=&quot;showModal&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;mask&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;modal-dialog&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;modal-header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;span&gt;{{title}}&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;a href=&quot;javascript:;&quot; class=&quot;icon-close&quot; v-on:click=&quot;$emit('cancel')&quot;&gt;&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;modal-body&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;!-- 用slot插槽的方式实现动态的，里面的东西不固定 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;slot name=&quot;body&quot;&gt;&lt;/slot&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;!-- 用$emit自定义submit,cancel函数，用父传来的btntype的值判断显示什么按钮，并子传父，自定义函数 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;modal-footer&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;!-- 子组件向父组件传递参数:子组件通过$emit触发自定义事件,父组件调用自定义事件 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;!-- 1.只有确定按钮 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;a href=&quot;javascript:;&quot; class=&quot;btn&quot; v-if=&quot;btnType==1&quot; v-on:click=&quot;$emit('submit')&quot;&gt;{{sureText}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;!-- 2.只有取消按钮 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;a href=&quot;javascript:;&quot; class=&quot;btn&quot; v-if=&quot;btnType==2&quot; v-on:click=&quot;$emit('cancel')&quot;&gt;{{cancelText}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;!-- 3.确定,取消按钮都有 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;btn-group&quot; v-if=&quot;btnType==3&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                       &lt;a href=&quot;javascript:;&quot; class=&quot;btn&quot; v-on:click=&quot;$emit('submit')&quot;&gt;{{sureText}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                       &lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-default&quot; v-on:click=&quot;$emit('cancel')&quot;&gt;{{cancelText}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;/transition&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;...&lt;/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;...&lt;/style&gt;
</span></span></code></pre></div><p><code>src/pages/index.vue</code>：父组件</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;swiper-box&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;ads-box&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;banner&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;product-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;h2&gt;手机&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;wrapper&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;banner-left&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;list-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;list&quot; v-for=&quot;(arr, i) in phoneList&quot; :key=&quot;i&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item&quot; v-for=&quot;(item, j) in arr&quot; :key=&quot;j&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span v-bind:class=&quot;{'new-pro':j%2==0}&quot;&gt;新品&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;item-img&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;item-info&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                  &lt;p class=&quot;price&quot; @click=&quot;addCart(item.id)&quot;&gt;{{item.price}}元&lt;/p&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;service-bar&gt;&lt;/service-bar&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- 父组件向子组件传递参数,子组件中通过 props属性接收参数 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- 子向父传递参数:给modal组件绑定自定义事件(submit,cancel事件的回调在父组件) --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- 给谁绑定自定义事件，就找谁触发该事件。 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- goToCart:当点击确定按钮时,跳转到购物车页面 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- cancel:当点击取消按钮时,不展示Modal组件 --&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;modal 
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     title=&quot;提示&quot; 
</span><span class="token prefix unchanged"> </span><span class="token line">     sureText=&quot;查看购物车&quot; 
</span><span class="token prefix unchanged"> </span><span class="token line">     btnType=&quot;1&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     modalType=&quot;middle&quot; 
</span><span class="token prefix unchanged"> </span><span class="token line">     v-bind:showModal=&quot;showModal&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     v-on:submit=&quot;goToCart&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     v-on:cancel=&quot;showModal=false&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     &gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;template v-slot:body&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;p&gt;商品添加成功!&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/template&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;/modal&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   data() {
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       ...,
</span><span class="token prefix unchanged"> </span><span class="token line">       // 控制Modal组件的展示和隐藏,一开始默认不展示Modal组件
</span><span class="token prefix unchanged"> </span><span class="token line">       // 当点击加入购物车时,showModal = true,展示Modal组件
</span><span class="token prefix unchanged"> </span><span class="token line">       showModal: false      
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">     ...,
</span><span class="token prefix unchanged"> </span><span class="token line">     addCart() {
</span><span class="token prefix unchanged"> </span><span class="token line">       this.showModal = true // 先把弹框展示出来
</span><span class="token prefix unchanged"> </span><span class="token line">       // 由于登录功能还没有实现,所以先暂时注释掉下面的代码(会有登录拦截)
</span><span class="token prefix unchanged"> </span><span class="token line">       /* this.axios.post('/carts', {
</span><span class="token prefix unchanged"> </span><span class="token line">         productId: id,
</span><span class="token prefix unchanged"> </span><span class="token line">         selected: true
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then(() =&gt; {
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       }).catch(() =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">         this.showModal = true
</span><span class="token prefix unchanged"> </span><span class="token line">       }) */
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     goToCart() {
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push('/cart');
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;...&lt;/style&gt;
</span></span></code></pre></div><h3 id="_5-9-图片懒加载"><a href="#_5-9-图片懒加载" class="header-anchor">#</a> 5.9 图片懒加载</h3> <p><code>vue-lazyload</code>插件</p> <p>下载插件: <code>npm i vue-lazyload -S</code></p> <p>在<code>src/main.js</code>中加载插件:1引用2应用</p> <div class="language-diff extra-class"><pre class="language-diff"><code>...
import VueAxios from 'vue-axios'
// 图片懒加载
import VueLazyLoad from 'vue-lazyload'
...
Vue.use(VueAxios, axios)
Vue.use(VueLazyLoad, {
	// 图片加载效果
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   loading: '/imgs/loading-svg/loading-bars.svg'
</span></span>})
...
</code></pre></div><blockquote><p>svg 图片放大不会失真</p></blockquote> <p>使用<code>vue-lazyload</code>：将<code>:src</code>换成<code>v-lazy</code>即可</p> <div class="language-diff extra-class"><pre class="language-diff"><code>// 原来
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">img :src=&quot;'/imgs/banner-1.png'&quot; alt=&quot;&quot;&gt;
</span></span>// 懒加载形式,注意需要用单引号引起字符串
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">img v-lazy=&quot;'/imgs/banner-1.png'&quot; alt=&quot;&quot;&gt;
</span></span></code></pre></div><h2 id="_6-登录页面"><a href="#_6-登录页面" class="header-anchor">#</a> 6 登录页面</h2> <blockquote><p>登录页面交互和接口完整代码实现</p> <p>登录页面的用户名和密码都是jack</p> <p>默认注册的用户名和密码都是admin1</p></blockquote> <h3 id="_6-1-登录交互实现"><a href="#_6-1-登录交互实现" class="header-anchor">#</a> 6.1 登录交互实现</h3> <p><code>vue-cookie</code>插件</p> <p>在<code>src/main.js</code>中加载插件:1引用2应用</p> <div class="language-diff extra-class"><pre class="language-diff"><code>...
import VueLazyLoad from 'vue-lazyload'
// cookie
import VueCookie from 'vue-cookie'
...
Vue.use(VueAxios, axios)
Vue.use(VueCookie)
...
</code></pre></div><p><code>src/pages/login.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;login&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;a href=&quot;/#/index&quot;&gt;&lt;img src=&quot;/imgs/login-logo.png&quot; alt=&quot;&quot;&gt;&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;wrapper&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;login-form&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;h3&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span class=&quot;checked&quot;&gt;帐号登录&lt;/span&gt; 
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span class=&quot;sep-line&quot;&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span&gt;扫码登录&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/h3&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;input&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;input type=&quot;text&quot; placeholder=&quot;请输入帐号&quot; v-model=&quot;username&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;input&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;input type=&quot;password&quot; placeholder=&quot;请输入密码&quot; v-model=&quot;password&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;btn-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;javascript:;&quot; class=&quot;btn&quot; @click=&quot;login&quot;&gt;登录&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;tips&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;sms&quot; @click=&quot;register&quot;&gt;手机短信登录/注册&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;reg&quot;&gt;立即注册&lt;span&gt;|&lt;/span&gt;忘记密码？&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;footer&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-login',
</span><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     username:'',
</span><span class="token prefix unchanged"> </span><span class="token line">     password:'',
</span><span class="token prefix unchanged"> </span><span class="token line">     // 为什么需要保存用户ID,
</span><span class="token prefix unchanged"> </span><span class="token line">     // 因为前端和后端是分离的,后端不认识前端是谁,
</span><span class="token prefix unchanged"> </span><span class="token line">     // 前后端通信的时候需要传递一个凭证告诉后端,一般来说是cookie,
</span><span class="token prefix unchanged"> </span><span class="token line">     // 这里把用户ID当作cookie,每一次发请求的时候把cookie(用户ID)发送给服务端,
</span><span class="token prefix unchanged"> </span><span class="token line">     // 这样服务端才知道当前用户的身份,根据用户ID进行操作
</span><span class="token prefix unchanged"> </span><span class="token line">     userId:'' 
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 登录模块
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // 下面是登录逻辑的实现，当用户点击登录按钮后，会触发登录所对应的事件函数。
</span><span class="token prefix unchanged"> </span><span class="token line">   // 在函数里，要将用户的账号和密码通过axios发送给后端，然后将用户id保存在cookie中，并且跳转到首页，还要对用户名进行vuex管理，因为首页要显示用户名。
</span><span class="token prefix unchanged"> </span><span class="token line">   // 登录初始为 jack,密码也为jack
</span><span class="token prefix unchanged"> </span><span class="token line">   login(){
</span><span class="token prefix unchanged"> </span><span class="token line">     // 拿到用户输入的账号密码，因为数据是双向绑定的
</span><span class="token prefix unchanged"> </span><span class="token line">     let { username,password } = this;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/user/login',{
</span><span class="token prefix unchanged"> </span><span class="token line">       // 这里是简写，key和value一样
</span><span class="token prefix unchanged"> </span><span class="token line">       username,
</span><span class="token prefix unchanged"> </span><span class="token line">       password
</span><span class="token prefix unchanged"> </span><span class="token line">     }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       // 将用户ID保存到cookie中(需要安装vue-cookie插件)
</span><span class="token prefix unchanged"> </span><span class="token line">       // expires设置过期时间
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$cookie.set('userId',res.id,{expires:'Session'});
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        // vuex: 保存用户名
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       // 因为登录成功以后要在首页显示用户名，所以使用vuex进行管理
</span><span class="token prefix unchanged"> </span><span class="token line">       // to-do
</span><span class="token prefix unchanged"> </span><span class="token line">       
</span><span class="token prefix unchanged"> </span><span class="token line">       // 登录成功，跳转到首页
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push({
</span><span class="token prefix unchanged"> </span><span class="token line">         name:'index',
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span><span class="token prefix unchanged"> </span><span class="token line">           from:'login'
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       });
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   // 注册模块
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    register(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/user/register',{
</span><span class="token prefix unchanged"> </span><span class="token line">       username:'admin1',
</span><span class="token prefix unchanged"> </span><span class="token line">       password:'admin1',
</span><span class="token prefix unchanged"> </span><span class="token line">       email:'admin1@163.com'
</span><span class="token prefix unchanged"> </span><span class="token line">     }).then(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       alert('注册成功');
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span>.login{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &amp;&gt;.container{
</span><span class="token prefix unchanged"> </span><span class="token line">   height:113px;
</span><span class="token prefix unchanged"> </span><span class="token line">   img{
</span><span class="token prefix unchanged"> </span><span class="token line">     width:auto;
</span><span class="token prefix unchanged"> </span><span class="token line">     height:100%;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span><span class="token prefix unchanged"> </span><span class="token line"> .wrapper{
</span><span class="token prefix unchanged"> </span><span class="token line">   background:url('/imgs/login-bg.jpg') no-repeat center;
</span><span class="token prefix unchanged"> </span><span class="token line">   .container{
</span><span class="token prefix unchanged"> </span><span class="token line">     height:576px;
</span><span class="token prefix unchanged"> </span><span class="token line">     .login-form{
</span><span class="token prefix unchanged"> </span><span class="token line">       box-sizing: border-box;
</span><span class="token prefix unchanged"> </span><span class="token line">       padding-left: 31px;
</span><span class="token prefix unchanged"> </span><span class="token line">       padding-right: 31px;
</span><span class="token prefix unchanged"> </span><span class="token line">       width:410px;
</span><span class="token prefix unchanged"> </span><span class="token line">       height:510px;
</span><span class="token prefix unchanged"> </span><span class="token line">       background-color:#ffffff;
</span><span class="token prefix unchanged"> </span><span class="token line">       position:absolute;
</span><span class="token prefix unchanged"> </span><span class="token line">       bottom:29px;
</span><span class="token prefix unchanged"> </span><span class="token line">       right:0;
</span><span class="token prefix unchanged"> </span><span class="token line">       h3{
</span><span class="token prefix unchanged"> </span><span class="token line">         line-height:23px;
</span><span class="token prefix unchanged"> </span><span class="token line">         font-size:24px;
</span><span class="token prefix unchanged"> </span><span class="token line">         text-align:center;
</span><span class="token prefix unchanged"> </span><span class="token line">         margin:40px auto 49px;
</span><span class="token prefix unchanged"> </span><span class="token line">         .checked{
</span><span class="token prefix unchanged"> </span><span class="token line">           color:#FF6600;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">         .sep-line{
</span><span class="token prefix unchanged"> </span><span class="token line">           margin:0 32px;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .input{
</span><span class="token prefix unchanged"> </span><span class="token line">         display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">         width:348px;
</span><span class="token prefix unchanged"> </span><span class="token line">         height:50px;
</span><span class="token prefix unchanged"> </span><span class="token line">         border:1px solid #E5E5E5;
</span><span class="token prefix unchanged"> </span><span class="token line">         margin-bottom:20px;
</span><span class="token prefix unchanged"> </span><span class="token line">         input{
</span><span class="token prefix unchanged"> </span><span class="token line">           width: 100%;
</span><span class="token prefix unchanged"> </span><span class="token line">           height: 100%;
</span><span class="token prefix unchanged"> </span><span class="token line">           border: none;
</span><span class="token prefix unchanged"> </span><span class="token line">           padding: 18px;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .btn{
</span><span class="token prefix unchanged"> </span><span class="token line">         width:100%;
</span><span class="token prefix unchanged"> </span><span class="token line">         line-height:50px;
</span><span class="token prefix unchanged"> </span><span class="token line">         margin-top:10px;
</span><span class="token prefix unchanged"> </span><span class="token line">         font-size:16px;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       .tips{
</span><span class="token prefix unchanged"> </span><span class="token line">         margin-top:14px;
</span><span class="token prefix unchanged"> </span><span class="token line">         display:flex;
</span><span class="token prefix unchanged"> </span><span class="token line">         justify-content:space-between;
</span><span class="token prefix unchanged"> </span><span class="token line">         font-size:14px;
</span><span class="token prefix unchanged"> </span><span class="token line">         cursor:pointer;
</span><span class="token prefix unchanged"> </span><span class="token line">         .sms{
</span><span class="token prefix unchanged"> </span><span class="token line">           color:#FF6600;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">         .reg{
</span><span class="token prefix unchanged"> </span><span class="token line">           color:#999999;
</span><span class="token prefix unchanged"> </span><span class="token line">           span{
</span><span class="token prefix unchanged"> </span><span class="token line">             margin:0 7px;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span><span class="token prefix unchanged"> </span><span class="token line"> .footer{
</span><span class="token prefix unchanged"> </span><span class="token line">   height:100px;
</span><span class="token prefix unchanged"> </span><span class="token line">   padding-top:60px;
</span><span class="token prefix unchanged"> </span><span class="token line">   color:#999999;
</span><span class="token prefix unchanged"> </span><span class="token line">   font-size:16px;
</span><span class="token prefix unchanged"> </span><span class="token line">   text-align:center;
</span><span class="token prefix unchanged"> </span><span class="token line">   .footer-link{
</span><span class="token prefix unchanged"> </span><span class="token line">     a{
</span><span class="token prefix unchanged"> </span><span class="token line">       color:#999999;
</span><span class="token prefix unchanged"> </span><span class="token line">       display:inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     span{
</span><span class="token prefix unchanged"> </span><span class="token line">       margin:0 10px;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .copyright{
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-top:13px;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><blockquote><p>单页面应用程序:用户登录成功以后,网站中的数据中的数据是存在内存中的,网页刷新后就丢失.</p></blockquote> <h3 id="_6-2-拉取用户信息"><a href="#_6-2-拉取用户信息" class="header-anchor">#</a> 6.2 拉取用户信息</h3> <blockquote><p>获取'用户信息','购物车的数量'的接口不建议放在NavHeader中,放在App.vue中</p></blockquote> <p><code>src/App.vue</code>:数据的拉取: 获取'用户信息','购物车的数量'</p> <div class="language-diff extra-class"><pre class="language-diff"><code>...
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'App',
</span><span class="token prefix unchanged"> </span><span class="token line"> data() {
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     res: {}
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted() {
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getUser()
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getCartCount()
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取用户信息
</span><span class="token prefix unchanged"> </span><span class="token line">   getUser() {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('/user').then(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       // to-do 保存到vuex中
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   getCartCount() {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('carts/products/sum').then(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       // to-do 保存到vuex中
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>...
</code></pre></div><p><code>src/mian.js</code>: 修改&quot;接口错误拦截&quot;, 目的是实现不论用户是否登录,都可以访问首页<code>index.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>...
// 接口错误拦截
axios.interceptors.response.use(function(response) {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   let res = response.data //res中的status 是与后台协商的字段，这是定义的
</span><span class="token prefix unchanged"> </span><span class="token line">   let path = location.hash
</span><span class="token prefix unchanged"> </span><span class="token line">   if (res.status == 0) { // status为0表示成功
</span><span class="token prefix unchanged"> </span><span class="token line">       return res.data
</span><span class="token prefix unchanged"> </span><span class="token line">   } else if (res.status == 10) { // status为10表示未登录的报错
</span><span class="token prefix unchanged"> </span><span class="token line">       if (path != '#/index') {
</span><span class="token prefix unchanged"> </span><span class="token line">           window.location.href = '/#/login' // 跳转到登录页面，不能用$router.push()这些路由API，因为这是挂载在Vue实例上的，而此时并没有Vue实例
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">   } else {
</span><span class="token prefix unchanged"> </span><span class="token line">       alert(res.msg)
</span><span class="token prefix unchanged"> </span><span class="token line">       return Promise.reject(res) // 用Promise.reject()抛出异常
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>})
...
</code></pre></div><h2 id="_7-vuex集成"><a href="#_7-vuex集成" class="header-anchor">#</a> 7 Vuex集成</h2> <p>Vuex插件的入门和实战应用。</p> <h3 id="_7-1-初步了解vuex"><a href="#_7-1-初步了解vuex" class="header-anchor">#</a> 7.1 初步了解Vuex</h3> <p>vue中的双向绑定只是停留在表单层面, 组件之间是单向流通的, 但是组件间存在数据共享.</p> <p>vuex是为vue.js 开发的状态管理模式，在兄弟组件，甚至没有关系的组件之间来做数据存储和共享，把数据存储到vuex里，在各个组件都可以共用.</p> <p><img src="/assets/img/504.6007da7c.6007da7c.png" alt="504"></p> <p>**流程：**组件里面的一个按钮点击事件，通过dispatch派发一个Actions，Actions会提交一个commit到Mutations，Mutations会自动提交状态到State里面去，从而State会重新渲染Vue Components(视图)</p> <p>注意所有的异步操作只能在Actions上进行，不能在Mutations上.</p> <p>**注意：**当状态改变之后呢，与组件之间有延迟，这时要用Computed计算属性，当数据延迟，获取状态没有用的，因为获取到状态时，页面已经渲染完了，这时再获取状态就有点晚了。</p> <h3 id="_7-2-vuex框架搭建"><a href="#_7-2-vuex框架搭建" class="header-anchor">#</a> 7.2 Vuex框架搭建</h3> <p><strong>官方目录结构:</strong></p> <p><img src="/assets/img/image-20220715190810007.6822ec8c.png" alt="image-20220715190810007"></p> <ol><li>创建store文件夹</li> <li>分别建立index.js(用于管理入口，也包括状态的入口)，action.js ，mutations.js</li></ol> <p><code>src/store/index.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>import Vue from &quot;vue&quot;
import Vuex from &quot;vuex&quot;
// 导入mutations.js和action.js
import mutations from &quot;./mutations&quot;
import actions from &quot;./actions&quot;
// vuex挂在到vue实例上，于是import引入vue，和vuex，并且用use连接。
Vue.use(Vuex)

// state 初始化并管理状态
const state = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   username: &quot;&quot;, //登录用户
</span><span class="token prefix unchanged"> </span><span class="token line">   cartCount: 0 //购物车商品数量
</span></span>}

// 用export default 引用vue.store对象，写法是固定的
export default new Vuex.Store({
	// 在这个对象中，引入state，actions，mutations
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   state,
</span><span class="token prefix unchanged"> </span><span class="token line">   mutations,
</span><span class="token prefix unchanged"> </span><span class="token line">   actions
</span></span>})
</code></pre></div><p><code>src/store/mutations.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>/**
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">* 商城Vuex-mutations
</span><span class="token prefix unchanged"> </span><span class="token line">*/
</span></span>export default {

}
</code></pre></div><p><code>src/store/action.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>/**
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">* 商城Vuex-actions
</span><span class="token prefix unchanged"> </span><span class="token line">*/
</span></span>export default {

}
</code></pre></div><blockquote><p>这个 mutations.js中的export default {} 相当于 index.js的 vue.store中的mutations后面添加：{}, 跟在index.js中直接写mutations：{}效果是一样的，action.js同理。</p></blockquote> <ol start="3"><li>在<code>src/main.js</code>中引入 store文件夹中的index.js入口文件</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>...
// 导入store
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import store from './store' //默认引入store文件夹里面的index.js文件
</span></span>...
new Vue({
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   router,
</span><span class="token prefix unchanged"> </span><span class="token line">   render: h =&gt; h(App),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    store
</span></span>}).$mount('#app')
</code></pre></div><ol start="4"><li>利用vue-devtools工具，看封装是否成功</li></ol> <p><img src="/assets/img/image-20220715193304030.62392b82.png" alt="image-20220715193304030"></p> <h3 id="_7-3-vuex实战应用"><a href="#_7-3-vuex实战应用" class="header-anchor">#</a> 7.3 Vuex实战应用</h3> <ol><li>在登录页面进行数据存储，保存用户名，并通过dispatch传给action.js，进行数据传输</li></ol> <p><code>src/pages/login.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>...
methods: {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   login(){
</span><span class="token prefix unchanged"> </span><span class="token line">     // 拿到用户输入的账号密码，因为数据是双向绑定的
</span><span class="token prefix unchanged"> </span><span class="token line">     let { username,password } = this;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/user/login',{
</span><span class="token prefix unchanged"> </span><span class="token line">       // 这里是简写，key和value一样
</span><span class="token prefix unchanged"> </span><span class="token line">       username,
</span><span class="token prefix unchanged"> </span><span class="token line">       password
</span><span class="token prefix unchanged"> </span><span class="token line">     }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       // 将用户ID保存到cookie中(需要安装vue-cookie插件)
</span><span class="token prefix unchanged"> </span><span class="token line">       // expires设置过期时间
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$cookie.set('userId',res.id,{expires:'Session'});
</span><span class="token prefix unchanged"> </span><span class="token line">       alert(res.id)
</span><span class="token prefix unchanged"> </span><span class="token line">       // vuex: 保存用户名
</span><span class="token prefix unchanged"> </span><span class="token line">       // 因为登录成功以后要在首页显示用户名，所以使用vuex进行管理
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$store.dispatch('saveUserName', res.username)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       
</span><span class="token prefix unchanged"> </span><span class="token line">       // 登录成功，跳转到首页
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push({
</span><span class="token prefix unchanged"> </span><span class="token line">         name:'index',
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span><span class="token prefix unchanged"> </span><span class="token line">           from:'login'
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       });
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span>...
</code></pre></div><ol start="2"><li>action.js接收到数据后，会提交一个commit到mutations</li></ol> <p><code>src/store/action.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>/**
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">* 商城Vuex-actions
</span><span class="token prefix unchanged"> </span><span class="token line">*/
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   saveUserName(context, username) {
</span><span class="token prefix unchanged"> </span><span class="token line">       context.commit('saveUserName', username);
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><ol start="3"><li>mutations.js接收到数据后，自动提交到state里面去，刷新状态</li></ol> <p><code>src/store/mutations.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>/**
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">* 商城Vuex-mutations
</span><span class="token prefix unchanged"> </span><span class="token line">*/
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   saveUserName(state, username) {
</span><span class="token prefix unchanged"> </span><span class="token line">       state.username = username;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><ol start="4"><li>在NavHeader.vue中，读取数据</li></ol> <p><code>src/components/NavHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;topbar-user&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; v-if=&quot;username&quot;&gt;{{username}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; v-if=&quot;!username&quot; @click=&quot;login&quot;&gt;登录&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; v-if=&quot;username&quot;&gt;我的订单&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; class=&quot;my-cart&quot; @click=&quot;goToCart&quot;&gt;&lt;span class=&quot;icon-cart&quot;&gt;&lt;/span&gt;购物车&lt;/a&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>data() {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">   	username: this.$store.state.username,
</span><span class="token prefix unchanged"> </span><span class="token line">   	phoneList:[]
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>},
</code></pre></div><p>成功登陆之后</p> <p><img src="data:image/png;base64,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" alt="image-20220715213309248"></p> <p>但此时刷新之后，数据会丢失，这如何解决？</p> <p>这需要重新获取user接口的数据，进行存储。所以在<code>src/App.vue</code>中，</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取用户信息
</span><span class="token prefix unchanged"> </span><span class="token line">   getUser() {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('/user').then((res)=&gt;{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$store.dispatch('saveUserName',res.username)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span></span></code></pre></div><p>此时，刷新之后数据没有丢失，但是会闪一下才出现。这是因为先加载app.vue，再加载NavHeader.vue组件，
Navheader中的以下形式的数据渲染是不太需要时间</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> data() {
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     username: this.$store.state.username,
</span><span class="token prefix unchanged"> </span><span class="token line">     phoneList:[]
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span></code></pre></div><p>而app组件中下面的调用接口是需要时间的</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // 获取用户信息
</span><span class="token prefix unchanged"> </span><span class="token line">   getUser() {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('/user').then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$store.dispatch('saveUserName',res.username)
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span></code></pre></div><p>所以存在延迟，此时利用一下计算属性，computed，重新计算username。这样就能解决问题。</p> <p><code>src/components/NavHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">data() {
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     // username: this.$store.state.username,
</span><span class="token prefix unchanged"> </span><span class="token line">     phoneList:[]
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> computed: {
</span><span class="token prefix unchanged"> </span><span class="token line">   username() {
</span><span class="token prefix unchanged"> </span><span class="token line">     return this.$store.state.username
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span></code></pre></div><ol start="5"><li><p>cartCount同理</p></li> <li><p>利用mapState 和mapActions 辅助函数</p></li></ol> <p><code>src/pages/login.vue</code>: mapActions</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import { mapActions } from 'vuex';
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...,
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   // 登录模块
</span><span class="token prefix unchanged"> </span><span class="token line">   login(){
</span><span class="token prefix unchanged"> </span><span class="token line">     let { username, password } = this;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/user/login', {
</span><span class="token prefix unchanged"> </span><span class="token line">       username,
</span><span class="token prefix unchanged"> </span><span class="token line">       password
</span><span class="token prefix unchanged"> </span><span class="token line">     }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$cookie.set('userId',res.id,{expires:'Session'});
</span><span class="token prefix unchanged"> </span><span class="token line">       // vuex: 保存用户名
</span><span class="token prefix unchanged"> </span><span class="token line">       // 因为登录成功以后要在首页显示用户名，所以使用vuex进行管理
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        // this.$store.dispatch('saveUserName', res.username)
</span><span class="token prefix inserted">+</span><span class="token line">        this.saveUserName(res.username)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       
</span><span class="token prefix unchanged"> </span><span class="token line">       // 登录成功，跳转到首页
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    ...mapActions(['saveUserName']),  // 将'saveUserName'解构为一个方法
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // 注册模块
</span></span>	...
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><p><code>src/components/NavHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import { mapState } from 'vuex'
</span></span>export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'nav-header',
</span><span class="token prefix unchanged"> </span><span class="token line"> data() {
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     phoneList:[]
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> computed: {
</span><span class="token prefix unchanged"> </span><span class="token line">   /* username() {
</span><span class="token prefix unchanged"> </span><span class="token line">        return this.$store.state.username
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      cartCount() {
</span><span class="token prefix unchanged"> </span><span class="token line">        return this.$store.state.cartCount
</span><span class="token prefix unchanged"> </span><span class="token line">      } */
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    ...mapState(['username', 'cartCount'])
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> ...
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><h2 id="_8-产品站页面"><a href="#_8-产品站页面" class="header-anchor">#</a> 8 产品站页面</h2> <p>介绍产品站页面吸顶组件、参数组件、视频模块以及Slide动画等实现。</p> <h3 id="_8-1-参数组件的实现"><a href="#_8-1-参数组件的实现" class="header-anchor">#</a> 8.1 参数组件的实现</h3> <p><img src="/assets/img/image-20220717092550825.c334ee02.png" alt="image-20220717092550825"></p> <p><code>src/components/ProductParam.vue</code>：参数组件</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;nav-bar&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;pro-title&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       小米8
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;pro-param&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;javascript:;&quot;&gt;概述&lt;/a&gt;&lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;javascript:;&quot;&gt;参数&lt;/a&gt;&lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;javascript:;&quot;&gt;用户评价&lt;/a&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;!-- 立即购买按钮，以slot插槽的形式插入的。因为有的产品栈页面这个按钮不是立即购买功能，可能是添加购物车功能，用插槽更利于我们灵活的控制。（之前model组件也是插槽的形式，也是为了以后能方便根据功能更改内容，更加便利） --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;slot name=&quot;buy&quot;&gt;&lt;/slot&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'nav-bar',
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> @import './../assets/scss/config.scss';
</span><span class="token prefix unchanged"> </span><span class="token line"> @import './../assets/scss/mixin.scss';
</span><span class="token prefix unchanged"> </span><span class="token line"> .nav-bar {
</span><span class="token prefix unchanged"> </span><span class="token line">   height: 70px;
</span><span class="token prefix unchanged"> </span><span class="token line">   line-height: 70px;
</span><span class="token prefix unchanged"> </span><span class="token line">   border: 1px solid $colorH;
</span><span class="token prefix unchanged"> </span><span class="token line">   .container {
</span><span class="token prefix unchanged"> </span><span class="token line">     @include flex();
</span><span class="token prefix unchanged"> </span><span class="token line">     .pro-title{
</span><span class="token prefix unchanged"> </span><span class="token line">       font-size:$fontH;
</span><span class="token prefix unchanged"> </span><span class="token line">       color:$colorB;
</span><span class="token prefix unchanged"> </span><span class="token line">       font-weight:bold;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .pro-param{
</span><span class="token prefix unchanged"> </span><span class="token line">       font-size:$fontJ;
</span><span class="token prefix unchanged"> </span><span class="token line">       span {
</span><span class="token prefix unchanged"> </span><span class="token line">         margin:0 10px;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       a {
</span><span class="token prefix unchanged"> </span><span class="token line">         color:$colorC;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p><code>src/pages/product.vue</code>：引入ProductParam组件。备注：该组件属于home路由的子路由。</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;product&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;product-param&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;template v-slot:buy&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;button class=&quot;btn&quot;&gt;立即购买&lt;/button&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;/template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;/product-param&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>import ProductParam from '@/components/ProductParam.vue'
export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-product',
</span><span class="token prefix unchanged"> </span><span class="token line"> components: {
</span><span class="token prefix unchanged"> </span><span class="token line">   ProductParam
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .product {
</span><span class="token prefix unchanged"> </span><span class="token line">   button {
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-left: 10px;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><h3 id="_8-2-参数组件的吸顶实现"><a href="#_8-2-参数组件的吸顶实现" class="header-anchor">#</a> 8.2 参数组件的吸顶实现</h3> <ol><li>先用假数据撑开内容部分，以产生滚动条</li></ol> <p><code>src/pages/product.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;product&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;product-param&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;template v-slot:buy&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;button class=&quot;btn&quot;&gt;立即购买&lt;/button&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/template&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/product-param&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;h&quot;&gt;717&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;h&quot;&gt;717&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;h&quot;&gt;717&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;h&quot;&gt;717&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;h&quot;&gt;717&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;h&quot;&gt;717&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;...&lt;/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .product {
</span><span class="token prefix unchanged"> </span><span class="token line">   button {
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-left: 10px;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .h {
</span><span class="token prefix unchanged"> </span><span class="token line">     height: 160px;
</span><span class="token prefix unchanged"> </span><span class="token line">     background-color: pink;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><ol start="2"><li>给window绑定scroll滚动事件，给nav-bar绑定类class，给is-fixed添加样式</li></ol> <p><code>src/components/ProductParam.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  &lt;div class=&quot;nav-bar&quot; :class=&quot;{'is-fixed': isFixed}&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;pro-title&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       小米8
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;pro-param&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;javascript:;&quot;&gt;概述&lt;/a&gt;&lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;javascript:;&quot;&gt;参数&lt;/a&gt;&lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;javascript:;&quot;&gt;用户评价&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;slot name=&quot;buy&quot;&gt;&lt;/slot&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'nav-bar',
</span><span class="token prefix unchanged"> </span><span class="token line">   data() {
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        isFixed: false,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   mounted() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      window.addEventListener('scroll', this.initHeight);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   methods: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      initHeight() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       // 解决兼容问题: 谷歌浏览器用document.documentElement.scrollTop，ie浏览器用document.body.scrollTop
</span><span class="token prefix unchanged"> </span><span class="token line">       let scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
</span><span class="token prefix unchanged"> </span><span class="token line">       this.isFixed = scrollTop &gt; 152 ? true : false;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   destroyed() {
</span><span class="token prefix unchanged"> </span><span class="token line">     // false为冒泡，true为捕获
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      window.removeEventListener('scroll', this.initHeight, false)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> @import './../assets/scss/config.scss';
</span><span class="token prefix unchanged"> </span><span class="token line"> @import './../assets/scss/mixin.scss';
</span><span class="token prefix unchanged"> </span><span class="token line"> .nav-bar {
</span><span class="token prefix unchanged"> </span><span class="token line">   height: 70px;
</span><span class="token prefix unchanged"> </span><span class="token line">   line-height: 70px;
</span><span class="token prefix unchanged"> </span><span class="token line">   border: 1px solid $colorH;
</span><span class="token prefix unchanged"> </span><span class="token line">   background-color: $colorG;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &amp;.is-fixed {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     position: fixed;
</span><span class="token prefix unchanged"> </span><span class="token line">     top: 0;
</span><span class="token prefix unchanged"> </span><span class="token line">     width: 100%;
</span><span class="token prefix unchanged"> </span><span class="token line">     box-shadow: 0 5px 5px $colorE;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .container {
</span><span class="token prefix unchanged"> </span><span class="token line">     @include flex();
</span><span class="token prefix unchanged"> </span><span class="token line">     .pro-title{
</span><span class="token prefix unchanged"> </span><span class="token line">       font-size:$fontH;
</span><span class="token prefix unchanged"> </span><span class="token line">       color:$colorB;
</span><span class="token prefix unchanged"> </span><span class="token line">       font-weight:bold;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     .pro-param{
</span><span class="token prefix unchanged"> </span><span class="token line">       font-size:$fontJ;
</span><span class="token prefix unchanged"> </span><span class="token line">       span {
</span><span class="token prefix unchanged"> </span><span class="token line">         margin:0 10px;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       a {
</span><span class="token prefix unchanged"> </span><span class="token line">         color:$colorC;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p><strong>注意：</strong></p> <p>(1) 为什么给window.addEventListener的第二个参数设置成this.initHeight而不是function(){}，是因为设置成this.initHeight当组件销毁时，destroyed可以进行移除。</p> <p>(2) 组件销毁，并不是把组件永远的销毁掉，而是”切换成另一个页面“，比如从产品站页面切换到主页面，就可以理解成把产品站的组件销毁，此时把产品站销毁了，但是里面的window的scroll事件还是存在，无论是在主页面还是其他页面滚动页面都会触发scroll事件，是没必要的占内存，此时需要进行destroy摧毁，同时还要注意removeEventListener第三个参数默认是false冒泡，这样在产品站销毁时，window的scroll事件也会被一起移除。</p> <p>(3) box-shadow的参数: 第一个是x轴阴影，第二个是y轴阴影，第三个是阴影大小，第四个是阴影颜色</p> <p>(4) 关于is-fixed设置样式时出现的问题</p> <ul><li><p><u>要在.nav-bar里面&amp;.is-fixed 而不要单独.is-fixed ?</u></p></li> <li><p>用于给nav-bar设置了fixed定位，其宽度就跟内容区的宽度一样，必须用width:100%给它撑开</p></li> <li><p>为了避免兼容问题不选择sticky进行定位</p></li></ul> <h3 id="_8-3-视频模块实现"><a href="#_8-3-视频模块实现" class="header-anchor">#</a> 8.3 视频模块实现</h3> <ol><li>首先设置视频的样式</li></ol> <p>首先一个大盒子，里面有一个遮罩层盒子(overlay盒子)，进行淡黑色的遮罩，遮罩层里面有一个video盒子，装video标签和关闭的span标签</p> <p>给遮罩层fixde布局，透明度设置0.4 ，z-index：10
再给video盒子fixed布局，并设置水平垂直居中，z-index:10
video标签 高度 宽度 100%，设置object-fit:cover; outline:none;
span给absoluted绝对定位 定位在盒子的右上角，z-index:11</p> <p><code>src/pages/product.vue</code></p> <div class="language- extra-class"><pre class="language-text"><code>      &lt;div class=&quot;item-video&quot;&gt;
        &lt;h2&gt;60帧超慢动作摄影&lt;br/&gt;慢慢回味每一瞬间的精彩&lt;/h2&gt;
        &lt;p&gt;后置960帧电影般超慢动作视频，将眨眼间的美妙展现得淋漓尽致！&lt;br/&gt;更能AI 精准分析视频内容，15个场景智能匹配背景音效。&lt;/p&gt;
        &lt;div class=&quot;video-bg&quot;&gt;&lt;/div&gt;
        &lt;div class=&quot;video-box&quot;&gt;
          &lt;!-- overlay遮罩 --&gt;
          &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;
          &lt;div class=&quot;video&quot;&gt;
          	&lt;span class=&quot;icon-close&quot;&gt;&lt;/span&gt;
          	&lt;!-- muted使得音频静音输出 --&gt;
          	&lt;video src=&quot;/imgs/product/video.mp4&quot; muted autoplay controls=&quot;controls&quot;&gt;&lt;/video&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
</code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>	.video-box{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         // 遮罩层
</span><span class="token prefix unchanged"> </span><span class="token line">         .overlay{ 
</span><span class="token prefix unchanged"> </span><span class="token line">           @include position(fixed);
</span><span class="token prefix unchanged"> </span><span class="token line">           background-color:#333333;
</span><span class="token prefix unchanged"> </span><span class="token line">           opacity:.4;
</span><span class="token prefix unchanged"> </span><span class="token line">           z-index:10;
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">         .video{
</span><span class="token prefix unchanged"> </span><span class="token line">           // fixed相对于浏览器窗口定位
</span><span class="token prefix unchanged"> </span><span class="token line">           // absolute相对于整个HTML文档进行定位
</span><span class="token prefix unchanged"> </span><span class="token line">           position:fixed;
</span><span class="token prefix unchanged"> </span><span class="token line">           top:50%;
</span><span class="token prefix unchanged"> </span><span class="token line">           left:50%;
</span><span class="token prefix unchanged"> </span><span class="token line">           transform:translate(-50%,-50%);
</span><span class="token prefix unchanged"> </span><span class="token line">           z-index:10;
</span><span class="token prefix unchanged"> </span><span class="token line">           width:1000px;
</span><span class="token prefix unchanged"> </span><span class="token line">           height:536px;
</span><span class="token prefix unchanged"> </span><span class="token line">           opacity:1;
</span><span class="token prefix unchanged"> </span><span class="token line">           .icon-close{
</span><span class="token prefix unchanged"> </span><span class="token line">             // 相对于.video定位
</span><span class="token prefix unchanged"> </span><span class="token line">             position:absolute;
</span><span class="token prefix unchanged"> </span><span class="token line">             top:20px;
</span><span class="token prefix unchanged"> </span><span class="token line">             right:20px;
</span><span class="token prefix unchanged"> </span><span class="token line">             @include bgImg(20px,20px,'/imgs/icon-close.png');
</span><span class="token prefix unchanged"> </span><span class="token line">             cursor:pointer;
</span><span class="token prefix unchanged"> </span><span class="token line">             z-index:11;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">           video{
</span><span class="token prefix unchanged"> </span><span class="token line">             width:100%;
</span><span class="token prefix unchanged"> </span><span class="token line">             height:100%;
</span><span class="token prefix unchanged"> </span><span class="token line">             object-fit:cover;
</span><span class="token prefix unchanged"> </span><span class="token line">             outline:none;
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span></span></code></pre></div><h3 id="_8-4-slide动画实现"><a href="#_8-4-slide动画实现" class="header-anchor">#</a> 8.4 Slide动画实现</h3> <p>**效果：**当点击视频的背景图片时，有一个下拉的效果(即video出现)；当点击关闭按钮时，有一个上拉的效果(即video隐藏)。</p> <ol><li>用transition过渡设置该效果（transition一般用于单个属性，单一的过度效果）</li></ol> <p><code>src/pages/product.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// style
.video{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // fixed相对于浏览器窗口定位
</span><span class="token prefix unchanged"> </span><span class="token line">   // absolute相对于整个HTML文档进行定位
</span><span class="token prefix unchanged"> </span><span class="token line">   position:fixed;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    top:-50%;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   left:50%;
</span><span class="token prefix unchanged"> </span><span class="token line">   transform:translate(-50%,-50%);
</span><span class="token prefix unchanged"> </span><span class="token line">   z-index:10;
</span><span class="token prefix unchanged"> </span><span class="token line">   width:1000px;
</span><span class="token prefix unchanged"> </span><span class="token line">   height:536px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    opacity:0;
</span><span class="token prefix inserted">+</span><span class="token line">    transition: all .6s;
</span><span class="token prefix inserted">+</span><span class="token line">    &amp;.slide {
</span><span class="token prefix inserted">+</span><span class="token line">        top:50%;
</span><span class="token prefix inserted">+</span><span class="token line">        opacity: 1;
</span><span class="token prefix inserted">+</span><span class="token line">    }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span></span>}
</code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// script
data() {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    	showSlide: false,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   	...
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;item-video&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;video-bg&quot; @click=&quot;showSlide=true&quot;&gt;&lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;video-box&quot; v-show=&quot;showSlide&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">          &lt;div class=&quot;overlay&quot; v-if=&quot;showSlide&quot;&gt;&lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">          &lt;div class=&quot;video&quot; v-bind:class=&quot;{'slide':showSlide}&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">            &lt;span class=&quot;icon-close&quot; @click=&quot;showSlide=false&quot;&gt;&lt;/span&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;!-- muted使得音频静音输出 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;video src=&quot;/imgs/product/video.mp4&quot; muted autoplay controls=&quot;controls&quot;&gt;&lt;/video&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span></span></code></pre></div><ol start="2"><li>用animation设置该效果（animation主要用于更加复杂的动画效果）</li></ol> <p><code>src/pages/product.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// style
.video-box{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // 遮罩层
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 定义动画(一般都是成对出现的)
</span><span class="token prefix inserted">+</span><span class="token line">    @keyframes slideDown{
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       from{
</span><span class="token prefix unchanged"> </span><span class="token line">           top:-50%;
</span><span class="token prefix unchanged"> </span><span class="token line">           opacity: 0;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       to{
</span><span class="token prefix unchanged"> </span><span class="token line">           top:50%;
</span><span class="token prefix unchanged"> </span><span class="token line">           opacity: 1;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    @keyframes slideUp{
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       from{
</span><span class="token prefix unchanged"> </span><span class="token line">           top:50%;
</span><span class="token prefix unchanged"> </span><span class="token line">           opacity: 1;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       to{
</span><span class="token prefix unchanged"> </span><span class="token line">           top:-50%;
</span><span class="token prefix unchanged"> </span><span class="token line">           opacity: 0;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .video{
</span><span class="token prefix unchanged"> </span><span class="token line">       position:fixed;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        top:-50%;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       left:50%;
</span><span class="token prefix unchanged"> </span><span class="token line">       transform:translate(-50%,-50%);
</span><span class="token prefix unchanged"> </span><span class="token line">       z-index:10;
</span><span class="token prefix unchanged"> </span><span class="token line">       width:1000px;
</span><span class="token prefix unchanged"> </span><span class="token line">       height:536px;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        opacity:1;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       // 当点击视频中的播放按钮时，会弹出视频的模态框，弹开以后需要给.video加一个class，比如下面的.slideDown
</span><span class="token prefix unchanged"> </span><span class="token line">       // 当.video拥有.slideDown时就执行动画
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &amp;.slideDown{
</span><span class="token prefix inserted">+</span><span class="token line">            animation: slideDown .6s linear;
</span><span class="token prefix inserted">+</span><span class="token line">            top:50%;
</span><span class="token prefix inserted">+</span><span class="token line">        }
</span><span class="token prefix inserted">+</span><span class="token line">        &amp;.slideUp{
</span><span class="token prefix inserted">+</span><span class="token line">        	animation: slideUp .6s linear;
</span><span class="token prefix inserted">+</span><span class="token line">        }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   	...
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// script
data() {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">       // showSlide没有布尔值了，因为默认是没有该布尔值的，可以控制它为slideDown或slideUp
</span><span class="token prefix unchanged"> </span><span class="token line">       showSlide: '',
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    &lt;div class=&quot;item-video&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;video-bg&quot; @click=&quot;showSlide='slideDown'&quot;&gt;&lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;video-box&quot; v-show=&quot;showSlide&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         &lt;!-- overlay遮罩 --&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          &lt;div class=&quot;overlay&quot; v-if=&quot;showSlide=='slideDown'&quot;&gt;&lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">          &lt;!-- 如果showSlide为空字符串则不显示 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">          &lt;div class=&quot;video&quot; v-bind:class=&quot;showSlide&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">            &lt;span class=&quot;icon-close&quot; @click=&quot;showSlide='slideUp'&quot;&gt;&lt;/span&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;!-- muted使得音频静音输出 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;video src=&quot;/imgs/product/video.mp4&quot; muted autoplay controls=&quot;controls&quot;&gt;&lt;/video&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span></span></code></pre></div><p>注意：class ：&quot;{}&quot;除了对象的形式，还可以字符串的形式，直接<code>:class=&quot;showSlide&quot;</code></p> <h3 id="_8-5-产品站交互实现"><a href="#_8-5-产品站交互实现" class="header-anchor">#</a> 8.5 产品站交互实现</h3> <ol><li><code>product.vue</code>中，通过参评商品名称和价钱渲染</li></ol> <p><code>src/pages/product.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
	...
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   data() {
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       // showSlide没有布尔值了，因为默认是没有该布尔值的，可以控制它为slideDown或slideUp
</span><span class="token prefix unchanged"> </span><span class="token line">       showSlide: '',  // 控制动画效果
</span><span class="token prefix unchanged"> </span><span class="token line">       product: {}, // 产品信息
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.getProductInfo()
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">     getProductInfo() {
</span><span class="token prefix unchanged"> </span><span class="token line">       //  路由跳转是this.$router.push；
</span><span class="token prefix unchanged"> </span><span class="token line">       // this.$route.params.id 获取的参数在这里是商品id
</span><span class="token prefix unchanged"> </span><span class="token line">       // 一个是router 一个是route
</span><span class="token prefix unchanged"> </span><span class="token line">       let id = this.$route.params.id;
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get(`/products/${id}`).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.product = res
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;item-bg&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;h2&gt;{{product.name}}&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;h3&gt;{{product.subtitle}}&lt;/h3&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;&quot; id=&quot;&quot;&gt;全球首款双频 GP&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;&quot; id=&quot;&quot;&gt;骁龙845&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;&quot; id=&quot;&quot;&gt;AI 变焦双摄&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;a href=&quot;&quot; id=&quot;&quot;&gt;红外人脸识别&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;price&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;span&gt;￥&lt;em&gt;{{product.price}}&lt;/em&gt;&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span></span></code></pre></div><ol start="2"><li><code>product.vue</code>组件获取的数值传送到<code>ProductParam.vue</code>组件渲染（父组件传值到子组件）</li></ol> <p><code>src/pages/product.vue</code>：父组件，传递数据</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;product-param :title=&quot;product.name&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;template v-slot:buy&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;button class=&quot;btn&quot;&gt;立即购买&lt;/button&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/template&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/product-param&gt;
</span></span></code></pre></div><p><code>src/components/ProductParam.vue</code>：子组件，通过props接受数据</p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
props: {
	title: String
},
</code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;pro-title&quot;&gt;
</span></span>	{{title}}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><ol start="3"><li>点击&quot;立即购买&quot;，会跳转到相应的产品详情页上</li></ol> <p><code>src/pages/product.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// template  
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;product-param :title=&quot;product.name&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;template v-slot:buy&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;button class=&quot;btn&quot; @click=&quot;buy&quot;&gt;立即购买&lt;/button&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;/template&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/product-param&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// script
	methods: {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     ...,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      buy() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       let id = this.$route.params.id;
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push(`/detail/${id}`)
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span></code></pre></div><h3 id="_8-6-存在的问题"><a href="#_8-6-存在的问题" class="header-anchor">#</a> 8.6 存在的问题</h3> <ol><li>animation动画中的问题</li></ol> <p>当打开控制台或其他操作导致窗口太小放不下视频，就会出现以下情况</p> <p><img src="/assets/img/image-20220717205926690.d52630e6.png" alt="image-20220717205926690"></p> <p>解决方法：当关闭视频时，应该将装有遮罩层和video的video-box大盒子隐藏掉，而不是直接隐藏遮罩层，并把video移出去（top：-50%）。即唯一能解决的就是把video-box给隐藏掉，控制video-box的显示和隐藏，但是这样可能导致动画失灵。</p> <p>如下，直接将 v-if 放在 video-box 看看效果，这样能解决上述问题，但关闭视频的过渡效果 slideUp失效了。</p> <p><code>src/pages/product.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;item-video&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;video-bg&quot; @click=&quot;showSlide='slideDown'&quot;&gt;&lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;video-box&quot; v-if=&quot;showSlide=='slideDown'&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;video&quot; v-bind:class=&quot;showSlide&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            &lt;span class=&quot;icon-close&quot; @click=&quot;showSlide='slideUp'&quot;&gt;&lt;/span&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;video src=&quot;/imgs/product/video.mp4&quot; muted autoplay controls=&quot;controls&quot;&gt;&lt;/video&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span></span></code></pre></div><p>video-box上的<code>v-if=&quot;showSlide='slideDown'&quot;</code>这句判断的意思是说，只有 showSlide='slideDown' 时才展示，那么当点击关闭时(class=&quot;icon-close&quot;)会有 showSlide='slideUp'， slideUp与slideDown不相同，那么就会自动将video-box删除，那么动画就来不及波动。也就是说，当点击关闭，showSlide变成了slideup，video-box判断不是slideDown 直接删除此dom节点，不会产生过渡效果。</p> <p>应该等到<code>&lt;div class=&quot;video&quot; v-bind:class=&quot;showSlide&quot;&gt;</code>变为slideUp后，即动画过渡完以后，再把模块隐藏。</p> <p><code>src/pages/product.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;item-video&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;video-bg&quot; @click=&quot;showSlide='slideDown'&quot;&gt;&lt;/div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;video-box&quot; v-show=&quot;showSlide&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         &lt;!-- overlay遮罩 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;!-- 如果showSlide为空字符串则不显示 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;video&quot; :class=&quot;showSlide&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            &lt;span class=&quot;icon-close&quot; @click=&quot;closeVideo&quot;&gt;&lt;/span&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;!-- muted使得音频静音输出 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;video src=&quot;/imgs/product/video.mp4&quot; muted autoplay controls=&quot;controls&quot;&gt;&lt;/video&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">     ...,
</span><span class="token prefix unchanged"> </span><span class="token line">     closeVideo() {
</span><span class="token prefix unchanged"> </span><span class="token line">       // 当动画过渡完以后再将showSlide置为空
</span><span class="token prefix unchanged"> </span><span class="token line">       this.showSlide='slideUp';
</span><span class="token prefix unchanged"> </span><span class="token line">       // 定时器设置成6s，是因为animation动画效果为6s
</span><span class="token prefix unchanged"> </span><span class="token line">       setTimeout(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.showSlide='';
</span><span class="token prefix unchanged"> </span><span class="token line">       }, 600)
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span></code></pre></div><p>v-show=’”a“ 里面判断得是 a是truely还是falsly变量，而不是ture和false。字符串是truely变量，所以当v-show：”showSlide“ showSlide有值不是空的就会show出来。</p> <ol start="2"><li>接口数据的兼容性问题</li></ol> <p><img src="/assets/img/image-20220717214313627.640bd57a.png" alt="image-20220717214313627"></p> <p>user接口是有返回值的，当该接口没有返回值时，代码会报错</p> <p><code>src/App.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取用户信息
</span><span class="token prefix unchanged"> </span><span class="token line">   getUser() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      // 给res加默认值{}，以确定在未登录情况下能获取值
</span><span class="token prefix inserted">+</span><span class="token line">      this.axios.get('/user').then((res = {})=&gt;{  
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.$store.dispatch('saveUserName',res.username)
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   getCartCount() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      // 给res加默认值0，以确定在未登录情况下能获取值
</span><span class="token prefix inserted">+</span><span class="token line">      this.axios.get('carts/products/sum').then((res = 0)=&gt;{  
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.$store.dispatch('saveCartCount',res);
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><ol start="3"><li>点击关闭按钮后视频仍在后台播放的问题</li></ol> <p>v-if标签控制video标签的显示和隐藏。等slideUP以后，把video隐藏掉</p> <p>组件来回生成销毁也很消耗性能呀？？？</p> <h2 id="_9-商品详情交互实现"><a href="#_9-商品详情交互实现" class="header-anchor">#</a> 9 商品详情交互实现</h2> <ol><li>样式—使用伪元素清除浮动</li></ol> <p><code>src/assets/scss/base.scss</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>.fl {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   float: left;
</span></span>}
.fr {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   float: right;
</span></span>}
.clearfix:before,
.clearfix:after {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   content: ' ';
</span><span class="token prefix unchanged"> </span><span class="token line">   display: table;
</span></span>}
.clearfix:after {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   clear: both;
</span></span>}
</code></pre></div><p><code>src/components/ProductParam.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>.nav-bar {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   height: 70px;
</span><span class="token prefix unchanged"> </span><span class="token line">   line-height: 70px;
</span><span class="token prefix unchanged"> </span><span class="token line">   border: 1px solid $colorH;
</span><span class="token prefix unchanged"> </span><span class="token line">   background-color: $colorG;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    z-index: 10;
</span></span>	...
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}
</span></span></code></pre></div><ol start="2"><li>交互部分</li></ol> <p><code>src/pages/detail.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
export default{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...,
</span><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     id:this.$route.params.id,//获取商品ID
</span><span class="token prefix unchanged"> </span><span class="token line">     product:{},//商品信息
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> ...,
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getProductInfo();
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   getProductInfo(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get(`/products/${this.id}`).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.product = res;
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
</code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// 将商品名称部分用{{product.name}}替换，商品价格部分用{{product.price}}替换
</span></span>
// 另外，detail组件也复用了ProductParam组件，需要进行数据父传子
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">&lt;product-param v-bind:title=&quot;product.name&quot;&gt;&lt;/product-param&gt;
</span></span></code></pre></div><ol start="3"><li>版本按钮切换，和切换数据更改</li></ol> <p><code>src/pages/detail.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
data(){
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     ...,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      version:1,//商品版本切换
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;item-version clearfix&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;h2&gt;选择版本&lt;/h2&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;div class=&quot;phone fl&quot; :class=&quot;{'checked':version==1}&quot; @click=&quot;version=1&quot;&gt;6GB+64GB 全网通&lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;div class=&quot;phone fr&quot; :class=&quot;{'checked':version==2}&quot; @click=&quot;version=2&quot;&gt;4GB+64GB 移动4G&lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span>...
...
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;phone-info clearfix&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;div class=&quot;fl&quot;&gt;{{product.name}} {{version==1?'6GB+64GB 全网通':'4GB+64GB 移动4G'}} 深灰色&lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;fr&quot;&gt;{{product.price}}元&lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><ol start="4"><li>商品详情页面—加入购物车</li></ol> <p><code>src/pages/detail.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;btn-group&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">	&lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-huge fl&quot; @click=&quot;addCart&quot;&gt;加入购物车&lt;/a&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// script
methods:{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   addCart(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/carts',{
</span><span class="token prefix unchanged"> </span><span class="token line">       productId:this.id,
</span><span class="token prefix unchanged"> </span><span class="token line">       selected: true
</span><span class="token prefix unchanged"> </span><span class="token line">     }).then((res={cartProductVoList:0})=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">     	// 改变购物车中的数量
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$store.dispatch('saveCartCount',res.cartTotalQuantity);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       // this.$router.push('/cart');
</span><span class="token prefix unchanged"> </span><span class="token line">     });
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><p><code>src/mian.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// 接口错误拦截
axios.interceptors.response.use(function(response) {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   let res = response.data //res中的status 是与后台协商的字段，这是定义的
</span><span class="token prefix unchanged"> </span><span class="token line">   let path = location.hash
</span><span class="token prefix unchanged"> </span><span class="token line">   if (res.status == 0) { // status为0表示成功
</span><span class="token prefix unchanged"> </span><span class="token line">       return res.data
</span><span class="token prefix unchanged"> </span><span class="token line">   } else if (res.status == 10) { // status为10表示未登录的报错
</span><span class="token prefix unchanged"> </span><span class="token line">       if (path != '#/index') {
</span><span class="token prefix unchanged"> </span><span class="token line">           window.location.href = '/#/login' // 跳转到登录页面，不能用$router.push()这些路由API，因为这是挂载在Vue实例上的，而此时并没有Vue实例
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        return Promise.reject(res)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   } else {
</span><span class="token prefix unchanged"> </span><span class="token line">       alert(res.msg)
</span><span class="token prefix unchanged"> </span><span class="token line">       return Promise.reject(res) // 用Promise.reject()抛出异常
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>})
</code></pre></div><ol start="5"><li>首页index.vue—加入购物车</li></ol> <p><code>src/pages/index.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">// script
</span><span class="token prefix unchanged"> </span><span class="token line">methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">     ...,
</span><span class="token prefix unchanged"> </span><span class="token line">     addCart(id) {
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.post('/carts', {
</span><span class="token prefix unchanged"> </span><span class="token line">         productId: id,
</span><span class="token prefix unchanged"> </span><span class="token line">         selected: true
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res) =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">         this.showModal = true
</span><span class="token prefix unchanged"> </span><span class="token line">         this.$store.dispatch('saveCartCount',res.cartTotalQuantity);
</span><span class="token prefix unchanged"> </span><span class="token line">       }).catch(() =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">         this.showModal = true
</span><span class="token prefix unchanged"> </span><span class="token line">       }) 
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span></code></pre></div><h2 id="_10-购物车页面"><a href="#_10-购物车页面" class="header-anchor">#</a> 10 购物车页面</h2> <h3 id="_10-1-order-header组件"><a href="#_10-1-order-header组件" class="header-anchor">#</a> 10.1 Order-Header组件</h3> <p>Order-Header部分会被多个页面复用，所以独立为一个组件</p> <blockquote><p>stlyle标签中没有使用scoped的原因：使用scoped以后会增加很多无用的标签和属性，这样页面会比较重。只有在确实无法区分的时候加scoped，但是在能用主class区分的时候就没有必要再使用scoped了。</p></blockquote> <ol><li>复用主页<code>index.vue</code>中的logo（在NavHeader组件中）</li></ol> <p>(1) 把NavHeader中<code>header-logo</code>这个盒子以及里面的小盒子复制到购物车页面的相应位置</p> <p><code>src/components/OrderHeader</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;order-header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;div class=&quot;header-logo&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;a href=&quot;/#/index&quot;&gt;&lt;/a&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span></code></pre></div><p>(2) 把header-logo的样式剪切到base.scss中，在base.scss中还需引入mixin.scss和config.scss</p> <p><code>src/assets/scss/base.scss</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>@import './mixin.scss';
@import './config.scss';
......
// 公共logo
.header-logo {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   display: inline-block; // 将a标签定义为行内块
</span><span class="token prefix unchanged"> </span><span class="token line">   width: 55px;
</span><span class="token prefix unchanged"> </span><span class="token line">   height: 55px;
</span><span class="token prefix unchanged"> </span><span class="token line">   background-color: #FF6600;
</span><span class="token prefix unchanged"> </span><span class="token line">   a {
</span><span class="token prefix unchanged"> </span><span class="token line">       display: inline-block; // 将a标签定义为行内块
</span><span class="token prefix unchanged"> </span><span class="token line">       width: 110px; // 55*2，因为要把完整的图片放进去，因为存放的是两张图片
</span><span class="token prefix unchanged"> </span><span class="token line">       height: 55px;
</span><span class="token prefix unchanged"> </span><span class="token line">       &amp;:before {
</span><span class="token prefix unchanged"> </span><span class="token line">           content: ''; // 因为图片没有内容，所以需要占位
</span><span class="token prefix unchanged"> </span><span class="token line">           @include bgImg(55px, 55px, '/imgs/mi-logo.png', 55px);
</span><span class="token prefix unchanged"> </span><span class="token line">           transition: margin .2s;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       &amp;:after {
</span><span class="token prefix unchanged"> </span><span class="token line">           content: '';
</span><span class="token prefix unchanged"> </span><span class="token line">           @include bgImg(55px, 55px, '/imgs/mi-home.png', 55px);
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       /* 当鼠标经过了a链接时，就让里面before的margin-left 设置为 -55px */
</span><span class="token prefix unchanged"> </span><span class="token line">       &amp;:hover:before {
</span><span class="token prefix unchanged"> </span><span class="token line">           margin-left: -55px;
</span><span class="token prefix unchanged"> </span><span class="token line">           transition: margin .2s;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}
</code></pre></div><p>(3) 此时，只要引用 .header-logo 这个类的盒子，都会成功引入logo</p> <ol start="2"><li>购物车的order-header组件，之后的支付和订单页面也会使用，只是标题信息：|我的购物车|和提示信息：|温馨提示...|这两部分内容不同，这可以动态传值</li></ol> <p>“我的购物车”标题信息部分，使用父传子方式来传递信息；“温馨提示...”提示信息部分，使用插槽方式。</p> <p><code>src/components/OrderHeader.vue</code>：子组件</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;order-header&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;!-- 在添加浮动的父容器上清除浮动 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;div class=&quot;container clearfix&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;header-logo&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;/#/index&quot;&gt;&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      &lt;div class=&quot;title&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;h2&gt;{{title}}&lt;slot name=&quot;tip&quot;&gt;&lt;/slot&gt;&lt;/h2&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;username&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;a href=&quot;javascript:;&quot;&gt;Jack&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'order-header',
</span><span class="token prefix unchanged"> </span><span class="token line">   props: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      title: String
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .order-header{
</span><span class="token prefix unchanged"> </span><span class="token line">   padding: 30px 0;
</span><span class="token prefix unchanged"> </span><span class="token line">   .header-logo{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      float:left;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .title,.username{
</span><span class="token prefix unchanged"> </span><span class="token line">     display: inline-block;
</span><span class="token prefix unchanged"> </span><span class="token line">     height: 55px;
</span><span class="token prefix unchanged"> </span><span class="token line">     line-height: 55px;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .title{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      float: left;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     margin-left: 54px;
</span><span class="token prefix unchanged"> </span><span class="token line">     h2 {
</span><span class="token prefix unchanged"> </span><span class="token line">       font-size: 28px;
</span><span class="token prefix unchanged"> </span><span class="token line">       color: #333333;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     span{
</span><span class="token prefix unchanged"> </span><span class="token line">       font-size: 14px;
</span><span class="token prefix unchanged"> </span><span class="token line">       margin-left: 17px;
</span><span class="token prefix unchanged"> </span><span class="token line">       color: #999999;
</span><span class="token prefix unchanged"> </span><span class="token line">       font-weight: 200;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   .username{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      float: right;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     a{
</span><span class="token prefix unchanged"> </span><span class="token line">       color: #666666;
</span><span class="token prefix unchanged"> </span><span class="token line">       font-size: 16px;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p><code>src/pages/cart.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&lt;div class=&quot;cart&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;!-- 这里的title不需要动态的，保持静态就行，因为在购物车页面，一直保持我的购物车 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;order-header title=&quot;我的购物车&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;template v-slot:tip&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;span&gt;温馨提示：产品是否购买成功，以最终下单为准哦，请尽快结算&lt;/span&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;/template&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;/order-header&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &lt;nav-footer&gt;&lt;/nav-footer&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">&lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span></code></pre></div><ol start="3"><li>用户名称动态渲染</li></ol> <p><code>src/components/OrderHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;order-header&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;container clearfix&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;username&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;a href=&quot;javascript:;&quot;&gt;{{username}}&lt;/a&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  import {mapState} from 'vuex'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default {
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   computed: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      ...mapState(['username'])
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><h3 id="_10-2-购物车列表渲染"><a href="#_10-2-购物车列表渲染" class="header-anchor">#</a> 10.2 购物车列表渲染</h3> <blockquote><p>购物车大部分功能其实都是后端实现的，比如价格计算等不需要前端实现，我们只需要调用接口就行，因为后端实现更具有安全性。</p></blockquote> <p><code>src/pages/cart.vue</code>：获取购物车列表并进行渲染</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;cart&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- 这里的title不需要动态的，保持静态就行，因为在购物车页面，一直保持我的购物车 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;order-header title=&quot;我的购物车&quot;&gt;...&lt;/order-header&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;wrapper&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;cart-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;ul class=&quot;cart-item-head&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;col-1&quot;&gt;&lt;span class=&quot;checkbox&quot; v-bind:class=&quot;{'checked':allChecked}&quot;&gt;&lt;/span&gt;全选&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;col-3&quot;&gt;商品名称&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;col-1&quot;&gt;单价&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;col-2&quot;&gt;数量&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;col-1&quot;&gt;小计&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;col-1&quot;&gt;操作&lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;ul class=&quot;cart-item-list&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;li class=&quot;cart-item&quot; v-for=&quot;(item,index) in list&quot; v-bind:key=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item-check&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span class=&quot;checkbox&quot; v-bind:class=&quot;{'checked':item.productSelected}&quot;  &gt;&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item-name&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;img v-lazy=&quot;item.productMainImage&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span&gt;{{item.productName + ' , ' + item.productSubtitle}}&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item-price&quot;&gt;{{item.productPrice}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item-num&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;num-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;javascript:;&quot; &gt;-&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;span&gt;{{item.quantity}}&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;javascript:;&quot; &gt;+&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item-total&quot;&gt;{{item.productTotalPrice}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item-del&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;order-wrap clearfix&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;cart-tip fl&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;/#/index&quot;&gt;继续购物&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           共&lt;span&gt;{{list.length}}&lt;/span&gt;件商品，已选择&lt;span&gt;{{checkedNum}}&lt;/span&gt;件
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;total fr&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           合计：&lt;span&gt;{{cartTotalPrice}}&lt;/span&gt;元
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;javascript:;&quot; class=&quot;btn&quot;&gt;去结算&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;nav-footer&gt;&lt;/nav-footer&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>import OrderHeader from '@/components/OrderHeader.vue'
import NavFooter from '@/components/NavFooter.vue'
export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-cart',
</span><span class="token prefix unchanged"> </span><span class="token line"> components: {
</span><span class="token prefix unchanged"> </span><span class="token line">   OrderHeader, 
</span><span class="token prefix unchanged"> </span><span class="token line">   NavFooter
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     list:[],//商品列表
</span><span class="token prefix unchanged"> </span><span class="token line">     allChecked:false,//是否全选
</span><span class="token prefix unchanged"> </span><span class="token line">     cartTotalPrice:0,//商品总金额
</span><span class="token prefix unchanged"> </span><span class="token line">     checkedNum:0//选中商品数量
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getCartList();
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取购物车列表
</span><span class="token prefix unchanged"> </span><span class="token line">   getCartList(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('/carts').then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.renderData(res);
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">  	// 公共赋值
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   // method中多个功能函数的实现，都在最后运行了 this.renderData(res)即重新刷新了一下数据，所以，就将renderData中的功能单独提出来作为函数进行复用。
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   renderData(res){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.list = res.cartProductVoList || [];
</span><span class="token prefix unchanged"> </span><span class="token line">     this.allChecked = res.selectedAll;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.cartTotalPrice = res.cartTotalPrice;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      // filter过滤器函数只会返回true的结果，这里checkedNum指的是，列表中商品已选中商品（true）的数量
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.checkedNum = this.list.filter(item=&gt;item.productSelected).length;
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;...&lt;/style&gt;
</span></span></code></pre></div><h3 id="_10-3-购物车全选和非全选"><a href="#_10-3-购物车全选和非全选" class="header-anchor">#</a> 10.3 购物车全选和非全选</h3> <p><code>src/pages/cart.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取购物车列表
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   // 控制全选功能
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    toggleAll(){
</span><span class="token prefix inserted">+</span><span class="token line">	  // 利用条件运算符来判断使用那个接口
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     let url = this.allChecked?'/carts/unSelectAll':'/carts/selectAll';
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.put(url).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.renderData(res);
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   // 公共赋值
</span><span class="token prefix unchanged"> </span><span class="token line">   renderData(res){...},
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">ul class=&quot;cart-item-head&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;li class=&quot;col-1&quot;&gt;&lt;span class=&quot;checkbox&quot; v-bind:class=&quot;{'checked':allChecked}&quot; @click=&quot;toggleAll&quot;&gt;&lt;/span&gt;全选&lt;/li&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/ul&gt;
</span></span></code></pre></div><h3 id="_10-4-购物车商品更新和删除"><a href="#_10-4-购物车商品更新和删除" class="header-anchor">#</a> 10.4 购物车商品更新和删除</h3> <ol><li>商品更新</li></ol> <p><code>src/pages/cart.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取购物车列表
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   // 更新购物车数量和购物车单选状态
</span><span class="token prefix unchanged"> </span><span class="token line">   // item 商品信息
</span><span class="token prefix unchanged"> </span><span class="token line">   // type 操作的类型
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    updateCart(item,type){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     let quantity = item.quantity,   // 商品数量
</span><span class="token prefix unchanged"> </span><span class="token line">         selected = item.productSelected;    // 商品是否选中
</span><span class="token prefix unchanged"> </span><span class="token line">     if(type == '-'){
</span><span class="token prefix unchanged"> </span><span class="token line">       if(quantity == 1){
</span><span class="token prefix unchanged"> </span><span class="token line">         alert('商品至少保留一件');
</span><span class="token prefix unchanged"> </span><span class="token line">         return;   // 防止继续往下走
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       --quantity;
</span><span class="token prefix unchanged"> </span><span class="token line">     }else if(type == '+'){
</span><span class="token prefix unchanged"> </span><span class="token line">       if(quantity &gt; item.productStock){
</span><span class="token prefix unchanged"> </span><span class="token line">         alert('购买数量不能超过库存数量');
</span><span class="token prefix unchanged"> </span><span class="token line">         return;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       ++quantity;
</span><span class="token prefix unchanged"> </span><span class="token line">     }else{
</span><span class="token prefix unchanged"> </span><span class="token line">       selected = !item.productSelected;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.put(`/carts/${item.productId}`,{
</span><span class="token prefix unchanged"> </span><span class="token line">       quantity,
</span><span class="token prefix unchanged"> </span><span class="token line">       selected
</span><span class="token prefix unchanged"> </span><span class="token line">     }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.renderData(res);
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   // 控制全选功能
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 公共赋值
</span><span class="token prefix unchanged"> </span><span class="token line">    renderData(res){...},
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">ul class=&quot;cart-item-list&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;li class=&quot;cart-item&quot; v-for=&quot;(item,index) in list&quot; v-bind:key=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-check&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        	&lt;span class=&quot;checkbox&quot; v-bind:class=&quot;{'checked':item.productSelected}&quot;  @click=&quot;updateCart(item)&quot;&gt;&lt;/span&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-name&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-price&quot;&gt;{{item.productPrice}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-num&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;num-box&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                &lt;a href=&quot;javascript:;&quot; @click=&quot;updateCart(item,'-')&quot;&gt;-&lt;/a&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">               &lt;span&gt;{{item.quantity}}&lt;/span&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                &lt;a href=&quot;javascript:;&quot;  @click=&quot;updateCart(item,'+')&quot;&gt;+&lt;/a&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-total&quot;&gt;{{item.productTotalPrice}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-del&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/li&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/ul&gt;
</span></span></code></pre></div><ol start="2"><li>商品删除</li></ol> <p><code>src/pages/cart.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取购物车列表
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 更新购物车数量和购物车单选状态
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 删除购物车商品
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    delProduct(item){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.axios.delete(`/carts/${item.productId}`).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       alert('删除成功');
</span><span class="token prefix unchanged"> </span><span class="token line">       this.renderData(res);
</span><span class="token prefix unchanged"> </span><span class="token line">     });
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   // 控制全选功能
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 公共赋值
</span><span class="token prefix unchanged"> </span><span class="token line">   renderData(res){...},
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">ul class=&quot;cart-item-list&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;li class=&quot;cart-item&quot; v-for=&quot;(item,index) in list&quot; v-bind:key=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-check&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-name&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-price&quot;&gt;{{item.productPrice}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-num&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-total&quot;&gt;{{item.productTotalPrice}}&lt;/div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;item-del&quot; @click=&quot;delProduct(item)&quot;&gt;&lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;/li&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/ul&gt;
</span></span></code></pre></div><h3 id="_10-5-购物车结算"><a href="#_10-5-购物车结算" class="header-anchor">#</a> 10.5 购物车结算</h3> <p><code>src/pages/cart.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script  
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取购物车列表
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 更新购物车数量和购物车单选状态
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 删除购物车商品
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 控制全选功能
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 公共赋值
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   // 购物车下单
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    order(){
</span><span class="token prefix inserted">+</span><span class="token line">      // 遍历器every的使用：当每一件商品都没有选中时，isCheck为true，只要有一件选中，isCheck都为false
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     let isCheck = this.list.every(item=&gt;!item.productSelected);
</span><span class="token prefix unchanged"> </span><span class="token line">     if(isCheck){
</span><span class="token prefix unchanged"> </span><span class="token line">       alert('请选择一件商品');
</span><span class="token prefix unchanged"> </span><span class="token line">     }else{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push('/order/confirm');
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;order-wrap clearfix&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;cart-tip fl&quot;&gt;...&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;total fr&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       合计：&lt;span&gt;{{cartTotalPrice}}&lt;/span&gt;元
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;a href=&quot;javascript:;&quot; class=&quot;btn&quot; @click=&quot;order&quot;&gt;去结算&lt;/a&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><h2 id="_11-elementui"><a href="#_11-elementui" class="header-anchor">#</a> 11 ElementUI</h2> <p><a href="https://element.eleme.cn/#/zh-CN/component/installation" target="_blank" rel="noopener noreferrer">element-ui官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_11-1-elementui入门梳理"><a href="#_11-1-elementui入门梳理" class="header-anchor">#</a> 11.1 ElementUI入门梳理</h3> <p>ElementUI是前端一门非常优秀的UI+交互的框架，过去的bootstrap是纯粹的CSS框架。</p> <p>一定要知道CSS框架和JS框架的区别。</p> <p>vue，react是前端开发的mv框架，主要是用来做项目用的，而ElementUI是UI框架，UI框架不仅是静态的，它还包括交互。ElementUI是针对vue框架来提供的一套UI框架。</p> <p>按需加载：只把需要的组件打包进来，不需要的组件全部过滤在外面（<code>bable-plugin-component</code>）。</p> <p>按需引入：把一个框架引入我们想用的组件而已，但是打包的时候还是会把整个框架拿过来一起打包，但是我们只是用来其中一些组件。</p> <p>组件&amp;插件：</p> <p>UI框架不仅是传统的样式框架，同时还是一门交互框架，因为它自带交互(比如我们点击一个按钮，它会自动弹出一个框，而过去的话需要配置class)。Dialog就是一个插件加上我们静态的样式，Dropdown就是一个下拉组件。组件就是HTML标签，一般放在HTML中进行引入；插件可以挂在到vue实例上。</p> <p>自定义主题，内置过渡动画。</p> <p>elementUI框架用在b端，即管理系统较多，商场系统属于c端用的较少。这里只是简单了解使用一下。</p> <h3 id="_11-2-elementui运用"><a href="#_11-2-elementui运用" class="header-anchor">#</a> 11.2 ElementUI运用</h3> <ol><li>安装</li></ol> <p>借助babel-plugin-component实现按需加载</p> <div class="language- extra-class"><pre class="language-text"><code>npm i element-ui babel-plugin-component --save-dev
</code></pre></div><ol start="2"><li>配置<code>babal.config.js</code></li></ol> <p>安装按需载入插件babel-plugin-component后，会自动生成一个babal.config.js文件</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 预设的规则，帮助我们来转换ES6的语法</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'@vue/cli-plugin-babel/preset'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 插件</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;component&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;libraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;styleLibraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;theme-chalk&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>在main.js中引入elementUI</li></ol> <p><code>src/main.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// 按需引入element-ui中的Message插件
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import { Message } from 'element-ui'
</span><span class="token prefix inserted">+</span><span class="token line">import 'element-ui/lib/theme-chalk/index.css'
</span></span>...
// 通过原型使用，以后每个组件不用再引用{Message} 
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">Vue.prototype.$message = Message
</span></span>...
</code></pre></div><ol start="4"><li><p>使用elementUI中的Message插件</p> <p>比如在<code>src/main.js</code>中：</p></li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>// 接口错误拦截
axios.interceptors.response.use(function(response) {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   if (res.status == 0) { // status为0表示成功
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">   } else if (res.status == 10) { // status为10表示未登录的报错
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">   } else {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        Message.warning(res.msg)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       return Promise.reject(res) // 用Promise.reject()抛出异常
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>})
</code></pre></div><p>​      比如在<code>src/pages/login.vue</code>中</p> <div class="language-diff extra-class"><pre class="language-diff"><code>// 注册模块
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   register(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/user/register',{
</span><span class="token prefix unchanged"> </span><span class="token line">       username:'admin1',
</span><span class="token prefix unchanged"> </span><span class="token line">       password:'admin1',
</span><span class="token prefix unchanged"> </span><span class="token line">       email:'admin1@163.com'
</span><span class="token prefix unchanged"> </span><span class="token line">     }).then(()=&gt;{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$message.success('注册成功');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span></code></pre></div><h3 id="_11-3-bable介绍"><a href="#_11-3-bable介绍" class="header-anchor">#</a> 11.3 Bable介绍</h3> <p>注意配置babel的时候：<code>.babelrc</code>文件和<code>babel.config.js</code>不能一起使用。</p> <p><a href="https://www.babeljs.cn/docs/" target="_blank" rel="noopener noreferrer">bable中文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_11-4-退出功能实现"><a href="#_11-4-退出功能实现" class="header-anchor">#</a> 11.4 退出功能实现</h3> <ol><li>添加退出按钮，并实现退出登录的接口</li></ol> <p><code>src/components/NavHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods: {
</span><span class="token prefix unchanged"> </span><span class="token line"> 	...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    logout() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/user/logout').then(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$message.success('退出成功')
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// template
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;topbar-user&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; v-if=&quot;username&quot;&gt;{{username}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; v-if=&quot;!username&quot; @click=&quot;login&quot;&gt;登录&lt;/a&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;a href=&quot;javascript:;&quot; v-if=&quot;username&quot; @click=&quot;logout&quot;&gt;退出&lt;/a&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; v-if=&quot;username&quot;&gt;我的订单&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; class=&quot;my-cart&quot; @click=&quot;goToCart&quot;&gt;&lt;span class=&quot;icon-cart&quot;&gt;&lt;/span&gt;购物车({{cartCount}})&lt;/a&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><ol start="2"><li>此时退出功能没有完全实现，我们需要把在Navheader渲染的用户名称和购物车数量清空，以下清空cookie和vuex中用户名称和购物车数量</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods: {
</span><span class="token prefix unchanged"> </span><span class="token line"> 	...
</span><span class="token prefix unchanged"> </span><span class="token line">   logout() {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/user/logout').then(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$message.success('退出成功')
</span><span class="token prefix unchanged"> </span><span class="token line">       // expires: '-1'使得cookie即刻到期
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$cookie.set('userId', '', {expires: '-1'})
</span><span class="token prefix inserted">+</span><span class="token line">        this.$store.dispatch('saveUserName','');
</span><span class="token prefix inserted">+</span><span class="token line">        this.$store.dispatch('saveCartCount','0');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><ol start="3"><li><p>正常情况下，用户选择一定量的商品添加购物车，退出登录再登录，购物车也不会清空，但是现在这样会清空购物车，因此需要进行修改，使得用户退出后再次登录时，重新获取购物车数量。</p> <p>此时有人会有问题，之前App.vue不是设置过获取用户名称和购物车数量的函数调用吗？</p> <p><code>src/App.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取用户信息
</span><span class="token prefix unchanged"> </span><span class="token line">   getUser() {
</span><span class="token prefix unchanged"> </span><span class="token line">     // 给res加默认值{}，以确定在未登录情况下能获取值
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('/user').then((res = {})=&gt;{  
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$store.dispatch('saveUserName',res.username)
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   getCartCount() {
</span><span class="token prefix unchanged"> </span><span class="token line">     // 给res加默认值0，以确定在未登录情况下能获取值
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('carts/products/sum').then((res = 0)=&gt;{  
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$store.dispatch('saveCartCount',res);
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><p>我们之所以在App.vue中设置获取用户名称和购物车数量的函数调用，是因为我们是单页面的，我们把数据存储在vuex里面去，vuex在内存中存储，当我们页面刷新后，内存数据会消失，为了保持数据一致性，需要重新获取数量，重新存储到vuex中，这样才能起到桥梁的作用。</p> <p>但是我们这个场景从退出到登录，再到登录，没有刷新页面，这个过程没有调用App.vue，App.vue只是在项目第一次进来才会调用一次，之后的跳转都不会再调用了。也就是说之前App.vue的相关设置，无法解决这个问题，所以需要在NavHeader.vue中重新获取购物车数量。</p> <p><code>src/components/NavHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>import { mapState } from 'vuex'
export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...,
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted() {
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getCartCount();
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods: {
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   getCartCount() {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('carts/products/sum').then((res = 0)=&gt;{  
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$store.dispatch('saveCartCount',res);
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div></li> <li><p>此时我们在首页页面进行刷新，在XHR上发现会调用两次sum接口，一次是App.vue的，一次是Navheader的，这样会造成资源上的浪费。所以我们应该进行判断如果是从登录页面过来的，再调用NavHeader的sum接口；如果单纯刷新首页，再调用App.vue的sum接口。</p></li></ol> <p><img src="/assets/img/image-20220718203807712.e6350496.png" alt="image-20220718203807712"></p> <p>(1) 如何判断是从登录页面过来的</p> <p>判断的方式有很多，导航守卫就是一种，一般全局导航守卫都是在做一些路由拦截，权限管理等。我们这里只需要判断是从登录页面过来的就行，所以不用比较复杂的全局导航守卫。</p> <p>因此这里推介的方式就是在login登录页面做一些参数跳转。参数跳转的方式有很多，第一种是用query进行传参，第二种方式可以用param传参，第三种方式可以直接在路由跳转的参数上通过&quot;?&quot;去拼接(如<code>this.$router.push('/index?from=login')</code>)</p> <p>a) 用query传参，地址栏会改变</p> <p><code>src/pages/login.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   login(){
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">       // 登录成功，跳转到首页
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$router.push({
</span><span class="token prefix inserted">+</span><span class="token line">          path:'/index',
</span><span class="token prefix inserted">+</span><span class="token line">          query:{
</span><span class="token prefix inserted">+</span><span class="token line">            from:'login'
</span><span class="token prefix inserted">+</span><span class="token line">          }
</span><span class="token prefix inserted">+</span><span class="token line">        });
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span></code></pre></div><p>地址栏会拼接登录地址，这是就可以根据该参数来判断是否从登录页面过来的，但是地址栏中一直会有该参数，有好有坏。</p> <p><img src="data:image/png;base64,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" alt="image-20220718205531437"></p> <p>b) 用params传参，这样能通过<code>this.$route.params</code>获得参数：<code>{from:&quot;login&quot;}</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   login(){
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">       // 登录成功，跳转到首页
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$router.push({
</span><span class="token prefix inserted">+</span><span class="token line">          name:'index',
</span><span class="token prefix inserted">+</span><span class="token line">          params:{
</span><span class="token prefix inserted">+</span><span class="token line">            from:'login'
</span><span class="token prefix inserted">+</span><span class="token line">          }
</span><span class="token prefix inserted">+</span><span class="token line">        });
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span></code></pre></div><p><img src="/assets/img/image-20220718205934781.4b50dcba.png" alt="image-20220718205934781"></p> <p>(2) 此次我们选择用params传参，然后在NavHeader中</p> <p><code>src/components/NavHeader.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mounted() {
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getProductList();
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    let params = this.$route.params
</span><span class="token prefix inserted">+</span><span class="token line">    if(params &amp;&amp; params.from == 'login') {
</span><span class="token prefix inserted">+</span><span class="token line">      this.getCartCount();
</span><span class="token prefix inserted">+</span><span class="token line">    }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span></code></pre></div><p>这样就优化了NavHeader.vue中的sum接口。</p> <ol start="5"><li>App.vue中有关接口的优化</li></ol> <p>如果没有登录，刷新首页，也会获得用户信息和购物车数量，这是没有意义的。</p> <p>(1) 怎么判断当前有没有登录：如果能够获取用户id (userId)，那么就是登录状态；如果不能获取用户id (userId)，那么就是未登录状态。</p> <p><img src="/assets/img/image-20220718212754191.265d4f70.png" alt="image-20220718212754191"></p> <p>(2) 首先我们要判断是不是在登录状态，此时利用cookie中的用户id (userId)</p> <p><code>src/App.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// script
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mounted() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    if(this.$cookie.get('userId')){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.getUser()
</span><span class="token prefix unchanged"> </span><span class="token line">     this.getCartCount()
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span></code></pre></div><p>(3)确保cookie的expires与 JSESSIONID（代表后端的，后端用java就是JSESSIONID）一致都为Session，即会话级别。</p> <p><code>src/login/login.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  login(){
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.post('/user/login', {
</span><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">     }).then((res)=&gt;{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.$cookie.set('userId',res.id,{expires:'Session'});
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       ...
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span></code></pre></div><p>什么是Session会话级别的，就是浏览器关掉（彻彻底底的关掉），会话结束，这个userId的cookie就会丢失，用户要重新登录。</p> <h2 id="_12-订单确认页面-订单结算"><a href="#_12-订单确认页面-订单结算" class="header-anchor">#</a> 12 订单确认页面 订单结算</h2> <p>订单确认页面中部分静态模块实现以及接口功能实现</p> <h3 id="_12-1-订单父组件结构封装"><a href="#_12-1-订单父组件结构封装" class="header-anchor">#</a> 12.1 订单父组件结构封装</h3> <p>首先可以发现<code>orderConfirm</code>， <code>orderPay</code> ，<code>orderList</code> ，<code>alipay</code>这4个组件的 <code>OrderHeader</code>组件都是复用的，只是内容不一样，我们可以封装在<code>order</code>组件中，不用再一个一个组件的引用，直接动态渲染即可。</p> <p><code>src/pages/order.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;order-header :title=&quot;title&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;template v-slot:tip&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;span&gt;{{tip}}&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/template&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/order-header&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;router-view&gt;&lt;/router-view&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;service-bar&gt;&lt;/service-bar&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;nav-footer&gt;&lt;/nav-footer&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>import OrderHeader from '@/components/OrderHeader.vue'
import NavFooter from '@/components/NavFooter.vue'
import ServiceBar from '@/components/ServiceBar.vue'
export default {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name: 'mi-order',
</span><span class="token prefix unchanged"> </span><span class="token line"> components: { 
</span><span class="token prefix unchanged"> </span><span class="token line">   OrderHeader, 
</span><span class="token prefix unchanged"> </span><span class="token line">   NavFooter, 
</span><span class="token prefix unchanged"> </span><span class="token line">   ServiceBar 
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     title:'',
</span><span class="token prefix unchanged"> </span><span class="token line">     tip:'',
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">   let path = this.$route.path
</span><span class="token prefix unchanged"> </span><span class="token line">   if(path == '/order/confirm') {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.title = '订单确认'
</span><span class="token prefix unchanged"> </span><span class="token line">     this.tip = '请认真填写收货地址'
</span><span class="token prefix unchanged"> </span><span class="token line">   }else if(path == '/order/list') {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.title = '订单列表'
</span><span class="token prefix unchanged"> </span><span class="token line">     this.tip = '请谨慎钓鱼链接或诈骗电话，了解更多&gt;&gt;'
</span><span class="token prefix unchanged"> </span><span class="token line">   }else if(path == '/order/pay') {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.title = '订单支付'
</span><span class="token prefix unchanged"> </span><span class="token line">     this.tip = '请谨慎钓鱼链接或诈骗电话，了解更多&gt;&gt;'
</span><span class="token prefix unchanged"> </span><span class="token line">   }else  {
</span><span class="token prefix unchanged"> </span><span class="token line">     this.title = '订单支付'
</span><span class="token prefix unchanged"> </span><span class="token line">     this.tip = '请谨慎钓鱼链接或诈骗电话，了解更多&gt;&gt;'
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><h3 id="_12-2-地址和商品数据加载"><a href="#_12-2-地址和商品数据加载" class="header-anchor">#</a> 12.2 地址和商品数据加载</h3> <p><strong>小知识：</strong></p> <p>svg矢量图，jpg和png的图片容易失真。</p> <p>图片地址中加了cdn，cdn本身是一个加速器，可以加速前端页面的加载，cdn拉取一次图片以后会永久缓存。</p> <p><code>src/pages/orderConfirm</code>：确定要渲染的数据列表定义data ==&gt; 调用接口获取数据 ==&gt; 渲染</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;order-confirm&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;svg version=&quot;1.1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; style=&quot;position: absolute; width: 0px; height: 0px; overflow: hidden;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;defs&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;symbol id=&quot;icon-add&quot; viewBox=&quot;0 0 31 32&quot;&gt;...&lt;/symbol&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;symbol id=&quot;icon-edit&quot; viewBox=&quot;0 0 32 32&quot;&gt;...&lt;/symbol&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;symbol id=&quot;icon-del&quot; viewBox=&quot;0 0 32 32&quot;&gt;...&lt;/symbol&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/defs&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/svg&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;wrapper&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;container&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;order-box&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-address&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;h2 class=&quot;addr-title&quot;&gt;收货地址&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;addr-list clearfix&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;addr-info&quot; v-for=&quot;(item,index) in list&quot; :key=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;h2&gt;{{item.receiverName}}&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;phone&quot;&gt;{{item.receiverMobile}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;street&quot;&gt;{{item.receiverProvince + ' ' + item.receiverCity + ' ' + item.receiverDistrict + ' ' + item.receiverAddress}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;action&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;javascript:;&quot; class=&quot;fl&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;svg class=&quot;icon icon-del&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;use xlink:href=&quot;#icon-del&quot;&gt;&lt;/use&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/svg&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;a href=&quot;javascript:;&quot; class=&quot;fr&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;svg class=&quot;icon icon-edit&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                     &lt;use xlink:href=&quot;#icon-edit&quot;&gt;&lt;/use&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;/svg&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;addr-add&quot; @click=&quot;openAddressModal&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;icon-add&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div&gt;添加新地址&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-good&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;h2&gt;商品&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;li v-for=&quot;(item,index) in cartList&quot; :key=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;good-name&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;img v-lazy=&quot;item.productMainImage&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;span&gt;{{item.productName + ' ' + item.productSubtitle}}&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;good-price&quot;&gt;{{item.productPrice}}元x{{item.quantity}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;!-- 考虑到安全性，商品的总价格是由后端来计算的 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;good-total&quot;&gt;{{item.productTotalPrice}}元&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-shipping&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;h2&gt;配送方式&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;span&gt;包邮&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-invoice&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;h2&gt;发票&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;javascript:;&quot;&gt;电子发票&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;javascript:;&quot;&gt;个人&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;detail&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-name&quot;&gt;商品件数：&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-val&quot;&gt;{{count}}件&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-name&quot;&gt;商品总价：&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-val&quot;&gt;{{cartTotalPrice}}元&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-name&quot;&gt;优惠活动：&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-val&quot;&gt;0元&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-name&quot;&gt;运费：&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-val&quot;&gt;0元&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item-total&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-name&quot;&gt;应付总额：&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;span class=&quot;item-val&quot;&gt;{{cartTotalPrice}}元&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;btn-group&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;/#/cart&quot; class=&quot;btn btn-default btn-large&quot;&gt;返回购物车&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-large&quot;&gt;去结算&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name:'order-confirm',
</span><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      list:[],//收货地址列表
</span><span class="token prefix inserted">+</span><span class="token line">      cartList:[],//购物车中需要结算的商品列表
</span><span class="token prefix inserted">+</span><span class="token line">      cartTotalPrice:0,//商品总金额
</span><span class="token prefix inserted">+</span><span class="token line">      count:0,//商品结算数量
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted(){
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    this.getAddressList();
</span><span class="token prefix inserted">+</span><span class="token line">    this.getCartList();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取地址列表
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    getAddressList(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('/shippings').then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.list = res.list;
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    getCartList(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get('/carts').then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       let list = res.cartProductVoList;//获取购物车中所有商品数据(包括已选中的和未选中的)
</span><span class="token prefix unchanged"> </span><span class="token line">       this.cartTotalPrice = res.cartTotalPrice;//商品总金额(购物车中已经选中的商品的总金额)
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.cartList = list.filter(item=&gt;item.productSelected);//filter选中的是符合条件的每一项
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       // 计算需要结算的商品的总数量
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.cartList.map((item)=&gt;{
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         this.count += item.quantity;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><p><strong>注意：</strong></p> <p>(1) cartList是购物车中选中的商品列表，是接口的购物车列表经过过滤器过滤出来的；其次 count计算的是 cartList列表中各种商品一共购买了多少件，即选中的商品的总数量。</p> <p>(2) 过滤器 filter和 遍历器 map的使用：过滤器 filter过滤出来选中状态为true的商品，加入cartList中；遍历器map对cartList的商品数量依次相加得到总数量。之前使用的every()方法是测试一个数组内的所有元素是否都能通过某个指定函数的测试，它返回一个布尔值。</p> <h3 id="_12-3-地址增删改"><a href="#_12-3-地址增删改" class="header-anchor">#</a> 12.3 地址增删改</h3> <p><img src="/assets/img/image-20220719150529464.e51fbb23.png" alt="image-20220719150529464"></p> <ol><li><p>删除地址：首先找到“删除”图标，当点击该图标时，触发点击事件，调用<code>delAddress(item)</code>，为了锁定删除的是那一个地址，该事件需要传入删除目标的id(可以是item或item.id)；调用<code>delAddress(item)</code>后会弹出一个框来确认是否删除，所以需要使用模态框组件，以防止误删。该模态框中的 btnType为&quot;1&quot;，表示只有确定按钮，当点击该按钮时，触发自定义事件submit，调用<code>submitAddress</code>。</p></li> <li><p>新增地址：点击“添加新地址”时，触发点击事件，调用<code>openAddressModal</code>；调用该函数后会展示<strong>编辑模态框</strong>。该模态框中的 btnType为&quot;1&quot;，表示只有确定按钮，当点击该按钮时，触发自定义事件submit，调用<code>submitAddress</code>。</p></li> <li><p>修改地址：点击“修改”图标时，触发点击事件，调用<code>editAddressModal(item)</code>，为了锁定修改的是那一个地址，该事件需要传入编辑目标的id(可以是item或item.id)；调用<code>editAddressModal(item)</code>函数后会展示<strong>编辑模态框</strong>。该模态框中的 btnType为&quot;1&quot;，表示只有确定按钮，当点击该按钮时，触发自定义事件submit，调用<code>submitAddress</code>。</p></li> <li><p>注意1：总的有两个模态框，删除地址用“删除模态框”，新增地址和修改地址共用“编辑模态框”。这两个模态框中都只有一个“确定”按钮，点击该按钮调用的都是<code>submitAddress</code>函数，在该函数中会区分用户进行的是什么操作(删除，修改或新增)。</p></li> <li><p>注意2：删和改需要传item参数是因为，删改的接口地址含有item的id，并且在点击删改/修改按钮，弹出模态框时，checkedItem已经为点击的地址item对象了。</p></li> <li><p>注意3：虽然新增地址和修改地址共用的都是“编辑模态框”，但是点击修改地址弹出的模态框中是有原地址数据的，而新增地址弹出的模态框是完全空白的。</p></li></ol> <p><img src="/assets/img/image-20220719211111499.7cd3eba7.png" alt=""></p> <p><code>src/pages/OrderConfirm.vue</code></p> <p>（1）点击的图标</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;action&quot;&gt;
</span></span>	// 删除地址图标
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; class=&quot;fl&quot; @click=&quot;delAddress(item)&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;!-- svg的使用和引用 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;svg class=&quot;icon icon-del&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       	&lt;use xlink:href=&quot;#icon-del&quot;&gt;&lt;/use&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/svg&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   // 新增图标
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;javascript:;&quot; class=&quot;fr&quot; @click=&quot;editAddressModal(item)&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;svg class=&quot;icon icon-edit&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       	&lt;use xlink:href=&quot;#icon-edit&quot;&gt;&lt;/use&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/svg&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/a&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span>......
// 新增地址
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;addr-add&quot; @click=&quot;openAddressModal&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;icon-add&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div&gt;添加新地址&lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><p>（2）编辑模态框及删除模态框，@cancel=&quot;showEditModal=false&quot;表示不展示模态框。注意：编辑模态中的表单数据需要双向绑定。</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;modal
</span><span class="token prefix unchanged"> </span><span class="token line">     title=&quot;新增确认&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     btnType=&quot;1&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     :showModal=&quot;showEditModal&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     @cancel=&quot;showEditModal=false&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     @submit=&quot;submitAddress&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   &gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;template v-slot:body&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;edit-wrap&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          &lt;!-- 双向绑定：主要利用了v-model指令，此时checkedItem就等于点击的地址的item，因为在打开模态框之前，触发了openAddressModal，editAddressModal事件，this.checkedItem 被赋值为{}或item --&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;input type=&quot;text&quot; class=&quot;input&quot; placeholder=&quot;姓名&quot; v-model=&quot;checkedItem.receiverName&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;input type=&quot;text&quot; class=&quot;input&quot; placeholder=&quot;手机号&quot; v-model=&quot;checkedItem.receiverMobile&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;select name=&quot;province&quot; v-model=&quot;checkedItem.receiverProvince&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;北京&quot;&gt;北京&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;天津&quot;&gt;天津&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;河北&quot;&gt;河北&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/select&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;select name=&quot;city&quot; v-model=&quot;checkedItem.receiverCity&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;北京&quot;&gt;北京&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;天津&quot;&gt;天津&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;河北&quot;&gt;石家庄&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/select&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;select name=&quot;district&quot; v-model=&quot;checkedItem.receiverDistrict&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;北京&quot;&gt;昌平区&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;天津&quot;&gt;海淀区&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;河北&quot;&gt;东城区&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;天津&quot;&gt;西城区&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;河北&quot;&gt;顺义区&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;option value=&quot;天津&quot;&gt;房山区&lt;/option&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/select&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;textarea name=&quot;street&quot; v-model=&quot;checkedItem.receiverAddress&quot;&gt;&lt;/textarea&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;input type=&quot;text&quot; class=&quot;input&quot; placeholder=&quot;邮编&quot; v-model=&quot;checkedItem.receiverZip&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/template&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/modal&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;modal
</span><span class="token prefix unchanged"> </span><span class="token line">     title=&quot;删除确认&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     btnType=&quot;1&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     :showModal=&quot;showDelModal&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     @cancel=&quot;showDelModal=false&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">     @submit=&quot;submitAddress&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   &gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;template v-slot:body&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;p&gt;您确认要删除此地址吗？&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/template&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/modal&gt;
</span></span></code></pre></div><p>(3) 引入模态框组件，在data中定义需要使用的变量，定义使用的函数<code>openAddressModal(), editAddressModal(item),delAddress(item),submitAddress()</code>，当点击模态框中的“确认按钮后”，向服务器发起请求后还得关闭模态框并清理相应的数据(调用<code>closeModal()</code>)，再次获取最新的地址列表。</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>// 引入模块框组件
import Modal from './../components/Modal'
export default{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name:'order-confirm',
</span><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">     checkedItem:{},//选中的商品对象
</span><span class="token prefix unchanged"> </span><span class="token line">     userAction:'',//用户行为 0：新增 1：编辑 2：删除
</span><span class="token prefix unchanged"> </span><span class="token line">     showDelModal:false,//是否显示删除弹框，默认看不见
</span><span class="token prefix unchanged"> </span><span class="token line">     showEditModal:false,//是否显示新增或者编辑弹框，默认看不见
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> components:{
</span><span class="token prefix unchanged"> </span><span class="token line">   Modal
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getAddressList();
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getCartList();
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取地址列表
</span><span class="token prefix unchanged"> </span><span class="token line">   getAddressList(){...},
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 打开新增地址弹框
</span><span class="token prefix inserted">+</span><span class="token line">    openAddressModal(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.userAction = 0;
</span><span class="token prefix unchanged"> </span><span class="token line">     // 这只是打开，是没有地址对象的，所以置为空
</span><span class="token prefix unchanged"> </span><span class="token line">     this.checkedItem = {};
</span><span class="token prefix unchanged"> </span><span class="token line">     this.showEditModal = true;
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 打开编辑地址弹框
</span><span class="token prefix inserted">+</span><span class="token line">    editAddressModal(item){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.userAction = 1;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.checkedItem = item;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.showEditModal = true;
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 打开删除地址弹框
</span><span class="token prefix inserted">+</span><span class="token line">    delAddress(item){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.checkedItem = item;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.userAction = 2;        // 表示用户点击的是删除图标
</span><span class="token prefix unchanged"> </span><span class="token line">     this.showDelModal = true;   // 展示模态框
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 地址删除、编辑、新增功能
</span><span class="token prefix inserted">+</span><span class="token line">    submitAddress(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     let {checkedItem,userAction} = this;
</span><span class="token prefix unchanged"> </span><span class="token line">     let method,url,params={};
</span><span class="token prefix unchanged"> </span><span class="token line">     
</span><span class="token prefix unchanged"> </span><span class="token line">     if(userAction == 0){  // 新增
</span><span class="token prefix unchanged"> </span><span class="token line">       method = 'post',url = '/shippings';
</span><span class="token prefix unchanged"> </span><span class="token line">     }else if(userAction == 1){  // 编辑
</span><span class="token prefix unchanged"> </span><span class="token line">       method = 'put',url = `/shippings/${checkedItem.id}`;
</span><span class="token prefix unchanged"> </span><span class="token line">     }else {   // 删除
</span><span class="token prefix unchanged"> </span><span class="token line">       method = 'delete',url = `/shippings/${checkedItem.id}`;
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      // 只有新增或编辑地址时，需要获取表单中的值，删除不需要
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     if(userAction == 0 || userAction ==1){
</span><span class="token prefix unchanged"> </span><span class="token line">     	// 解构赋值
</span><span class="token prefix unchanged"> </span><span class="token line">       let { receiverName, receiverMobile, receiverProvince, receiverCity, receiverDistrict, receiverAddress, receiverZip} = checkedItem;
</span><span class="token prefix unchanged"> </span><span class="token line">       // 如果某些信息没有填的时候，需要做提示
</span><span class="token prefix unchanged"> </span><span class="token line">       let errMsg='';
</span><span class="token prefix unchanged"> </span><span class="token line">       if(!receiverName){
</span><span class="token prefix unchanged"> </span><span class="token line">         errMsg = '请输入收货人名称';
</span><span class="token prefix unchanged"> </span><span class="token line">       }else if(!receiverMobile || !/\d{11}/.test(receiverMobile)){ //手机号位数
</span><span class="token prefix unchanged"> </span><span class="token line">         errMsg = '请输入正确格式的手机号';
</span><span class="token prefix unchanged"> </span><span class="token line">       }else if(!receiverProvince){
</span><span class="token prefix unchanged"> </span><span class="token line">         errMsg = '请选择省份';
</span><span class="token prefix unchanged"> </span><span class="token line">       }else if(!receiverCity){
</span><span class="token prefix unchanged"> </span><span class="token line">         errMsg = '请选择对应的城市';
</span><span class="token prefix unchanged"> </span><span class="token line">       }else if(!receiverAddress || !receiverDistrict){
</span><span class="token prefix unchanged"> </span><span class="token line">         errMsg = '请输入收货地址';
</span><span class="token prefix unchanged"> </span><span class="token line">       }else if(!/\d{6}/.test(receiverZip)){ //邮编的位数
</span><span class="token prefix unchanged"> </span><span class="token line">         errMsg = '请输入六位邮编';
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       if(errMsg){
</span><span class="token prefix unchanged"> </span><span class="token line">         this.$message.error(errMsg);
</span><span class="token prefix unchanged"> </span><span class="token line">         return;
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       params = {
</span><span class="token prefix unchanged"> </span><span class="token line">         receiverName,
</span><span class="token prefix unchanged"> </span><span class="token line">         receiverMobile,
</span><span class="token prefix unchanged"> </span><span class="token line">         receiverProvince,
</span><span class="token prefix unchanged"> </span><span class="token line">         receiverCity,
</span><span class="token prefix unchanged"> </span><span class="token line">         receiverDistrict,
</span><span class="token prefix unchanged"> </span><span class="token line">         receiverAddress,
</span><span class="token prefix unchanged"> </span><span class="token line">         receiverZip
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">     
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      // 拿到接口，参数后向服务器发起不同的请求
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     // 由于method是动态的变量，所以用[]中括号括起来
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios[method](url,params).then(()=&gt;{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.closeModal();
</span><span class="token prefix inserted">+</span><span class="token line">        // 获取最新的地址
</span><span class="token prefix inserted">+</span><span class="token line">        this.getAddressList();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.$message.success('操作成功');
</span><span class="token prefix unchanged"> </span><span class="token line">     });
</span><span class="token prefix unchanged"> </span><span class="token line">     
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 关闭弹框，清理数据
</span><span class="token prefix inserted">+</span><span class="token line">    closeModal(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.checkedItem = {};
</span><span class="token prefix unchanged"> </span><span class="token line">     this.userAction = '';
</span><span class="token prefix unchanged"> </span><span class="token line">     this.showDelModal = false;
</span><span class="token prefix unchanged"> </span><span class="token line">     this.showEditModal = false;
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   // 获取购物车选中商品的信息
</span><span class="token prefix unchanged"> </span><span class="token line">   getCartList(){...},
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><h3 id="_12-4-给选中的地址添加主题色的边框"><a href="#_12-4-给选中的地址添加主题色的边框" class="header-anchor">#</a> 12.4 给选中的地址添加主题色的边框</h3> <p><img src="data:image/png;base64,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" alt="image-20220719162948938"></p> <p><code>src/pages/OrderConfirm.vue</code></p> <p>(1) 先设置一个：checked样式，利用：class动态绑定</p> <div class="language-diff extra-class"><pre class="language-diff"><code>&amp;.checked{
	border:1px solid #ff6700;
}
</code></pre></div><p>(2) 巧妙利用收货地址列表的索引（index）和checkIndex进行判断。</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      checkIndex:0//当前收货地址选中索引，默认选中第一个地址(索引为0)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">// 当点击时将checkIndex赋值为当前索引index。如果当前索引值等于checkIndex，则有class为checked的样式
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;addr-info&quot; :class=&quot;{'checked':index == checkIndex}&quot; @click=&quot;checkIndex=index&quot; v-for=&quot;(item,index) in list&quot; :key=&quot;index&quot;&gt;
</span></span></code></pre></div><h3 id="_12-5-订单结算"><a href="#_12-5-订单结算" class="header-anchor">#</a> 12.5 订单结算</h3> <p><code>src/pages/OrderConfirm.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;btn-group&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;a href=&quot;/#/cart&quot; class=&quot;btn btn-default btn-large&quot;&gt;返回购物车&lt;/a&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;a href=&quot;javascript:;&quot; class=&quot;btn btn-large&quot; @click=&quot;orderSubmit&quot;&gt;去结算&lt;/a&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// 订单提交
orderSubmit(){
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    let item = this.list[this.checkIndex];
</span><span class="token prefix inserted">+</span><span class="token line">    // 地址不能为空
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   if(!item){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$message.error('请选择一个收货地址');
</span><span class="token prefix unchanged"> </span><span class="token line">       return;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line">   this.axios.post('/orders',{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    	shippingId:item.id		//根据收货地址确认订单号
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }).then((res)=&gt;{ 	//res返回订单号
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    	// 路由跳转，query传参
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push({
</span><span class="token prefix unchanged"> </span><span class="token line">           path:'/order/pay',
</span><span class="token prefix unchanged"> </span><span class="token line">           query:{
</span><span class="token prefix unchanged"> </span><span class="token line">           	orderNo:res.orderNo	// 订单号
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">   })
</span></span>}
</code></pre></div><p>跳转到'/order/pay'后的路由地址拼接了订单号(因为时query传参)</p> <p><img src="data:image/png;base64,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" alt="image-20220719165941221"></p> <h2 id="_13-支付功能"><a href="#_13-支付功能" class="header-anchor">#</a> 13 支付功能</h2> <h3 id="_13-1-订单详情数据加载"><a href="#_13-1-订单详情数据加载" class="header-anchor">#</a> 13.1 订单详情数据加载</h3> <p><img src="/assets/img/image-20220719174927644.e21f1b72.png" alt="image-20220719174927644"></p> <p><code>src/pages/orderPay.vue</code></p> <ol><li>调用接口获取收货人数据及订单详情数据</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name:'order-pay',
</span><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      orderId:this.$route.query.orderNo, // 订单编号
</span><span class="token prefix inserted">+</span><span class="token line">      addressInfo:'',//收货人地址
</span><span class="token prefix inserted">+</span><span class="token line">      orderDetail:[],//订单详情，包含商品列表
</span><span class="token prefix inserted">+</span><span class="token line">	   showDetail:false,//是否显示订单详情
</span><span class="token prefix inserted">+</span><span class="token line">	   payment:0,//订单总金额
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getOrderDetail();
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line"> 	//获取订单详情数据
</span><span class="token prefix unchanged"> </span><span class="token line">   getOrderDetail(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.axios.get(`/orders/${this.orderId}`).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       let item = res.shippingVo;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.addressInfo = `${item.receiverName} ${item.receiverMobile} ${item.receiverProvince} ${item.receiverCity} ${item.receiverDistrict} ${item.receiverAddress}`;
</span><span class="token prefix inserted">+</span><span class="token line">        this.orderDetail = res.orderItemVoList;
</span><span class="token prefix inserted">+</span><span class="token line">        this.payment = res.payment;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     })
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><ol start="2"><li>渲染页面以及通过showDetail判断是否展示订单详情展示，此处有一个动画效果</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;order-wrap&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;item-order&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;icon-succ&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;order-info&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;h2&gt;订单提交成功！去付款咯～&lt;/h2&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;p&gt;请在&lt;span&gt;30分&lt;/span&gt;内完成支付, 超时后将取消订单&lt;/p&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              &lt;p&gt;收货信息：{{addressInfo}}&lt;/p&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;order-total&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              &lt;p&gt;应付总额：&lt;span&gt;{{payment}}&lt;/span&gt;元&lt;/p&gt;
</span><span class="token prefix inserted">+</span><span class="token line">              &lt;!-- 通过showDetail判断是否展示订单详情展示 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">              &lt;p&gt;订单详情&lt;em class=&quot;icon-down&quot; :class=&quot;{'up':showDetail}&quot; @click=&quot;showDetail=!showDetail&quot;&gt;&lt;/em&gt;&lt;/p&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          &lt;!-- 通过v-if判断是否展示订单详情，当showDetail为true时显示 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">          &lt;div class=&quot;item-detail&quot; v-if=&quot;showDetail&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;detail-title&quot;&gt;订单号：&lt;/div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              &lt;div class=&quot;detail-info theme-color&quot;&gt;{{orderId}}&lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;detail-title&quot;&gt;收货信息：&lt;/div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">              &lt;div class=&quot;detail-info&quot;&gt;{{addressInfo}}&lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item good&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;detail-title&quot;&gt;商品名称：&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;detail-info&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;ul&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                  &lt;li v-for=&quot;(item,index) in orderDetail&quot; :key=&quot;index&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">                    &lt;img v-lazy=&quot;item.productImage&quot;/&gt;{{item.productName}}
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/li&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/ul&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;item&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;detail-title&quot;&gt;发票信息：&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;detail-info&quot;&gt;电子发票 个人&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span></span></code></pre></div><h3 id="_13-2-支付宝支付对接"><a href="#_13-2-支付宝支付对接" class="header-anchor">#</a> 13.2 支付宝支付对接</h3> <p>支付功能在前端中只占20%-30%，剩下的80%-70%由后端实现。</p> <ol><li>支付的接口：</li></ol> <p><img src="/assets/img/image-20220719202742004.9703c1b0.png" alt="image-20220719202742004"></p> <blockquote><p>首先了解“支付宝”返回的内容中的<code>content</code>是<code>html</code>源码，渲染到页面上后自动跳转到支付页面，支付宝有层网关，网关有层签名，重定向到收银台，进行扫码支付。</p></blockquote> <ol start="2"><li>用payType判断及并切换支付宝/微信支付，实现的原理与切换“地址的增删改”一样，<code>paySubmit(payType)</code>中有为payType赋值的代码。另外对于支付宝来说，在<code>paySubmit(payType)</code>中还包括打开新窗口alipay页面。</li></ol> <p><code>src/pages/orderPay.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;item-pay&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;h3&gt;选择以下支付方式付款&lt;/h3&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;pay-way&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;p&gt;支付平台&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;pay pay-ali&quot; :class=&quot;{'checked':payType==1}&quot; @click=&quot;paySubmit(1)&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;pay pay-wechat&quot; :class=&quot;{'checked':payType==2}&quot; @click=&quot;paySubmit(2)&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     orderId:this.$route.query.orderNo,
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      payType:'',//支付类型
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">  ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    paySubmit(payType){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     if(payType == 1){ //支付宝支付
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      	// 在新窗口打开alipay页面
</span></span>		// 路由地址中还需要拼接上订单编号，因为alipay页面中调用支付接口时会用到
		// 用’_blank’重新开启一个新窗口
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        window.open('/#/order/alipay?orderId='+this.orderId,'_blank');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }else{  // 微信支付
</span><span class="token prefix unchanged"> </span><span class="token line">     	
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><ol start="3"><li>当点击“支付宝”时，就打开<strong>新的窗口</strong>“alipay”页面，在新窗口中进行处理。因为支付宝本身会打开一个页面。这样做是以免支付宝自动打开的页面覆盖“orderPay”页面，所以在新窗口：“alipay”页面进行处理，这样支付宝自动打开的页面覆盖的就是“alipay”页面。</li></ol> <p><img src="/assets/img/image-20220719211111468.b78702dd.png" alt="image-20220719211111468"></p> <p><code>src/pages/alipay.vue</code>：专门用来做支付宝跳转的页面。其中调用了“支付的接口”。另外该页面中还使用了一个加载效果组件<code>Loading.vue</code>，即页面还未跳转时渲染展示。</p> <p><code>src/pages/alipay.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;ali-pay&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;loading v-if=&quot;loading&quot;&gt;&lt;/loading&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;!-- “支付宝”返回的内容中的`content`是`html`源码 --&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;!-- 将`html`源码赋值给v-html后需要提交表单 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;div class=&quot;form&quot; v-html=&quot;content&quot;&gt;&lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  import Loading from './../components/Loading'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default{
</span><span class="token prefix unchanged"> </span><span class="token line">   name:'alipay',
</span><span class="token prefix unchanged"> </span><span class="token line">   components:{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      Loading
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   data(){
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        orderId:this.$route.query.orderId, // 获取订单编号
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       content:'',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        loading:true	// 默认展示Loading组件
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   mounted(){
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      this.paySubmit();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   methods:{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      // 调用支付的接口
</span><span class="token prefix inserted">+</span><span class="token line">      paySubmit(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.axios.post('/pay',{
</span><span class="token prefix unchanged"> </span><span class="token line">         orderId:this.orderId,		// 订单编号
</span><span class="token prefix unchanged"> </span><span class="token line">         orderName:'Vue高仿小米商城',
</span><span class="token prefix unchanged"> </span><span class="token line">         amount:0.01,//单位元
</span><span class="token prefix unchanged"> </span><span class="token line">         payType:1 //1支付宝，2微信
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.content = res.content;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          // 拿到源码以后触发表单提交，这样页面将会跳转
</span><span class="token prefix inserted">+</span><span class="token line">		  // 由于加载需要时间(所以v-html赋值需要事件)，所以用一个定时器给出渲染的时间（即渲染到页面后再自动跳转）
</span><span class="token prefix inserted">+</span><span class="token line">          setTimeout(()=&gt;{
</span><span class="token prefix inserted">+</span><span class="token line">			// 用document.forms[0]获取第一个表单，再用submit()方法将表单进行提交，使得跳转到支付宝的支付页面
</span><span class="token prefix inserted">+</span><span class="token line">            document.forms[0].submit();
</span><span class="token prefix inserted">+</span><span class="token line">          },100)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><p><code>src/components/Loading.vue</code>：一个展示加载效果的组件</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;loading&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;img src=&quot;/imgs/loading-svg/loading-bars.svg&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default{
</span><span class="token prefix unchanged"> </span><span class="token line">   name:'loading'
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .loading{
</span><span class="token prefix unchanged"> </span><span class="token line">   height:80px;
</span><span class="token prefix unchanged"> </span><span class="token line">   line-height:80px;
</span><span class="token prefix unchanged"> </span><span class="token line">   text-align:center;
</span><span class="token prefix unchanged"> </span><span class="token line">   padding:30px 0;
</span><span class="token prefix unchanged"> </span><span class="token line">   img{
</span><span class="token prefix unchanged"> </span><span class="token line">     height:100%;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p><strong>补充：</strong></p> <p>(1) submit方法</p> <p><img src="/assets/img/20200727015829272.349c799b.png" alt="在这里插入图片描述"></p> <p>(2) “支付宝”返回的内容中的<code>content</code>是<code>html</code>源码</p> <p><img src="/assets/img/image-20220719222635685.445f0693.png" alt="image-20220719222635685"></p> <p>(3) <code>&lt;div class=&quot;form&quot; v-html=&quot;content&quot;&gt;&lt;/div&gt;</code>：渲染到页面</p> <p><img src="/assets/img/image-20220719223216307.2131bfd2.png" alt="image-20220719223216307"></p> <h3 id="_13-3-微信支付对接"><a href="#_13-3-微信支付对接" class="header-anchor">#</a> 13.3 微信支付对接</h3> <p>有很多种，比如付款码支付，JSAPI支付，Native支付，APP支付，H5支付，小程序支付，人脸支付。此处实现的是Native支付，即用户打开“微信扫一扫”，扫描商户的二维码后完成支付。</p> <p><a href="https://pay.weixin.qq.com/wiki/doc/api/native.php?chapter=6_5" target="_blank" rel="noopener noreferrer">微信扫码支付开发文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>当点击微信支付时，会调用paySubmit(payType)方法，然后在该方法中会调用支付接口。该支付接口将返回content，而content中的字符串将被转换为二维码，本次课程将使用的是<code>qrcode</code>插件来转换二维码。当成功获得为二维码以后，将显示微信弹框组件<code>ScanPayCode.vue</code>。</p> <ol><li><p>安装<code>qrcode</code>插件：<code>npm i qrcode --save</code></p></li> <li><p>导入插件：<code>import QRCode from 'qrcode'</code></p></li> <li><p><code>src/pages/orderPay.vue</code></p></li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;item-pay&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;h3&gt;选择以下支付方式付款&lt;/h3&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;pay-way&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;p&gt;支付平台&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;pay pay-ali&quot; :class=&quot;{'checked':payType==1}&quot; @click=&quot;paySubmit(1)&quot;&gt;&lt;/div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            &lt;div class=&quot;pay pay-wechat&quot; :class=&quot;{'checked':payType==2}&quot; @click=&quot;paySubmit(2)&quot;&gt;&lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span></span>...
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;scan-pay-code v-if=&quot;showPay&quot; @close=&quot;closePayModal&quot; :img=&quot;payImg&quot;&gt;&lt;/scan-pay-code&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import QRCode from 'qrcode'
</span><span class="token prefix inserted">+</span><span class="token line">import ScanPayCode from './../components/ScanPayCode'
</span></span>export default{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name:'order-pay',
</span><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     orderId:this.$route.query.orderNo,
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">     payType:'',//支付类型
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      showPay:false,//是否显示微信支付弹框
</span><span class="token prefix inserted">+</span><span class="token line">      payImg:'',//微信支付的二维码地址
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> components:{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    ScanPayCode,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getOrderDetail();
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   getOrderDetail(){...},
</span><span class="token prefix unchanged"> </span><span class="token line">    paySubmit(payType){
</span><span class="token prefix unchanged"> </span><span class="token line">     if(payType == 1){	//支付宝支付
</span><span class="token prefix unchanged"> </span><span class="token line">       // 打开新窗口
</span><span class="token prefix unchanged"> </span><span class="token line">       window.open('/#/order/alipay?orderId='+this.orderId,'_blank');
</span><span class="token prefix unchanged"> </span><span class="token line">     }else{ //微信支付
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.post('/pay',{
</span><span class="token prefix unchanged"> </span><span class="token line">         orderId:this.orderId,
</span><span class="token prefix unchanged"> </span><span class="token line">         orderName:'Vue高仿小米商城',
</span><span class="token prefix unchanged"> </span><span class="token line">         amount:0.01,//单位元
</span><span class="token prefix unchanged"> </span><span class="token line">         payType:2 //1支付宝，2微信
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         // 将res.content转换为图片URL地址
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          QRCode.toDataURL(res.content)
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         .then(url =&gt; {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            this.showPay = true;	//展示微信弹框
</span><span class="token prefix inserted">+</span><span class="token line">            this.payImg = url;		//支付图片等于url地址
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         })
</span><span class="token prefix unchanged"> </span><span class="token line">         .catch(() =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">           this.$message.error('微信二维码生成失败，请稍后重试');
</span><span class="token prefix unchanged"> </span><span class="token line">         })
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 关闭微信弹框
</span><span class="token prefix inserted">+</span><span class="token line">    closePayModal(){
</span><span class="token prefix inserted">+</span><span class="token line">      this.showPay = false;
</span><span class="token prefix inserted">+</span><span class="token line">    },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><ol start="4"><li><code>src/components/ScanPayCode.vue</code>：注意此处close事件为子传父自定义事件的做法</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;scan&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;mask&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;div class=&quot;item-wrap&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;img-scan&quot;&gt;&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;div class=&quot;img-pay&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;title&quot;&gt;微信支付&lt;em @click=&quot;close&quot;&gt;&lt;/em&gt;&lt;/div&gt;
</span><span class="token prefix inserted">+</span><span class="token line">        &lt;div class=&quot;qrcode&quot;&gt;&lt;img :src=&quot;img&quot;&gt;&lt;/div&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       &lt;div class=&quot;tip&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;p&gt;请使用&lt;span class=&quot;theme-color&quot;&gt;微信&lt;/span&gt;扫一扫&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;p&gt;二维码完成支付&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">       &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">     &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default{
</span><span class="token prefix unchanged"> </span><span class="token line">   name:'scan-pay-code',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    props:['img'],
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   methods:{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      close(){
</span><span class="token prefix inserted">+</span><span class="token line">        this.$emit('close');
</span><span class="token prefix inserted">+</span><span class="token line">      }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span></span></code></pre></div><p><strong>补充：</strong></p> <p>(1) 点击微信支付后返回的content，content中的这段字符串将被转换为二维码，本次课程将通过<code>qrcode</code>插件来转换二维码。</p> <p><img src="/assets/img/image-20220719225432849.1373843d.png" alt="image-20220719225432849"></p> <p>(2) 对于<code>qrcode</code>插件，这是专门帮助把字符串生成二维码图片的，实际上是一张base64位的字符串图片，不是一个真实的图片地址。可以再npmjs中找到es6的promise形式的用法。</p> <div class="language-diff extra-class"><pre class="language-diff"><code>QRCode.toDataURL('I am a pony!')
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .then(url =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">   console.log(url)
</span><span class="token prefix unchanged"> </span><span class="token line"> })
</span><span class="token prefix unchanged"> </span><span class="token line"> .catch(err =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">   console.error(err)
</span><span class="token prefix unchanged"> </span><span class="token line"> })
</span></span></code></pre></div><p>(3)下一节的任务：扫描成功支付完以后，需要实时地去轮询，获取订单状态，完成自动跳转。当订单成功以后，需要回跳到订单列表页面。</p> <p>如果没有支付，当点击关闭微信支付(ScanPayCode组件)时，将弹出一个模态框，让用户选择“查看订单(已支付)”还是“未支付”，点击“未支付”将关闭模态框留在当前页面，点击“查看订单(已支付)”将进行页面跳转到订单列表中(<code>orderList</code>)：（如果未支付的用户选择“查看订单(已支付)”将进行进一步的处理）。具体看下一节。</p> <p><img src="/assets/img/image-20220719235311519.c5af2be1.png" alt="image-20220720143607653"></p> <h3 id="_13-4-微信支付状态轮询"><a href="#_13-4-微信支付状态轮询" class="header-anchor">#</a> 13.4 微信支付状态轮询</h3> <p>二维码生成出来以后还有两个环节去做，一是用户已经支付了，二是用户没有支付。</p> <ul><li>如果用户支付成功，那么页面将<strong>自动跳转</strong>到“订单列表(orderList)”。<strong>——轮询</strong></li> <li>如果用户没有支付的话就留在当前页面，但有一种特殊的情况是：实际上有可能是用户已经支付了，但是因为网络状态异常，网页不会自动跳转到“订单列表(orderList)”，而是留在当前页面。
<ul><li>考虑这种特殊情况，这里加一个“<strong>支付确认弹框</strong>”来提醒用户，到底是已支付还是未支付，如果用户选择了“查看订单(已支付)”，那么会跳转到“订单列表(orderList)”。</li> <li>如果点击了“未支付”，那就关闭弹框并留在当前页面。</li> <li>但还有一种特殊情况：用户并未完成支付，但在“支付确认弹框”中却选择“查看订单(已支付)”。不过这没关系，我们还在“订单列表(orderList)”中会再次查询订单到底有没有支付，会获取订单的实际状态。</li></ul></li></ul> <p>(很多电商网站的交易平台都会有这种提示，告诉用户你自己手动地选择是否完成，同时如果用户真的支付成功了，因为网络特别快，那么系统会做一个轮询，自动帮助用户跳转)</p> <ol><li>支付确认模态框(弹框)的引入，btnType=&quot;3&quot;表示有确定—“查看订单(已支付)”和取消—“未支付”两个按钮，</li></ol> <p><code>src/pages/orderPay.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">modal
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   title=&quot;支付确认&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   btnType=&quot;3&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   :showModal=&quot;showPayModal&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   sureText=&quot;查看订单(已支付)&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   cancelText=&quot;未支付&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   @cancel=&quot;showPayModal=false&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   @submit=&quot;goOrderList&quot;
</span></span><span class="token inserted-arrow inserted"><span class="token prefix inserted">&gt;</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;template v-slot:body&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   	&lt;p&gt;您确认是否完成支付？&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;/template&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/modal&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> data(){
</span><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">     ...,//微信支付的二维码地址
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      showPayModal:false,//是否显示二次支付确认弹框
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     payment:0,//订单总金额
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      T:''//定时器ID
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> ....
</span><span class="token prefix unchanged"> </span><span class="token line">   methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">   getOrderDetail(){...},
</span><span class="token prefix unchanged"> </span><span class="token line">   paySubmit(payType){
</span><span class="token prefix unchanged"> </span><span class="token line">     if(payType == 1){
</span><span class="token prefix unchanged"> </span><span class="token line">       // 打开新窗口
</span><span class="token prefix unchanged"> </span><span class="token line">      ...
</span><span class="token prefix unchanged"> </span><span class="token line">     }else{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.post('/pay',{
</span><span class="token prefix unchanged"> </span><span class="token line">         ...
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         QRCode.toDataURL(res.content)
</span><span class="token prefix unchanged"> </span><span class="token line">         .then(url =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">           this.showPay = true;
</span><span class="token prefix unchanged"> </span><span class="token line">           this.payImg = url;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            // 当二维码生成的弹框出来以后就要轮询
</span><span class="token prefix inserted">+</span><span class="token line">            this.loopOrderState();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         })
</span><span class="token prefix unchanged"> </span><span class="token line">         .catch(() =&gt; {
</span><span class="token prefix unchanged"> </span><span class="token line">           this.$message.error('微信二维码生成失败，请稍后重试');
</span><span class="token prefix unchanged"> </span><span class="token line">         })
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   // 关闭微信弹框
</span><span class="token prefix unchanged"> </span><span class="token line">   closePayModal(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.showPay = false;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      this.showPayModal = true;
</span><span class="token prefix inserted">+</span><span class="token line">	  // 关闭微信支付页面，也要关闭定时器，防止一直刷订单状态接口
</span><span class="token prefix inserted">+</span><span class="token line">      clearInterval(this.T);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 轮询当前订单支付状态，实现自动跳转页面
</span><span class="token prefix inserted">+</span><span class="token line">    loopOrderState(){
</span><span class="token prefix inserted">+</span><span class="token line">	  // 利用定时器定时地刷接口，拉取订单的状态
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.T = setInterval(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get(`/orders/${this.orderId}`).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         // 20表示已付款
</span><span class="token prefix unchanged"> </span><span class="token line">         if(res.status == 20){
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            clearInterval(this.T); // 清除定时器
</span><span class="token prefix inserted">+</span><span class="token line">            this.goOrderList();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },1000);
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    // 点击“查看订单(已支付)”调用的方法
</span><span class="token prefix inserted">+</span><span class="token line">    goOrderList(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     this.$router.push('/order/list');
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><p><strong>补充</strong></p> <p>(1) 订单状态：0-已取消，10-未付款，20-已付款，40-已发货，50-交易成功，60-交易关闭。</p> <p>(2) 轮询需要用到定时器，定时地去刷接口。其实像这种情况有两种方式。一是利用定时器刷接口，每隔一段时间(根据公司业务定)刷一次接口；二是利用推送，类似于聊天对话的推送方式，通过socket去搭建一台服务器，那么后端支付完成以后会自动地向前端推送一条消息，告诉前端当前用户已经完成支付，前端再自动地跳转页面。</p> <p>(3) steInterval()设置的定时器需要手动清除。</p> <p>(4) 当我们该订单支付完成后，再次从订单列表回到支付功能页面，点击微信支付会报错，为服务器异常。</p> <p><img src="/assets/img/720-1.ca4b43b8.png" alt="在这里插入图片描述"></p> <p>错误有两种，一是接口的异常，二是服务器的异常。状态码为“500”，实际上是Nginx服务器出现了异常。接口的错误拦截首先HTTP的状态码是“200”，即首先保证接口是通的，这报的错都是业务异常，做的是业务异常拦截。针对“HTTP状态码请求”的错误拦截可以在第二个参数function中实现。第一个参数function是拦截业务异常的，即。第一个参数返回的状态码都是200，只是里面的status不同导致业务不同，比如0，10等等。</p> <p><code>src/main.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>// 接口错误拦截
axios.interceptors.response.use(function(response) {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   let res = response.data //res中的status 是与后台协商的字段，这是定义的
</span><span class="token prefix unchanged"> </span><span class="token line">   let path = location.hash
</span><span class="token prefix unchanged"> </span><span class="token line">   if (res.status == 0) { // status为0表示成功
</span><span class="token prefix unchanged"> </span><span class="token line">       return res.data
</span><span class="token prefix unchanged"> </span><span class="token line">   } else if (res.status == 10) { // status为10表示未登录的报错
</span><span class="token prefix unchanged"> </span><span class="token line">       if (path != '#/index') {
</span><span class="token prefix unchanged"> </span><span class="token line">           window.location.href = '/#/login' // 跳转到登录页面，不能用$router.push()这些路由API，因为这是挂载在Vue实例上的，而此时并没有Vue实例
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">       return Promise.reject(res)
</span><span class="token prefix unchanged"> </span><span class="token line">   } else {
</span><span class="token prefix unchanged"> </span><span class="token line">       Message.warning(res.msg)
</span><span class="token prefix unchanged"> </span><span class="token line">       return Promise.reject(res) // 用Promise.reject()抛出异常
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>}, (error) =&gt; {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   let res = error.response
</span><span class="token prefix unchanged"> </span><span class="token line">   Message.error(res.data.message)
</span><span class="token prefix unchanged"> </span><span class="token line">   return Promise.reject(error)
</span></span>})
</code></pre></div><h2 id="_14-订单列表"><a href="#_14-订单列表" class="header-anchor">#</a> 14 订单列表</h2> <p>这部分的内容是简化的，不包含退款等功能。订单列表中只需要拉取用户当前已经下单的订单数据，包括订单日期，收货人，订单编号，订单状态。当订单状态是“未支付”，点击后会跳转到支付页面(orderPay)；当订单状态是已支付时就不能再点击了。同时，还包括了订单列表的分页功能。</p> <h3 id="_14-1-调整order父组件结构"><a href="#_14-1-调整order父组件结构" class="header-anchor">#</a> 14.1 调整Order父组件结构</h3> <p>在刚开始讲order父组件结构的时候，发现<code>orderConfirm</code>， <code>orderPay</code> ，<code>orderList</code> ，<code>alipay</code>这4个组件都以 <code>OrderHeader</code>组件作为头部，只是内容不同。所以当时我们就直接在order父组件进行封装，由路由的不同进行内容修改。</p> <p><img src="/assets/img/image-20220720162523404.eb0dd05c.png" alt="image-20220720162523404"></p> <p><img src="/assets/img/image-20220720162612473.ee3c85be.png" alt="image-20220720162612473"></p> <p><strong>但是这样做存在一个问题：</strong><code>mounted</code>是生命周期函数，只有在第一次加载渲染页面时，才会触发。当我们从订单确认(orderConfirm)跳转到订单支付(orderPay)，再到订单列表(orderList)时，<code>mounted</code>生命钩子只触发了一次(除非刷新页面)，因此会导致订单支付(orderPay)和订单列表(orderList)的<code>orderHeader</code>组件的内容都还是订单确认(orderConfirm)的，只有重新刷新页面，才会重新渲染数据。所以，这种方法不可行，需要给<code>orderConfirm</code>， <code>orderPay</code> ，<code>orderList</code> ，<code>alipay</code>每个子组件，单独插入<code>orderHeader</code>组件，单独传值。</p> <h3 id="_14-2-订单列表数据渲染"><a href="#_14-2-订单列表数据渲染" class="header-anchor">#</a> 14.2 订单列表数据渲染</h3> <p><code>src/pages/orderList.vue</code></p> <p>两次循环嵌套渲染</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         &lt;div class=&quot;order&quot; v-for=&quot;(order,index) in list&quot; :key=&quot;index&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;order-title&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item-info fl&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               {{order.createTime}}
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               {{order.receiverName}}
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               订单号：{{order.orderNo}}
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span&gt;|&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               {{order.paymentTypeDesc}}
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;item-money fr&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span&gt;应付金额：&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span class=&quot;money&quot;&gt;{{order.payment}}&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;span&gt;元&lt;/span&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;div class=&quot;order-content clearfix&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;good-box fl&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;div class=&quot;good-list&quot; v-for=&quot;(item,i) in order.orderItemVoList&quot; :key=&quot;i&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;div class=&quot;good-img&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;img v-lazy=&quot;item.productImage&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;div class=&quot;good-name&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;p-name&quot;&gt;{{item.productName}}&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                   &lt;div class=&quot;p-money&quot;&gt;{{item.totalPrice + 'X' + item.quantity}}元&lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">                 &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;!-- 注意：下面的内容不在二层循环中 --&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;good-state fr&quot; v-if=&quot;order.status == 20&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;a href=&quot;javascript:;&quot;&gt;{{order.statusDesc}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;div class=&quot;good-state fr&quot; v-else&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">               &lt;a href=&quot;javascript:;&quot; @click=&quot;goPay(order.orderNo)&quot;&gt;{{order.statusDesc}}&lt;/a&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">             &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">           &lt;/div&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">         &lt;/div&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   data(){
</span><span class="token prefix unchanged"> </span><span class="token line">     return { 
</span><span class="token prefix unchanged"> </span><span class="token line">       list:[],
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   mounted(){
</span><span class="token prefix unchanged"> </span><span class="token line">     this.getOrderList();
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">     // 获取数据
</span><span class="token prefix unchanged"> </span><span class="token line">     getOrderList(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders').then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.list = res.list;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     goPay(orderNo){
</span><span class="token prefix unchanged"> </span><span class="token line">       // 三种路由跳转方式
</span><span class="token prefix unchanged"> </span><span class="token line">       // this.$router.push('/order/pay')
</span><span class="token prefix unchanged"> </span><span class="token line">       /*this.$router.push({
</span><span class="token prefix unchanged"> </span><span class="token line">         name:'order-pay',
</span><span class="token prefix unchanged"> </span><span class="token line">         query:{
</span><span class="token prefix unchanged"> </span><span class="token line">           orderNo
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       })*/
</span><span class="token prefix unchanged"> </span><span class="token line">       this.$router.push({
</span><span class="token prefix unchanged"> </span><span class="token line">         path:'/order/pay',
</span><span class="token prefix unchanged"> </span><span class="token line">         query:{
</span><span class="token prefix unchanged"> </span><span class="token line">           orderNo
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span></code></pre></div><p><strong>补充</strong></p> <p>(1) cdn是一款加速服务器，比如可以把图片缓存到该服务器上去。这样，前端在去加载图片的时候，速度会特别快。快的原因有两个：</p> <ul><li>一是因为它在服务器上已经把图片缓存下来了，用户很快就拉取下来了；</li> <li>二是因为它帮助了我们分摊了带宽，如果把图片都放在自己的服务器上，那么就会把我们的服务器的带宽拉得很高，那如果我们把图片的资源放在另外一台服务器上，等于是分流了，相当于从我们自己服务器拉取的东西变少了，它会同步地去另外一台服务器去拉取我们的请求，所以说是帮助我们分担带宽了。</li></ul> <p>(2) 三种路由跳转方式。</p> <h3 id="_14-3-loading和nodata优化"><a href="#_14-3-loading和nodata优化" class="header-anchor">#</a> 14.3 Loading和NoData优化</h3> <p>针对订单列表的两个优化：</p> <ul><li>数据请求发出去以后，且数据还未回来之前，需要做一个有一个loading处理。让用户有一个等待的过程。</li> <li>当订单没有记录的时候，提示一个当前无数据。</li></ul> <ol><li>Loading优化</li></ol> <p>在做支付宝的支付页面(alipay)时，已经创建过Loading组件，该组件就是在接口调用渲染数据前，先懒加载一个图片，当接口调用渲染数据成功后，就消失，优化用户体验。</p> <p><code>src/pages/orderList.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import Loading from './../components/Loading'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">...
</span><span class="token prefix unchanged"> </span><span class="token line">export default{
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   data(){
</span><span class="token prefix unchanged"> </span><span class="token line">     return { 
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        loading:true,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       list:[], 
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   components:{
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      Loading,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span>	methods:{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     // 获取数据
</span><span class="token prefix unchanged"> </span><span class="token line">     getOrderList(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders').then((res)=&gt;{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          this.loading = false;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         this.list = res.list;
</span><span class="token prefix unchanged"> </span><span class="token line">       }).catch(()=&gt;{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          this.loading = false;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">    }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;order-box&quot;&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;loading v-if=&quot;loading&quot;&gt;&lt;/loading&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ......
</span></span></code></pre></div><ol start="2"><li>NoData优化</li></ol> <p>当用户没有任何订单，进入我的订单列表，会发现一片空白，为了防止误会成bug，在这种情况下显示一张图片。</p> <p><img src="/assets/img/image-20220720192330102.1294ee7b.png" alt="image-20220720192330102"></p> <p>(1) 创建NoData组件</p> <p><code>src/components/NoData.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">template&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div class=&quot;no-data&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;img src=&quot;/imgs/icon-no-data.png&quot; alt=&quot;&quot;&gt;
</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;p&gt;当前暂无提交的订单记录.&lt;/p&gt;
</span><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/template&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">script&gt;
</span></span>export default{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> name:'no-data'
</span></span>}
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">style lang=&quot;scss&quot;&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> .no-data{
</span><span class="token prefix unchanged"> </span><span class="token line">   text-align:center;
</span><span class="token prefix unchanged"> </span><span class="token line">   font-size:20px;
</span><span class="token prefix unchanged"> </span><span class="token line">   color:#999999;
</span><span class="token prefix unchanged"> </span><span class="token line">   margin:50px 0;
</span><span class="token prefix unchanged"> </span><span class="token line">   img{
</span><span class="token prefix unchanged"> </span><span class="token line">     width:240px;
</span><span class="token prefix unchanged"> </span><span class="token line">     height:180px;
</span><span class="token prefix unchanged"> </span><span class="token line">     margin-bottom:30px;
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/style&gt;
</span></span></code></pre></div><p>(2) 引入组件</p> <p><code>src/pages/orderList.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import NoData from './../components/NoData'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">...
</span><span class="token prefix unchanged"> </span><span class="token line">export default{
</span><span class="token prefix unchanged"> </span><span class="token line">   ...
</span><span class="token prefix unchanged"> </span><span class="token line">   components:{
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">     NoData,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span>	methods:{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     // 获取数据
</span><span class="token prefix unchanged"> </span><span class="token line">     getOrderList(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders').then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          // 用[]模拟空数据，测试完以后记得还原
</span><span class="token prefix inserted">+</span><span class="token line">          this.list = [] || res.list;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       }).catch(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     ...
</span><span class="token prefix unchanged"> </span><span class="token line">    }
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> &lt;!-- 展示NoData组件的条件：首先loading是false；其次list已经请求回来了，但是它得长度为0 --&gt;
</span><span class="token prefix inserted">+</span><span class="token line"> &lt;no-data v-if=&quot;!loading &amp;&amp; list.length==0&quot;&gt;&lt;/no-data&gt;
</span></span></code></pre></div><h3 id="_14-4-订单列表分页-分页器"><a href="#_14-4-订单列表分页-分页器" class="header-anchor">#</a> 14.4 订单列表分页-分页器</h3> <p>ElementUI的<a href="https://element.eleme.cn/#/zh-CN/component/pagination" target="_blank" rel="noopener noreferrer">Pagination分页<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>本节使用的是以下样式的分页：</p> <p><img src="/assets/img/image-20220720205053762.882740ef.png" alt="image-20220720205053762"></p> <p>参数：</p> <p><img src="/assets/img/720-2.f0fbb648.png" alt="image-20220720210413387"></p> <p><img src="/assets/img/720-2.f0fbb648.png" alt="image-20220720210242287"></p> <p>事件：</p> <p><img src="/assets/img/720-3.e555ac61.png" alt="在这里插入图片描述"></p> <p>该项目主要用的是current-change自定义事件，<strong>还要注意回调参数为当前页</strong></p> <p><code>src/pages/orderList.vue</code></p> <ol><li>引入</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>import { Pagination } from 'element-ui' // 主要引入Pagination组件的方式
export default{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   components:{
</span><span class="token prefix unchanged"> </span><span class="token line">     ...,
</span><span class="token prefix unchanged"> </span><span class="token line">     [Pagination.name]:Pagination, //根据文档可以得出我们是通过el-pagination组件名来使用Pagination组件的，Pagination.name会动态获取el-pagination，然后赋予给Pagination
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span></code></pre></div><ol start="2"><li>设置参数</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>data(){
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       ...,
</span><span class="token prefix unchanged"> </span><span class="token line">       pageSize:10,// 一页多少条
</span><span class="token prefix unchanged"> </span><span class="token line">       pageNum:1,//当前页数 与current-change事件配合
</span><span class="token prefix unchanged"> </span><span class="token line">       total:0,//总的条目数
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span></code></pre></div><ol start="3"><li>使用</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">!-- total可以在订单接口中就获取, 为了使pageSize和total的值不是字符串，需要使用v-bind（:） --&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">el-pagination
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   background
</span><span class="token prefix unchanged"> </span><span class="token line">   layout=&quot;prev, pager, next&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   :pageSize=&quot;pageSize&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   :total=&quot;total&quot;
</span></span><span class="token inserted-arrow inserted"><span class="token prefix inserted">&gt;</span><span class="token line">
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/el-pagination&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// 在订单接口中获取total
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    // 获取数据
</span><span class="token prefix unchanged"> </span><span class="token line">     getOrderList(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders',{
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            pageNum:this.pageNum
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">         this.list = res.list;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          this.total = res.total;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       }).catch(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span></span></code></pre></div><ol start="4"><li>自定义跳转分页器current-change事件。注意：current-change事件的回调参数为当前页，所以可以直接获取到pagenum, 然后赋予 this.pagenum，pagenum更新后，重新拉取订单接口，<strong>此时要赋予订单接口参数！！！</strong></li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">el-pagination
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   background
</span><span class="token prefix unchanged"> </span><span class="token line">   layout=&quot;prev, pager, next&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   :pageSize=&quot;pageSize&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   :total=&quot;total&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   @current-change=&quot;handleChange&quot;
</span></span><span class="token inserted-arrow inserted"><span class="token prefix inserted">&gt;</span><span class="token line">
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/el-pagination&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// 第一种方法：分页器
handleChange(pageNum){
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.pageNum = pageNum;
</span><span class="token prefix unchanged"> </span><span class="token line">   this.getOrderList();
</span></span>},
</code></pre></div><ol start="5"><li>修改分页器的颜色为主题色，添加样式</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>.el-pagination.is-background .el-pager li:not(.disabled).active{
	background-color: #FF6600;
}
</code></pre></div><ol start="6"><li>如下所示，通过以上几步就基本完成了分页效果，但是分页的那一栏一般都是放在右边的，所以还需处理。</li></ol> <p><img src="/assets/img/720-4.1a8b406b.png" alt="在这里插入图片描述"></p> <ol start="7"><li>为了使分页栏放在右边，赋值一个class</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">el-pagination
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   class=&quot;pagination&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   background
</span><span class="token prefix unchanged"> </span><span class="token line">   layout=&quot;prev, pager, next&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   :pageSize=&quot;pageSize&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   :total=&quot;total&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   @current-change=&quot;handleChange&quot;
</span></span><span class="token inserted-arrow inserted"><span class="token prefix inserted">&gt;</span><span class="token line">
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/el-pagination&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>.pagination{
	text-align:right;
}
</code></pre></div><p><img src="/assets/img/720-5.e2385bcb.png" alt="在这里插入图片描述"></p> <h3 id="_14-5-订单列表分页-加载更多"><a href="#_14-5-订单列表分页-加载更多" class="header-anchor">#</a> 14.5 订单列表分页-加载更多</h3> <p>ElementUI的<a href="https://element.eleme.cn/#/zh-CN/component/button#jia-zai-zhong" target="_blank" rel="noopener noreferrer">按钮—加载中<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/assets/img/image-20220720231054667.f44b1bde.png" alt="image-20220720231054667"></p> <p><code>src/pages/orderList.vue</code></p> <ol><li>引入</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import { Pagination,Button } from 'element-ui' // 主要引入Pagination组件的方式
</span></span>export default{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   components:{
</span><span class="token prefix unchanged"> </span><span class="token line">     ...,
</span><span class="token prefix unchanged"> </span><span class="token line">     [Pagination.name]:Pagination, //根据文档可以得出我们是通过el-pagination组件名来使用Pagination组件的，Pagination.name会动态获取el-pagination，然后赋予给Pagination
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      [Button.name]:Button // 道理同上
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span></code></pre></div><ol start="2"><li>为了更好地展示，此处先把分页器隐藏</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">el-pagination
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    v-if=&quot;false&quot;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ...
</span></span><span class="token inserted-arrow inserted"><span class="token prefix inserted">&gt;</span><span class="token line">
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/el-pagination&gt;
</span></span></code></pre></div><ol start="3"><li>使用，为了使按钮居中显示，使用div标签进行包裹，便添加class=&quot;load-more&quot;样式。不能直接给按钮添加居中样式，因为这样是使得文字居中，而不是按钮相对页面居中</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;load-more&quot;&gt;
</span></span>	&lt;el-button type=&quot;primary&quot; :loading=&quot;loading&quot;&gt;加载更多&lt;/el-button&gt;
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>.load-more{
	text-align:center;
}
</code></pre></div><ol start="4"><li>注意到上面的 <code>:loading=&quot;loading&quot;</code>，其实loading值之前我们在14.3节使用控制过，这里做一些调整后可直接使用。调整：即在调用接口获取数据之前需展示加载效果，所以在getOrderList中将其设置为true</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   data(){
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        loading:false,	// 这里改了以后和上面的Loading优化会冲突，所以最好不复用loading
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       list:[],
</span><span class="token prefix unchanged"> </span><span class="token line">       pageSize:10,// 一页多少条
</span><span class="token prefix unchanged"> </span><span class="token line">       pageNum:1,//当前页数 与current-change事件配合
</span><span class="token prefix unchanged"> </span><span class="token line">       total:0,//总的条目数
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">     // 获取数据
</span><span class="token prefix unchanged"> </span><span class="token line">     getOrderList(){
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.loading = true;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.busy = true;
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders',{
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span></span>			...
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">         this.list = this.list.concat(res.list);
</span><span class="token prefix unchanged"> </span><span class="token line">         this.total = res.total;
</span><span class="token prefix unchanged"> </span><span class="token line">       }).catch(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span></span></code></pre></div><ol start="5"><li>定义“加载更多”按钮的点击事件。</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">el-button type=&quot;primary&quot; :loading=&quot;loading&quot; @click=&quot;loadMore&quot;&gt;加载更多&lt;/el-button&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>// 第一种方法：分页器
handleChange(pageNum){
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    this.pageNum = pageNum; //在分页器中能直接知道当前是第几页
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.getOrderList();
</span></span>},
// 第二种方法：加载更多按钮
loadMore(){
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    this.pageNum++; //因为不能直接知道当前是第几页，所以没调用此方法一次，页码就需累加
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   this.getOrderList();
</span></span>},
</code></pre></div><ol start="7"><li>另外，我们需要订单列表是新数据拼接在旧数据之后来实现全部展示的，而不是分页展示，所以要对list数组进行数据拼接而不是覆盖。</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     // 获取数据
</span><span class="token prefix unchanged"> </span><span class="token line">     getOrderList(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.loading = true;
</span><span class="token prefix unchanged"> </span><span class="token line">       this.busy = true;
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders',{
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span><span class="token prefix unchanged"> </span><span class="token line">           pageSize:2,
</span><span class="token prefix unchanged"> </span><span class="token line">           pageNum:this.pageNum
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          this.list = this.list.concat(res.list);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         this.total = res.total;
</span><span class="token prefix unchanged"> </span><span class="token line">       }).catch(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span></span></code></pre></div><ol start="8"><li>修改按钮颜色，可以像前面那样直接修改改按钮的颜色，也可以使用官方提供的自定义主题(这种方法更方便)。此处直接修改按钮的颜色。</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>.el-button--primary{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   background-color: #FF6600;
</span><span class="token prefix unchanged"> </span><span class="token line">   border-color: #FF6600;
</span></span>}
</code></pre></div><ol start="9"><li>到这还需要完善一个问题，就是一直加载更多，加载到最后一个时，加载更多按钮应该消失</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   data(){
</span><span class="token prefix unchanged"> </span><span class="token line">     return {
</span><span class="token prefix unchanged"> </span><span class="token line">       ...,
</span><span class="token prefix unchanged"> </span><span class="token line">       showNextPage:true,//加载更多：是否显示按钮
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   ...,
</span><span class="token prefix unchanged"> </span><span class="token line">   methods:{
</span><span class="token prefix unchanged"> </span><span class="token line">     // 获取数据
</span><span class="token prefix unchanged"> </span><span class="token line">     getOrderList(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.loading = true;
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders',{
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span><span class="token prefix unchanged"> </span><span class="token line">           pageSize:10,
</span><span class="token prefix unchanged"> </span><span class="token line">           pageNum:this.pageNum
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">         this.list = this.list.concat(res.list);
</span><span class="token prefix unchanged"> </span><span class="token line">         this.total = res.total;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          //hasNextPage：后台接口返回的数据，表示是否还有下一页，为true表示还有，false表示没有
</span><span class="token prefix inserted">+</span><span class="token line">          this.showNextPage = res.hasNextPage;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       }).catch(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">!-- 通过v-if=&quot;showNextPage&quot;来判断是否展示“加载更多” --&gt;
</span><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;load-more&quot; v-if=&quot;showNextPage&quot;&gt;
</span></span>	&lt;el-button type=&quot;primary&quot; :loading=&quot;loading&quot; @click=&quot;loadMore&quot;&gt;加载更多&lt;/el-button&gt;
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><h3 id="_14-6-订单列表分页-滚动加载"><a href="#_14-6-订单列表分页-滚动加载" class="header-anchor">#</a> 14.6 订单列表分页-滚动加载</h3> <p>这需要借助npm中的vue-infinite-scroll插件，注意这不是一个组件，这实际上是一个指令。</p> <ol><li>下载vue-infinite-scroll插件</li></ol> <div class="language- extra-class"><pre class="language-text"><code>npm install vue-infinite-scroll --save
</code></pre></div><ol start="2"><li>局部引入</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>import infiniteScroll from 'vue-infinite-scroll'
</code></pre></div><ol start="3"><li>局部配置指令，注意infiniteScroll是一个指令</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>// 设置一个infiniteScroll指令，之后就可以v-infinite-scroll进行使用了
directives: {
	infiniteScroll
},
</code></pre></div><ol start="4"><li>配置参数</li></ol> <ul><li>v-infinite-scroll=&quot;scrollMore&quot; 代表滚动时，触发scrollMore事件</li> <li>infinite-scroll-disabled=&quot;true&quot; 用busy控制滚动事件是否能触发，fasle为能，true表示禁止不能</li> <li>infinite-scroll-distance=&quot;410&quot; 表示距离底部多少，可以触发滚动事件</li></ul> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">div class=&quot;scroll-more&quot;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   v-infinite-scroll=&quot;scrollMore&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   infinite-scroll-disabled=&quot;true&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   infinite-scroll-distance=&quot;410&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">   v-if=&quot;false&quot;
</span></span><span class="token inserted-arrow inserted"><span class="token prefix inserted">&gt;</span><span class="token line">
</span></span>	&lt;!-- 滚动加载的时候显示一个图片，否则数据请求回来前一直没有什么变化 --&gt;
	&lt;img src=&quot;/imgs/loading-svg/loading-spinning-bubbles.svg&quot; alt=&quot;&quot; v-show=&quot;loading&quot;&gt;
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/div&gt;
</span></span></code></pre></div><div class="language-diff extra-class"><pre class="language-diff"><code>data(){
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return {
</span><span class="token prefix unchanged"> </span><span class="token line">       ...,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        busy:false,//滚动加载，是否触发
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }
</span></span>},
</code></pre></div><ol start="5"><li>配置scrollMore事件</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      // 第三种方法：滚动加载，通过npm插件实现
</span><span class="token prefix inserted">+</span><span class="token line">      scrollMore(){
</span></span>		// 一旦触发了该方法，就要禁用滚动加载，否则滚动轮在滚动中会无限次地去调用该方法，影响性能
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.busy = true; 
</span><span class="token prefix unchanged"> </span><span class="token line">       setTimeout(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.pageNum++;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          this.getList();
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       },500); //设置定时器，防止一直调用接口
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      // 专门给scrollMore使用(也是调用接口，请求数据)
</span><span class="token prefix inserted">+</span><span class="token line">      getList(){
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.loading = true;
</span><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders',{
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span><span class="token prefix unchanged"> </span><span class="token line">           pageSize:10,
</span><span class="token prefix unchanged"> </span><span class="token line">           pageNum:this.pageNum
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.list = this.list.concat(res.list);
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          //hasNextPage：后台接口返回的数据，表示是否还有下一页，为true表示还有，false表示没有
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         if(res.hasNextPage){
</span><span class="token prefix unchanged"> </span><span class="token line">           this.busy=false; //可用
</span><span class="token prefix unchanged"> </span><span class="token line">         }else{
</span><span class="token prefix unchanged"> </span><span class="token line">           this.busy=true; //禁用，禁用以后再滚动都是没有用的
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       });
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span></span></code></pre></div><ol start="6"><li>加载的滚动效果居中</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>.scroll-more{
	text-align:center;
}
</code></pre></div><ol start="7"><li>到这发现第一次就默认加载到了第2页，怎么样让第一次不要去加载?</li></ol> <p>可以在第一次触发的时候将 busy 设置为 true，禁用滚动；当第一次请求完以后再去开启滚动。</p> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     // 获取数据
</span><span class="token prefix unchanged"> </span><span class="token line">     getOrderList(){
</span><span class="token prefix unchanged"> </span><span class="token line">       this.loading = true;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">        this.busy = true;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       this.axios.get('/orders',{
</span><span class="token prefix unchanged"> </span><span class="token line">         params:{
</span><span class="token prefix unchanged"> </span><span class="token line">           pageSize:10,
</span><span class="token prefix unchanged"> </span><span class="token line">           pageNum:this.pageNum
</span><span class="token prefix unchanged"> </span><span class="token line">         }
</span><span class="token prefix unchanged"> </span><span class="token line">       }).then((res)=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">         this.list = this.list.concat(res.list);
</span><span class="token prefix unchanged"> </span><span class="token line">         this.total = res.total;
</span><span class="token prefix unchanged"> </span><span class="token line">         this.showNextPage = res.hasNextPage;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">          this.busy = false;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       }).catch(()=&gt;{
</span><span class="token prefix unchanged"> </span><span class="token line">         this.loading = false;
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span></span></code></pre></div><h2 id="_15-补充"><a href="#_15-补充" class="header-anchor">#</a> 15 补充</h2> <p>打包上线前需要做一些准备。首先剔除掉项目当中的无用代码；其次给前端做一些性能优化；再次需要配置线上的Nginx服务器，做域名解析，上传项目，启动服务；最后保证该项目能被别人访问到。</p> <h3 id="_15-1-保留分页器"><a href="#_15-1-保留分页器" class="header-anchor">#</a> 15.1 保留分页器</h3> <p>剔除无用的代码——删除“加载更多”和“滚动加载”，保留“分页器”。</p> <h3 id="_15-2-vue-config-js配置介绍"><a href="#_15-2-vue-config-js配置介绍" class="header-anchor">#</a> 15.2 vue.config.js配置介绍</h3> <p>该项目完全是通过vue-cli脚手架打包构建的，那么所有关于项目的配置都是在vue.config.js中进行设置的。</p> <p>为什么我们通过配置devServer，配置localhost主机，配置代理就可以实现接口的返回代理？实际上，脚手架内部包括了一个隐藏的webpack插件，这是一个中间件，通过webpack，跟nodejs结合去搭建了一个本地的开发服务器，devServer中就是本地开发服务器中的一些相关配置信息。</p> <p>整个项目的打包，文件的压缩合并，混淆，哈希串的生成，SourceMap等都是在vue.config.js文件中进行配置的。</p> <p><a href="https://cli.vuejs.org/zh/config/#vue-config-js" target="_blank" rel="noopener noreferrer">vue.config.js的配置文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><code>vue.config.js</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> devServer:{
</span><span class="token prefix unchanged"> </span><span class="token line">   host:'localhost',
</span><span class="token prefix unchanged"> </span><span class="token line">   port:8080,
</span><span class="token prefix unchanged"> </span><span class="token line">   proxy:{
</span><span class="token prefix unchanged"> </span><span class="token line">     '/api':{
</span><span class="token prefix unchanged"> </span><span class="token line">       target:'http://mall-pre.springboot.cn',
</span><span class="token prefix unchanged"> </span><span class="token line">       changeOrigin:true,
</span><span class="token prefix unchanged"> </span><span class="token line">       pathRewrite:{
</span><span class="token prefix unchanged"> </span><span class="token line">         '/api':''
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> // publicPath:'/app', //这样打包的时候项目中都会读多一个/app的路径
</span><span class="token prefix unchanged"> </span><span class="token line"> // outputDir:'dist',  
</span><span class="token prefix unchanged"> </span><span class="token line"> // indexPath:'index2.html',
</span><span class="token prefix unchanged"> </span><span class="token line"> // lintOnSave:false,	//ESlint校验的开关
</span><span class="token prefix unchanged"> </span><span class="token line"> productionSourceMap:false,
</span></span>}
</code></pre></div><h3 id="_15-3-路由按需加载方案"><a href="#_15-3-路由按需加载方案" class="header-anchor">#</a> 15.3 路由按需加载方案</h3> <p>路由按需加载的目的是防止首屏加载过慢，出现白屏的现象。路由按需加载的作用是一开始只加载需要的文件和包，当用户打开新路由的时候，会把对应的包和文件拉取出来，重新进行加载。</p> <p>当打包构建应用时，JavaScript 包会变得非常大，影响页面加载。如果我们能把不同路由对应的组件分割成不同的代码块，然后当路由被访问的时候才加载对应组件，这样就会更加高效。</p> <p><a href="https://router.vuejs.org/zh/guide/advanced/lazy-loading.html" target="_blank" rel="noopener noreferrer">路由懒加载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol><li>之前使用方式(如下代码展示)，一开始会把所有的文件都加载出来。这样会导致打包后的文件过大，首次加载时很可能出现白屏。</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>import Index from '@/pages/index.vue'
...
{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   path: '/index',
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'index',
</span><span class="token prefix unchanged"> </span><span class="token line">   component: Index
</span></span>},
</code></pre></div><ol start="2"><li>**优化方式1：**用类似于promise的方式实现路由的按需加载，如下代码所示。</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code>{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   path: '/index',
</span><span class="token prefix unchanged"> </span><span class="token line">   name: 'index',
</span><span class="token prefix unchanged"> </span><span class="token line">   //以下的箭头函数不会被立刻执行，只用当用户访问对应路由的时候，该函数才会被运行。
</span><span class="token prefix unchanged"> </span><span class="token line">   //运行的时候用require去把'./pages/index.vue'加载进来，加载进来以后再通过resolve抛出去
</span><span class="token prefix unchanged"> </span><span class="token line">   component: resolve =&gt; require(['./pages/index.vue'], resolve),
</span></span>},
</code></pre></div><ol start="3"><li>**优化方式2：**用动态import方式。这属于ES7语法，需要安装额外的插件(<code>@babel/plugin-syntax-dynamic-import</code>)</li></ol> <p>(1) 安装插件</p> <div class="language- extra-class"><pre class="language-text"><code>npm @babel/plugin-syntax-dynamic-import --save
</code></pre></div><p>(2) 这其实也是一个promise语法。这个语法也是箭头函数。同样的道理，箭头函数不会被立刻执行，只用当用户访问对应路由的时候，该函数才会被运行。</p> <p><code>src/router.vue</code></p> <div class="language-diff extra-class"><pre class="language-diff"><code>import Vue from 'vue'
import Router from 'vue-router'
import Home from './pages/home'
import Index from './pages/index'
Vue.use(Router);

export default new Router({
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> routes:[
</span><span class="token prefix unchanged"> </span><span class="token line">   {
</span><span class="token prefix unchanged"> </span><span class="token line">     path:'/',
</span><span class="token prefix unchanged"> </span><span class="token line">     name:'home',
</span><span class="token prefix unchanged"> </span><span class="token line">     component:Home,
</span><span class="token prefix unchanged"> </span><span class="token line">     redirect:'/index',
</span><span class="token prefix unchanged"> </span><span class="token line">     children:[
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span><span class="token prefix unchanged"> </span><span class="token line">         path: '/index',
</span><span class="token prefix unchanged"> </span><span class="token line">         name: 'index',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: Index,// 第一次就需要加载
</span><span class="token prefix unchanged"> </span><span class="token line">       }, {
</span><span class="token prefix unchanged"> </span><span class="token line">         path: '/product/:id',
</span><span class="token prefix unchanged"> </span><span class="token line">         name: 'product',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: () =&gt; import('./pages/product.vue')
</span><span class="token prefix unchanged"> </span><span class="token line">       }, {
</span><span class="token prefix unchanged"> </span><span class="token line">         path: '/detail/:id',
</span><span class="token prefix unchanged"> </span><span class="token line">         name: 'detail',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: () =&gt; import('./pages/detail.vue')
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     ]
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   {
</span><span class="token prefix unchanged"> </span><span class="token line">     path: '/login',
</span><span class="token prefix unchanged"> </span><span class="token line">     name: 'login',
</span><span class="token prefix unchanged"> </span><span class="token line">     component: () =&gt; import('./pages/login.vue')
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   {
</span><span class="token prefix unchanged"> </span><span class="token line">     path: '/cart',
</span><span class="token prefix unchanged"> </span><span class="token line">     name: 'cart',
</span><span class="token prefix unchanged"> </span><span class="token line">     component: () =&gt; import('./pages/cart.vue')
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   {
</span><span class="token prefix unchanged"> </span><span class="token line">     path: '/order',
</span><span class="token prefix unchanged"> </span><span class="token line">     name: 'order',
</span><span class="token prefix unchanged"> </span><span class="token line">     component: () =&gt; import('./pages/order.vue'),
</span><span class="token prefix unchanged"> </span><span class="token line">     children:[
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span><span class="token prefix unchanged"> </span><span class="token line">         path: 'list',
</span><span class="token prefix unchanged"> </span><span class="token line">         name: 'order-list',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: () =&gt; import('./pages/orderList.vue')
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span><span class="token prefix unchanged"> </span><span class="token line">         path: 'confirm',
</span><span class="token prefix unchanged"> </span><span class="token line">         name: 'order-confirm',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: () =&gt; import('./pages/orderConfirm.vue')
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span><span class="token prefix unchanged"> </span><span class="token line">         path: 'pay',
</span><span class="token prefix unchanged"> </span><span class="token line">         name: 'order-pay',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: () =&gt; import('./pages/orderPay.vue')
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span><span class="token prefix unchanged"> </span><span class="token line">         path: 'alipay',
</span><span class="token prefix unchanged"> </span><span class="token line">         name: 'alipay',
</span><span class="token prefix unchanged"> </span><span class="token line">         component: () =&gt; import('./pages/alipay.vue')
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     ]
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> ]
</span></span>});
</code></pre></div><p>(3) 但此时会发现页面还是会一次性把所有的文件都加载了。原因是每个js对应一个import 进行了<strong>预加载(prefetch)</strong>，没有达到真正的按需加载，所以还需要进行优化。</p> <p><img src="/assets/img/image-20220721163548270.daa7874f.png" alt="image-20220721163548270"></p> <p>(4) 为了实现真正的按需加载，还需要进一步配置<code>vue.config.js</code>文件，改完以后需要重启项目。</p> <div class="language-diff extra-class"><pre class="language-diff"><code>module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> 
</span><span class="token prefix unchanged"> </span><span class="token line"> devServer:{
</span><span class="token prefix unchanged"> </span><span class="token line">   host:'localhost',
</span><span class="token prefix unchanged"> </span><span class="token line">   port:8080,
</span><span class="token prefix unchanged"> </span><span class="token line">   proxy:{
</span><span class="token prefix unchanged"> </span><span class="token line">     '/api':{
</span><span class="token prefix unchanged"> </span><span class="token line">       target:'http://mall-pre.springboot.cn',
</span><span class="token prefix unchanged"> </span><span class="token line">       changeOrigin:true,
</span><span class="token prefix unchanged"> </span><span class="token line">       pathRewrite:{
</span><span class="token prefix unchanged"> </span><span class="token line">         '/api':''
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> // publicPath:'/app', //这样打包的时候项目中都会读多一个/app的路径
</span><span class="token prefix unchanged"> </span><span class="token line"> // outputDir:'dist',  
</span><span class="token prefix unchanged"> </span><span class="token line"> // indexPath:'index2.html',
</span><span class="token prefix unchanged"> </span><span class="token line"> // lintOnSave:false,	//ESlint校验的开关
</span><span class="token prefix unchanged"> </span><span class="token line"> productionSourceMap:true,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  chainWebpack:(config)=&gt;{
</span><span class="token prefix inserted">+</span><span class="token line">    config.plugins.delete('prefetch');
</span><span class="token prefix inserted">+</span><span class="token line">  }
</span></span>}
</code></pre></div><p><strong>补充：</strong></p> <p>(1) 针对图片的优化：</p> <ul><li>cdn服务器：首先cdn是一台加速服务器，带宽很大；其次，它会对图片做缓存，即第一次会加载图片，第二次就不用再加载了(cache-control的作用就是缓存图片)；再次，它会从其他服务器进行下载，这样就能实现分流。</li> <li>懒加载</li> <li>base64位的图片（可以减少请求）</li> <li>图片压缩（tinypng是非常好的一个压缩图片的网站。png图片格式对性能优化非常友好）</li></ul> <p>(2) 关于js，css文件的优化，基本上的优化webpack都已经做了，webpack基本上将样式文件都放在了头部，js文件放在底部。</p> <h3 id="_15-4-服务器部署准备工作"><a href="#_15-4-服务器部署准备工作" class="header-anchor">#</a> 15.4 服务器部署准备工作</h3> <ol><li>购买域名</li> <li>域名备案</li> <li>购买一台服务器</li> <li>解析域名</li> <li>......</li></ol> <p><strong>补充：</strong></p> <p><strong>经典面试题：浏览器输入一个网址后，会发生什么？</strong></p> <p>首先，网址包括四个部分：</p> <ol><li>协议(http、https、ftp）</li> <li>主机（域名）</li> <li>端口（80端口是看不见的，非80端口可以看见。）</li> <li>地址（路径）</li></ol> <p>输入地址之后，首先会去查找缓存，其中缓存包括很多种：浏览器的缓存、系统的缓存、路由的缓存、Web服务的缓存等，如果说一旦发现项目有缓存，首先从缓存中把文件读取进来进行渲染，这样就和服务器没有任何关联。现在这个项目完全走的是缓存：</p> <p><img src="/assets/img/image-20220721104801180.430092ff.png" alt="image-20220721104801180"></p> <p>Size有大小的都是从服务器拉取的。当然后面的Time字符也可以看出来。</p> <p>如果没有缓存，就会去解析域名的服务器厂商，也就是DNS解析（域名解析）。需要根据域名去解析背后的IP，要知道这个域名是属于哪台服务器，IP背后就对应一台服务器（服务器(指的是硬件服务器)上一定要安装Web服务器），找到服务器后，浏览器需要和服务器建立一个链接，建立链接通过以后，前端就会向服务器中的Web服务器发送请求，要是服务器上没有安装Web服务器，项目是启动不了的。</p> <p>链接建立通过后，会通过TCP做三次握手，握手通过以后，服务器会给前端返回页面的标签、地址、内容，前端浏览器在拿到服务器返回的内容以后，会做网页的绘制（浏览器内核引擎自动绘制的），绘制也包括几部分：首先要根据html标签生成一棵DOM树，把里面的CSS文件生成一棵CSS的DOM树，最后会通过pained？绘制在生成一棵render树， <a href="https://blog.csdn.net/egegerhn/article/details/123121149" target="_blank" rel="noopener noreferrer">参考链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 把DOM树和CSS树同时通过pained?给它绘制出来，这个过程需要结合布局：layout布局，然后再进行网页的渲染。</p> <p>得到网页以后，网页包括一些图片资源、CSS文件资源、JS静态资源等。</p> <p>网页会从上到下，依次按顺序执行，遇到图片资源和CSS资源，会正常去解析它。但是一旦它是外部链接，我们会同时发一个并列请求，并列的去拉取。如我们将图片放在CDN服务器里面去，遇到外部链接的时候，会同时并列去下载，不会影响当前页面的渲染和绘制。</p> <p>script标签和link标签本身有跨域的功能，它可以去访问到外部的资源，去加载外部的资源。但是有一点需要注意的是，我们要将样式放在前面，把JS放在后面，因为是按顺序执行的，一旦遇到JS脚本，不光是要把JS脚本拉取下来，还要将JS脚本中的函数包括里面的脚本给编译出来，直到运行完成以后，我们才能够往下执行。</p> <p>为了防止页面的渲染过程停止或终止，影响用户体验，我们建议把JS放在最后。这样也是为了保证用户体验、流畅度和效率的加快。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> <div align="center"><a href="https://beian.miit.gov.cn/" target="_blank"> 辽ICP备2345662205号 </a></div></main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.9183dc48.js" defer></script><script src="/assets/js/127.b6e7f39a.js" defer></script><script src="/assets/js/3.e72fa89a.js" defer></script><script src="/assets/js/2.a1801f46.js" defer></script>
  </body>
</html>
